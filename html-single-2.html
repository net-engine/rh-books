<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns:d="http://docbook.org/ns/docbook">Power Management Guide</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v3.9.9" /><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content="Red_Hat_Enterprise_Linux-Power_Management_Guide-6-en-US-1.0-2" /><link rel="home" href="index.html" title="Power Management Guide" /><link rel="next" href="pref-blank-Preface.html" title="Preface" />
</head><body>

<!--googleoff: all--><script id="jsbc" type="text/javascript">breadcrumbs = [['Support','/support/'], ['Knowledge','/site/'], ['Product Documentation','/site/documentation/'], ['Red Hat Enterprise Linux OpenStack Platform','/site/documentation/Red_Hat_Enterprise_Linux_OpenStack_Platform/'], ['Installation and Configuration Guide']];</script><!--googleon: all--><div id="navigation"></div><div id="floatingtoc" class="hidden"></div>


<div id="main">

<p id="title"><a class="left" href="http://www.redhat.com"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="/site/documentation/"><img alt="Documentation Site" src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/../../../../../RedHat/en-US/images/image_right.png" /></a></p><ul class="docnav"><li class="home">Installation and Configuration Guide</li></ul><div class="book"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux OpenStack Platform</span> <span class="productnumber">4 Beta</span></div><div><h1 class="title"><a id="idp52867800"></a>Installation and Configuration Guide</h1></div><div><h2 class="subtitle">Installing and Configuring OpenStack environments manually</h2></div><p class="edition">Edition 1</p><div><h3 class="corpauthor">
    <span class="inlinemediaobject"><object data="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/../../../../../RedHat/en-US/images/title_logo.svg" type="image/svg+xml"> </object></span>

  </h3></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Steve</span> <span class="surname">Gordon</span></h3><code class="email"><a class="email" href="mailto:sgordon@redhat.com">sgordon@redhat.com</a></code></div><div class="author"><h3 class="author"><span class="firstname">Tim</span> <span class="surname">Hildred</span></h3><code class="email"><a class="email" href="mailto:thildred@redhat.com">thildred@redhat.com</a></code></div><div class="author"><h3 class="author"><span class="firstname">Summer</span> <span class="surname">Long</span></h3><code class="email"><a class="email" href="mailto:slong@redhat.com">slong@redhat.com</a></code></div><div class="author"><h3 class="author"><span class="firstname">Scott</span> <span class="surname">Radvan</span></h3><code class="email"><a class="email" href="mailto:sradvan@redhat.com">sradvan@redhat.com</a></code></div><div class="author"><h3 class="author"><span class="firstname">Joshua</span> <span class="surname">Wulf</span></h3><code class="email"><a class="email" href="mailto:jwulf@redhat.com">jwulf@redhat.com</a></code></div></div></div><div><div class="legalnotice"><a id="idm6318576"></a><h1 class="legalnotice">Legal Notice</h1><div class="para">
    Copyright <span class="trademark"></span>&copy; 2013 Red Hat, Inc.
  </div><div class="para">
    The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license (&quot;CC-BY-SA&quot;). An explanation of CC-BY-SA is available at <a href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
  </div><div class="para">
    Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
  </div><div class="para">
    OpenStack Compute Configuration originally based on <em class="citetitle">OpenStack Compute Administration Guide</em> available at <a href="http://docs.openstack.org/havana/openstack-compute/admin/content/">http://docs.openstack.org/havana/openstack-compute/admin/content/</a>, which is copyright 2010, 2011, 2012, 2013 OpenStack Foundation, and licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.
  </div><div class="para">
    OpenStack Dashboard configuration originally based on <em class="citetitle">OpenStack Install and Deploy Manual - Red Hat</em> available at <a href="http://docs.openstack.org/havana/openstack-object-storage/admin/content/">http://docs.openstack.org/havana/openstack-object-storage/admin/content/</a>, which is copyright 2010, 2011, 2012, 2013 OpenStack Foundation, and licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.
  </div><div class="para">
    OpenStack Network configuration originally based on <em class="citetitle">OpenStack Network Administration Guide</em> available at <a href="http://docs.openstack.org/havana/openstack-network/admin/content/index.html">http://docs.openstack.org/havana/openstack-network/admin/content/index.html</a>, which is copyright 2011, 2012, 2013 OpenStack Foundation, and licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.
  </div><div class="para">
    OpenStack Object Storage configuration originally based on <em class="citetitle">OpenStack Object Storage Administration Guide</em> available at <a href="http://docs.openstack.org/havana/openstack-object-storage/admin/content/">http://docs.openstack.org/havana/openstack-object-storage/admin/content/</a>, which is copyright 2010, 2011, 2012, 2013 OpenStack Foundation, and licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.
  </div><div class="para">
    Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
  </div><div class="para">
    Red Hat, Red Hat Enterprise Linux, the Shadowman logo, JBoss, MetaMatrix, Fedora, the Infinity Logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
  </div><div class="para">
    The OpenStack Word Mark and OpenStack Logo are either registered trademarks / service marks or trademarks / service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission.
  </div><div class="para">
    <span class="trademark">Linux</span>&reg; is the registered trademark of Linus Torvalds in the United States and other countries.
  </div><div class="para">
    <span class="trademark">Java</span>&reg; is a registered trademark of Oracle and/or its affiliates.
  </div><div class="para">
    <span class="trademark">XFS</span>&reg; is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
  </div><div class="para">
    <span class="trademark">MongoDB</span>&reg;, <span class="trademark">Mongo</span>&reg;, and the leaf logo are registered trademarks of MongoDB, Inc.
  </div><div class="para">
    <span class="trademark">MySQL</span>&reg; is a registered trademark of MySQL AB in the United States, the European Union and other countries.
  </div><div class="para">
    All other trademarks are the property of their respective owners.
  </div><div class="para">

<div class="address"><p><br />
      <span class="street">1801&nbsp;Varsity&nbsp;Drive</span><br />
      <span class="city">Raleigh</span>,&nbsp;<span class="state">NC</span>&nbsp;<span class="postcode">27606-2072</span>&nbsp;<span class="country">USA</span><br />
      <span class="phone">Phone:&nbsp;+1&nbsp;919&nbsp;754&nbsp;3700</span><br />
      <span class="phone">Phone:&nbsp;888&nbsp;733&nbsp;4281</span><br />
      <span class="fax">Fax:&nbsp;+1&nbsp;919&nbsp;754&nbsp;3701</span></p></div>

  </div></div></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
      Installing and Configuring OpenStack environments with Red Hat Enterprise Linux OpenStack Platform 4 (Havana).
    </div><div class="para">
      Note: This document is under development, is subject to substantial change, and is provided only as a preview. The included information and instructions should not be considered complete, and should be used with caution.
    </div></div></div></div></div><div class="toc"><dl><dt><span class="preface"><a href="#pref-Installation_and_Configuration_Guide-Preface">Preface</a></span></dt><dd><dl><dt><span class="section"><a href="#idp14234208">1. Document Conventions</a></span></dt><dd><dl><dt><span class="section"><a href="#idm5637264">1.1. Typographic Conventions</a></span></dt><dt><span class="section"><a href="#idp44977736">1.2. Pull-quote Conventions</a></span></dt><dt><span class="section"><a href="#idm8240296">1.3. Notes and Warnings</a></span></dt></dl></dd><dt><span class="section"><a href="#Getting_Help_and_Giving_Feedback">2. Getting Help and Giving Feedback</a></span></dt></dl></dd><dt><span class="part"><a href="#part-Introduction">I. Introduction</a></span></dt><dd><dl><dt><span class="chapter"><a href="#chap-Product_Introduction">1. Product Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#Overview10">1.1. Overview</a></span></dt><dt><span class="section"><a href="#Architecture6">1.2. Architecture</a></span></dt><dt><span class="section"><a href="#sect-Service_Details">1.3. Service Details</a></span></dt><dd><dl><dt><span class="section"><a href="#Dashboard_-_Horizon">1.3.1. Dashboard Service</a></span></dt><dt><span class="section"><a href="#Identity_-_Keystone">1.3.2. Identity Service</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking">1.3.3. OpenStack Networking Service</a></span></dt><dt><span class="section"><a href="#Block_Storage_-_Cinder">1.3.4. Block Storage Service</a></span></dt><dt><span class="section"><a href="#Compute_-_Nova">1.3.5. Compute Service</a></span></dt><dt><span class="section"><a href="#Image_-_Glance">1.3.6. Image Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_-_Swift">1.3.7. Object Storage Service</a></span></dt><dt><span class="section"><a href="#Metering_-_Ceilometer_Technical_Preview">1.3.8. Metering Service</a></span></dt><dt><span class="section"><a href="#Orchestration_-_Heat_Technical_Preview">1.3.9. Orchestration Service</a></span></dt></dl></dd><dt><span class="section"><a href="#Additional_Documentation1">1.4. Additional Documentation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Prerequisites">2. Prerequisites</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Software_Requirements">2.1. Software Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Operating_System_Requirements">2.1.1. Operating System Requirements</a></span></dt><dt><span class="section"><a href="#sect-Software_Repository_Configuration">2.1.2. Software Repository Configuration</a></span></dt><dt><span class="section"><a href="#Reserved_UIDs_and_GUIDs">2.1.3. Reserved UIDs and GIDs</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Hardware_Requirements">2.2. Hardware Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Compute_Node_Requirements">2.2.1. Compute Node Requirements</a></span></dt><dt><span class="section"><a href="#Network_Node_Requirements">2.2.2. Network Node Requirements</a></span></dt><dt><span class="section"><a href="#Storage_Node_Requirements">2.2.3. Block Storage Node Requirements</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="part"><a href="#part-Deploying_OpenStack_with_Foreman">II. Deploying OpenStack with Foreman</a></span></dt><dd><dl><dt><span class="chapter"><a href="#chap-Foreman_Overview_and_Installation">3. Foreman Overview and Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#Overview13">3.1. Introduction to Foreman OpenStack Manager</a></span></dt><dt><span class="section"><a href="#Installing_Packages">3.2. Installing Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Installer">3.3. Configuring the Installer</a></span></dt><dt><span class="section"><a href="#Running_the_Installer">3.4. Running the Installer</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Configuring_Foreman">4. Configuring Foreman</a></span></dt><dd><dl><dt><span class="section"><a href="#Changing_the_Password">4.1. Changing the Password</a></span></dt><dt><span class="section"><a href="#Configuring_Provisioning">4.2. Configuring Installation Media</a></span></dt><dt><span class="section"><a href="#sect-Editing_Host_Groups">4.3. Editing Host Groups</a></span></dt><dd><dl><dt><span class="section"><a href="#Controller_Node">4.3.1. Controller Node</a></span></dt><dt><span class="section"><a href="#Compute_Node">4.3.2. Compute Node</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Adding_Hosts">5. Adding Hosts</a></span></dt><dd><dl><dt><span class="section"><a href="#Registering_Hosts">5.1. Registering Existing Hosts</a></span></dt><dt><span class="section"><a href="#Provisioning_New_Hosts">5.2. Provisioning New Hosts</a></span></dt><dt><span class="section"><a href="#Provisioning_Hosts">5.3. Assigning Hosts</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Logging_In">6. Logging In</a></span></dt></dl></dd><dt><span class="part"><a href="#part-Installing_OpenStack_Manually">III. Installing OpenStack Manually</a></span></dt><dd><dl><dt><span class="chapter"><a href="#chap-Installing_the_Database_Server">7. Installing the Database Server</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Packages2">7.1. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall3">7.2. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Starting_the_Database_Service">7.3. Starting the Database Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_Database">7.4. Setting the Database Administrator Password</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_Message_Broker">8. Installing the Message Broker</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Packages">8.1. Installing the Packages</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Message_Broker">8.2. Configuring the Message Broker</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Simple_Authentication_and_Security_Layer_-_SASL">8.2.1. Simple Authentication and Security Layer - SASL</a></span></dt><dt><span class="section"><a href="#sect-Configuring_TLSSSL">8.2.2. Configuring TLS/SSL</a></span></dt></dl></dd><dt><span class="section"><a href="#Firewall_Configuration">8.3. Firewall Configuration</a></span></dt><dt><span class="section"><a href="#Starting_the_Messaging_Server">8.4. Starting the Messaging Server</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Identity_Service">9. Installing the OpenStack Identity Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Identity_Service_Requirements">9.1. Identity Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Packages1">9.2. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Creating_the_Identity_Database">9.3. Creating the Identity Database</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Service">9.4. Configuring the Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Setting_the_Initial_Administration_Token">9.4.1. Setting the Administration Token</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String">9.4.2. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Public_Key_Infrastructure">9.4.3. Configuring the Public Key Infrastructure</a></span></dt><dt><span class="section"><a href="#Configuring_for_an_LDAP_Backend">9.4.4. Configuring for an LDAP Backend</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall7">9.4.5. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Identity_Service_Database">9.4.6. Populating the Identity Service Database</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Identity_Service">9.5. Starting the Identity Service</a></span></dt><dt><span class="section"><a href="#Creating_the_Permanent_Service_Endpoint">9.6. Creating the Identity Service Endpoint</a></span></dt><dt><span class="section"><a href="#Creating_Roles1">9.7. Creating an Administrator Account</a></span></dt><dt><span class="section"><a href="#Creating_User_Accounts1">9.8. Creating a Regular User Account</a></span></dt><dt><span class="section"><a href="#Creating_the_Services_Tenant">9.9. Creating the Services Tenant</a></span></dt><dt><span class="section"><a href="#Validating_the_Identity_Service_Installation">9.10. Validating the Identity Service Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Object_Storage_Service">10. Installing the OpenStack Object Storage Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Services_that_Make_Up_the_Object_Storage_Service">10.1. Services that Make Up the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Architecture_of_the_Object_Storage_Service">10.2. Architecture of the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_Service_Requirements">10.3. Object Storage Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Object_Storage_Service_Packages">10.4. Installing the Object Storage Service Packages</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Object_Storage_Service">10.5. Configuring the Object Storage Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuraing_Keystone_for_the_Object_Storage_Service">10.5.1. Configuring the Identity Service to work with the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_Object_Storage_Service_Storage_Nodes">10.5.2. Configuring the Object Storage Service Storage Nodes</a></span></dt><dt><span class="section"><a href="#Configuring_the_Object_Storage_Service_Proxy_Service">10.5.3. Configuring the Object Storage Service Proxy Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_Service_Ring_Files">10.5.4. Object Storage Service Rings</a></span></dt><dt><span class="section"><a href="#Building_Object_Storage_Ring_Files">10.5.5. Building Object Storage Service Ring Files</a></span></dt></dl></dd><dt><span class="section"><a href="#Validating_the_Object_Storage_Service_Installation">10.6. Validating the Object Storage Service Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Image_Service">11. Installing the OpenStack Image Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Image_Storage_Service_Requirements">11.1. Image Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Image_Storage_Service_Packages">11.2. Installing the Image Service Packages</a></span></dt><dt><span class="section"><a href="#Creating_the_Image_Storage_Database">11.3. Creating the Image Service Database</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Image_Service">11.4. Configuring the Image Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_the_Backing_Storage">11.4.1. Configuration Overview</a></span></dt><dt><span class="section"><a href="#Creating_the_Image_Storage_Service_Endpoint">11.4.2. Creating the Image Identity Records</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String5">11.4.3. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String2">11.4.4. Configuring the Use of the Identity Service</a></span></dt><dt><span class="section"><a href="#Using_the_Object_Storage_Service_for_Image_Storage">11.4.5. Using the Object Storage Service for Image Storage</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall">11.4.6. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Image_Storage_Database">11.4.7. Populating the Image Service Database</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Image_Storage_Services">11.5. Starting the Image API and Registry Services</a></span></dt><dt><span class="section"><a href="#sect-Validating_the_Image_Service_Installation">11.6. Validating the Image Service Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#Obtaining_a_Disk_Image_from_Red_Hat_Network">11.6.1. Obtaining a Test Disk Image</a></span></dt><dt><span class="section"><a href="#Building_a_Custom_Disk_Image">11.6.2. Building a Custom Virtual Machine Image</a></span></dt><dt><span class="section"><a href="#Uploading_a_Disk_Image1">11.6.3. Uploading a Disk Image</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Installing_OpenStack_Block_Storage">12. Installing OpenStack Block Storage</a></span></dt><dd><dl><dt><span class="section"><a href="#Block_Storage_Installation_Overview">12.1. Block Storage Installation Overview</a></span></dt><dt><span class="section"><a href="#sect-Block_Storage_Prerequisite_Configuration">12.2. Block Storage Prerequisite Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Block_Storage_Database">12.2.1. Creating the Block Storage Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Block_Storage_Service_Endpoint">12.2.2. Creating the Block Storage Identity Records</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Common_Block_Storage_Configuration">12.3. Common Block Storage Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Block_Storage_Service_Packages">12.3.1. Installing the Block Storage Service Packages</a></span></dt><dt><span class="section"><a href="#Configuring_Authentication3">12.3.2. Configuring Authentication</a></span></dt><dt><span class="section"><a href="#Setting_the_Message_Broker">12.3.3. Setting the Message Broker</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String3">12.3.4. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall6">12.3.5. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Block_Storag_Database">12.3.6. Populating the Block Storage Database</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Volume_Service_Specific_Configuration">12.4. Volume Service Specific Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Block_Storage_Service_Requirements">12.4.1. Block Storage Driver Support</a></span></dt><dt><span class="section"><a href="#Configuring_for_LVM_Storage_Default">12.4.2. Configuring for LVM Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_NFS_Storage">12.4.3. Configuring for NFS Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_Red_Hat_Storage_Backend">12.4.4. Configuring for Red Hat Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_Multiple_Storage_Backends">12.4.5. Configuring for Multiple Storage Backends</a></span></dt><dt><span class="section"><a href="#Configuring_tgtd">12.4.6. Configuring tgtd</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Block_Storage_Service">12.5. Starting the Block Storage Services</a></span></dt><dt><span class="section"><a href="#Validating_the_Block_Storage_Service_Installation">12.6. Validating the Block Storage Service Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Networking_Service">13. Installing the OpenStack Networking Service</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-OpenStack_Networking_Installation_Overview">13.1. OpenStack Networking Installation Overview</a></span></dt><dd><dl><dt><span class="section"><a href="#OpenStack_Netorking_Architecture">13.1.1. OpenStack Networking Architecture</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_API">13.1.2. OpenStack Networking API</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_API_Extensions">13.1.3. OpenStack Networking API Extensions</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_Plug-ins">13.1.4. OpenStack Networking Plug-ins</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_Agents">13.1.5. OpenStack Networking Agents</a></span></dt><dt><span class="section"><a href="#Networking_Service_Requirements">13.1.6. Recommended Networking Deployment</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Networking_Prerequisite_Configuration">13.2. Networking Prerequisite Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Database">13.2.1. Creating the OpenStack Networking Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Service_Endpoint">13.2.2. Creating the OpenStack Networking Identity Records</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Common_Networking_Configuration">13.3. Common Networking Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Upgrading_the_Kernel">13.3.1. Upgrading the Kernel</a></span></dt><dt><span class="section"><a href="#Disabling_Network_Manager">13.3.2. Disabling Network Manager</a></span></dt><dt><span class="section"><a href="#Installing_the_Packages3">13.3.3. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall4">13.3.4. Configuring the Firewall</a></span></dt></dl></dd><dt><span class="section"><a href="#Configuring_the_Networking_Service1">13.4. Configuring the Networking Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_DHCP_Agent">13.5. Configuring the DHCP Agent</a></span></dt><dt><span class="section"><a href="#Configuring_a_Provider_Network1">13.6. Configuring a Provider Network</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Plug-in_Agent">13.7. Configuring the Plug-in Agent</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_the_Open_vSwitch_Plug-in">13.7.1. Configuring the Open vSwitch Plug-in Agent</a></span></dt><dt><span class="section"><a href="#Configuring_the_Linux_Bridge_Plug-in">13.7.2. Configuring the Linux Bridge Plug-in Agent</a></span></dt></dl></dd><dt><span class="section"><a href="#Configuring_the_L3_Agent">13.8. Configuring the L3 Agent</a></span></dt><dt><span class="section"><a href="#Validating_the_OpenStack_Networking_Installation1">13.9. Validating the OpenStack Networking Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Compute_Service">14. Installing the OpenStack Compute Service</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Compute_Service_Requirements">14.1. Compute Service Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Checking_for_Hardware_Virtualization_Support">14.1.1. Checking for Hardware Virtualization Support</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Installing_a_Compute_VNC_Proxy">14.2. Installing a Compute VNC Proxy</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Compute_VNC_Proxy_Packages">14.2.1. Installing the Compute VNC Proxy Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall2">14.2.2. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Starting_the_VNC_Proxy_Server">14.2.3. Controlling the VNC Proxy service</a></span></dt><dt><span class="section"><a href="#Accessing_Instances_with_the_Compute_VNC_Proxy">14.2.4. Accessing Instances with the Compute VNC Proxy</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Installing_a_Compute_Node">14.3. Installing a Compute Node</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Compute_Service_Database">14.3.1. Creating the Compute Service Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Compute_Service_Endpoint">14.3.2. Creating the Compute Identity Records</a></span></dt><dt><span class="section"><a href="#Installing_the_Compute_Service_Packages">14.3.3. Installing the Compute Service</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Compute_Service">14.3.4. Configuring the Compute Service</a></span></dt><dt><span class="section"><a href="#Populating_the_Compute_Service_Database">14.3.5. Populating the Compute Service Database</a></span></dt><dt><span class="section"><a href="#Starting_the_Compute_Services">14.3.6. Starting the Compute Services</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_Dashboard">15. Installing the Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#Dashboard_Service_Requirements">15.1. Dashboard Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Dashboard_Packages">15.2. Installing the Dashboard Packages</a></span></dt><dt><span class="section"><a href="#Starting_the_Dashboard_Service">15.3. Starting the Apache Web Service</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Dashboard">15.4. Configuring the Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_Connections_and_Logging">15.4.1. Configuring Connections and Logging</a></span></dt><dt><span class="section"><a href="#Configuring_Secured_Deployment_HTTPS">15.4.2. Configuring Secured Deployment (HTTPS)</a></span></dt><dt><span class="section"><a href="#Creating_a_Member_Role">15.4.3. Creating a Member Role</a></span></dt><dt><span class="section"><a href="#Configuring_SELinux">15.4.4. Configuring SELinux</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall5">15.4.5. Configuring the Dashboard Firewall</a></span></dt><dt><span class="section"><a href="#sect-Session_Storage_Options">15.4.6. Session Storage Options</a></span></dt></dl></dd><dt><span class="section"><a href="#Validating_the_Dashboard_Installation">15.5. Validating the Dashboard Installation</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#part-Validating_the_Installation">IV. Validating the Installation</a></span></dt><dd><dl><dt><span class="chapter"><a href="#chap-Working_with_Instances">16. Working with Instances</a></span></dt><dd><dl><dt><span class="section"><a href="#Uploading_a_Disk_Image">16.1. Uploading a Disk Image</a></span></dt><dt><span class="section"><a href="#Creating_a_Keypair">16.2. Creating a Keypair</a></span></dt><dt><span class="section"><a href="#Creating_a_Network">16.3. Creating a Network</a></span></dt><dt><span class="section"><a href="#Launching_an_Instance">16.4. Launching an Instance</a></span></dt><dt><span class="section"><a href="#Creating_a_Volume_and_Attaching_a_Volume_to_the_Instance">16.5. Creating a Volume</a></span></dt><dt><span class="section"><a href="#Attaching_a_Volume_to_an_Instance">16.6. Attaching a Volume to an Instance</a></span></dt><dt><span class="section"><a href="#Creating_an_Instance_Snapshot">16.7. Creating an Instance Snapshot</a></span></dt><dt><span class="section"><a href="#Terminating_the_Instance">16.8. Controlling the State of an Instance (Pause, Suspend, Reboot)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Updating_the_Environment">17. Updating the Environment</a></span></dt><dd><dl><dt><span class="section"><a href="#Defining_a_Floating_IP-Address_Pool1">17.1. Defining a Floating IP-Address Pool</a></span></dt><dt><span class="section"><a href="#Creating_a_Router">17.2. Creating a Router</a></span></dt><dt><span class="section"><a href="#Associating_a_Floating_IP_with_the_Instance">17.3. Associating a Floating IP with the Instance</a></span></dt><dt><span class="section"><a href="#Creating_a_Security_Group">17.4. Adding a Rule to a Security Group</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#part-Monitoring_the_OpenStack_Environment">V. Monitoring the OpenStack Environment</a></span></dt><dd><dl><dt><span class="chapter"><a href="#chap-Monitoring_OpenStack_using_Nagios">18. Monitoring OpenStack using Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Installing_Nagios">18.1. Installing Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Nagios_Service">18.1.1. Installing the Nagios Service</a></span></dt><dt><span class="section"><a href="#Installing_the_NPRE_Addon">18.1.2. Installing the NRPE Addon</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Configuring_Nagios">18.2. Configuring Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#Setting_up_Nagios">18.2.1. Setting up Nagios</a></span></dt><dt><span class="section"><a href="#Configuring_HTTPD">18.2.2. Configuring HTTPD</a></span></dt><dt><span class="section"><a href="#Configure_OpenStack_Services">18.2.3. Configuring OpenStack Services</a></span></dt><dt><span class="section"><a href="#Installing_and_Configuring_NRPE">18.2.4. Configuring NRPE</a></span></dt><dt><span class="section"><a href="#Creating_Host_Definitions">18.2.5. Creating Host Definitions</a></span></dt><dt><span class="section"><a href="#Creating_Service_Definitions">18.2.6. Creating Service Definitions</a></span></dt><dt><span class="section"><a href="#Verifying_the_Configuration">18.2.7. Verifying the Configuration</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Installing_and_Configuring_Remote_Logging">19. Installing and Configuring Remote Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#Introduction_to_Remote_Logging">19.1. Introduction to Remote Logging</a></span></dt><dt><span class="section"><a href="#Installing_an_rsyslog_Server">19.2. Installing rsyslog Server</a></span></dt><dt><span class="section"><a href="#Configuring_the_rsyslog_Server">19.3. Configuring rsyslog on the Centralized Logging Server</a></span></dt><dt><span class="section"><a href="#Configuring_rsyslog_on_the_Individual_Nodes">19.4. Configuring rsyslog on the Individual Nodes</a></span></dt><dt><span class="section"><a href="#Starting_rsyslog_Server">19.5. Starting rsyslog Server</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#part-Managing_OpenStack_Environment_Expansion">VI. Managing OpenStack Environment Expansion</a></span></dt><dd><dl><dt><span class="chapter"><a href="#chap-Managing_Compute_Expansion">20. Managing Compute Expansion</a></span></dt><dd><dl><dt><span class="section"><a href="#Defining_Regions">20.1. Defining Regions</a></span></dt><dt><span class="section"><a href="#Adding_Compute_Resources">20.2. Adding Compute Resources</a></span></dt><dt><span class="section"><a href="#Safely_Removing_Compute_Resources">20.3. Safely Removing Compute Resources</a></span></dt><dt><span class="section"><a href="#sect-Using_Config_Drive">20.4. Using Config Drive</a></span></dt><dd><dl><dt><span class="section"><a href="#Config_Drive_Overview">20.4.1. Config Drive Overview</a></span></dt><dt><span class="section"><a href="#sect-Setting_Up_Config_Drive">20.4.2. Setting Up Config Drive</a></span></dt><dt><span class="section"><a href="#Accessing_Config_Drive">20.4.3. Accessing Config Drive</a></span></dt><dt><span class="section"><a href="#sect-Data_Formats">20.4.4. Data Formats</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Managing_Quotas">21. Managing Quotas</a></span></dt><dd><dl><dt><span class="section"><a href="#Viewing_Quotas">21.1. Viewing and Updating Quotas in the Dashboard</a></span></dt><dt><span class="section"><a href="#Updating_Quotas">21.2. Updating Compute Service Quotas on the Command Line</a></span></dt><dt><span class="section"><a href="#Updating_Block_Storage_Service_Quotes">21.3. Updating Block Storage Service Quotas on the Command Line</a></span></dt></dl></dd></dl></dd><dt><span class="appendix"><a href="#appe-Installation_Checklist">A. Installation Checklist</a></span></dt><dd><dl><dt><span class="section"><a href="#Installation_Prerequisites_Checklists">A.1. Installation Prerequisites Checklists</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appe-Troubleshooting_the_OpenStack_Environment">B. Troubleshooting the OpenStack Environment</a></span></dt><dd><dl><dt><span class="section"><a href="#Troubleshooting_Overview">B.1. No Networks or Routers Tab Appears in the Dashboard</a></span></dt><dt><span class="section"><a href="#Dashboard_Reports_ERROR_When_Launching_Instances">B.2. Dashboard Reports ERROR When Launching Instances</a></span></dt><dt><span class="section"><a href="#Dashboard_Log_Tab_Shows_no_Output_for_Instance">B.3. Compute Instance Log Shows no Output</a></span></dt><dt><span class="section"><a href="#Keystone_Client_Reports_Unable_to_communicate_with_identity_service">B.4. Identity Client (keystone) Reports &quot;Unable to communicate with identity service&quot;</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appe-Service_Log_Files">C. Service Log Files</a></span></dt><dd><dl><dt><span class="section"><a href="#Block_Storage_Service_Log_Files">C.1. Block Storage Service Log Files</a></span></dt><dt><span class="section"><a href="#Compute_Service_Log_Files">C.2. Compute Service Log Files</a></span></dt><dt><span class="section"><a href="#Apache_Web_Server_Log_Files">C.3. Dashboard Log Files</a></span></dt><dt><span class="section"><a href="#Identity_Service_Log_Files">C.4. Identity Service Log Files</a></span></dt><dt><span class="section"><a href="#Image_Storage_Service_Log_Files">C.5. Image Service Log Files</a></span></dt><dt><span class="section"><a href="#Networking_Service_Log_Files">C.6. Networking Service Log Files</a></span></dt><dt><span class="section"><a href="#Object_Storage_Service_Log_Files">C.7. Object Storage Service Log Files</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appe-Installation_and_Configuration_Guide-Revision_History">D. Revision History</a></span></dt></dl></div><div class="preface"><div class="titlepage"><div><div><h1 class="title"><a id="pref-Installation_and_Configuration_Guide-Preface"></a>Preface</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idp14234208"></a>1.&nbsp;Document Conventions</h2></div></div></div><div class="para">
    This manual uses several conventions to highlight certain words and phrases and draw attention to specific pieces of information.
  </div><div class="para">
    In PDF and paper editions, this manual uses typefaces drawn from the <a href="https://fedorahosted.org/liberation-fonts/">Liberation Fonts</a> set. The Liberation Fonts set is also used in HTML editions if the set is installed on your system. If not, alternative but equivalent typefaces are displayed. Note: Red Hat Enterprise Linux 5 and later include the Liberation Fonts set by default.
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm5637264"></a>1.1.&nbsp;Typographic Conventions</h3></div></div></div><div class="para">
      Four typographic conventions are used to call attention to specific words and phrases. These conventions, and the circumstances they apply to, are as follows.
    </div><div class="para">
      <code class="literal">Mono-spaced Bold</code>
    </div><div class="para">
      Used to highlight system input, including shell commands, file names and paths. Also used to highlight keys and key combinations. For example:
    </div><div class="blockquote"><blockquote class="blockquote"><div class="para">
        To see the contents of the file <code class="filename">my_next_bestselling_novel</code> in your current working directory, enter the <code class="command">cat my_next_bestselling_novel</code> command at the shell prompt and press <span class="keycap"><strong>Enter</strong></span> to execute the command.
      </div></blockquote></div><div class="para">
      The above includes a file name, a shell command and a key, all presented in mono-spaced bold and all distinguishable thanks to context.
    </div><div class="para">
      Key combinations can be distinguished from an individual key by the plus sign that connects each part of a key combination. For example:
    </div><div class="blockquote"><blockquote class="blockquote"><div class="para">
        Press <span class="keycap"><strong>Enter</strong></span> to execute the command.
      </div><div class="para">
        Press <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F2</strong></span> to switch to a virtual terminal.
      </div></blockquote></div><div class="para">
      The first example highlights a particular key to press. The second example highlights a key combination: a set of three keys pressed simultaneously.
    </div><div class="para">
      If source code is discussed, class names, methods, functions, variable names and returned values mentioned within a paragraph will be presented as above, in <code class="literal">mono-spaced bold</code>. For example:
    </div><div class="blockquote"><blockquote class="blockquote"><div class="para">
        File-related classes include <code class="classname">filesystem</code> for file systems, <code class="classname">file</code> for files, and <code class="classname">dir</code> for directories. Each class has its own associated set of permissions.
      </div></blockquote></div><div class="para">
      <span class="application"><strong>Proportional Bold</strong></span>
    </div><div class="para">
      This denotes words or phrases encountered on a system, including application names; dialog box text; labeled buttons; check-box and radio button labels; menu titles and sub-menu titles. For example:
    </div><div class="blockquote"><blockquote class="blockquote"><div class="para">
        Choose <span class="guimenu"><strong>System</strong></span> → <span class="guisubmenu"><strong>Preferences</strong></span> → <span class="guimenuitem"><strong>Mouse</strong></span> from the main menu bar to launch <span class="application"><strong>Mouse Preferences</strong></span>. In the <span class="guilabel"><strong>Buttons</strong></span> tab, select the <span class="guilabel"><strong>Left-handed mouse</strong></span> check box and click <span class="guibutton"><strong>Close</strong></span> to switch the primary mouse button from the left to the right (making the mouse suitable for use in the left hand).
      </div><div class="para">
        To insert a special character into a <span class="application"><strong>gedit</strong></span> file, choose <span class="guimenu"><strong>Applications</strong></span> → <span class="guisubmenu"><strong>Accessories</strong></span> → <span class="guimenuitem"><strong>Character Map</strong></span> from the main menu bar. Next, choose <span class="guimenu"><strong>Search</strong></span> → <span class="guimenuitem"><strong>Find…</strong></span> from the <span class="application"><strong>Character Map</strong></span> menu bar, type the name of the character in the <span class="guilabel"><strong>Search</strong></span> field and click <span class="guibutton"><strong>Next</strong></span>. The character you sought will be highlighted in the <span class="guilabel"><strong>Character Table</strong></span>. Double-click this highlighted character to place it in the <span class="guilabel"><strong>Text to copy</strong></span> field and then click the <span class="guibutton"><strong>Copy</strong></span> button. Now switch back to your document and choose <span class="guimenu"><strong>Edit</strong></span> → <span class="guimenuitem"><strong>Paste</strong></span> from the <span class="application"><strong>gedit</strong></span> menu bar.
      </div></blockquote></div><div class="para">
      The above text includes application names; system-wide menu names and items; application-specific menu names; and buttons and text found within a GUI interface, all presented in proportional bold and all distinguishable by context.
    </div><div class="para">
      <code class="command"><em class="replaceable"><code>Mono-spaced Bold Italic</code></em></code> or <span class="application"><strong><em class="replaceable"><code>Proportional Bold Italic</code></em></strong></span>
    </div><div class="para">
      Whether mono-spaced bold or proportional bold, the addition of italics indicates replaceable or variable text. Italics denotes text you do not input literally or displayed text that changes depending on circumstance. For example:
    </div><div class="blockquote"><blockquote class="blockquote"><div class="para">
        To connect to a remote machine using ssh, type <code class="command">ssh <em class="replaceable"><code>username</code></em>@<em class="replaceable"><code>domain.name</code></em></code> at a shell prompt. If the remote machine is <code class="filename">example.com</code> and your username on that machine is john, type <code class="command">ssh john@example.com</code>.
      </div><div class="para">
        The <code class="command">mount -o remount <em class="replaceable"><code>file-system</code></em></code> command remounts the named file system. For example, to remount the <code class="filename">/home</code> file system, the command is <code class="command">mount -o remount /home</code>.
      </div><div class="para">
        To see the version of a currently installed package, use the <code class="command">rpm -q <em class="replaceable"><code>package</code></em></code> command. It will return a result as follows: <code class="command"><em class="replaceable"><code>package-version-release</code></em></code>.
      </div></blockquote></div><div class="para">
      Note the words in bold italics above — username, domain.name, file-system, package, version and release. Each word is a placeholder, either for text you enter when issuing a command or for text displayed by the system.
    </div><div class="para">
      Aside from standard usage for presenting the title of a work, italics denotes the first use of a new and important term. For example:
    </div><div class="blockquote"><blockquote class="blockquote"><div class="para">
        Publican is a <em class="firstterm">DocBook</em> publishing system.
      </div></blockquote></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp44977736"></a>1.2.&nbsp;Pull-quote Conventions</h3></div></div></div><div class="para">
      Terminal output and source code listings are set off visually from the surrounding text.
    </div><div class="para">
      Output sent to a terminal is set in <code class="computeroutput">mono-spaced roman</code> and presented thus:
    </div><pre class="screen">books        Desktop   documentation  drafts  mss    photos   stuff  svn
books_tests  Desktop1  downloads      images  notes  scripts  svgs</pre><div class="para">
      Source-code listings are also set in <code class="computeroutput">mono-spaced roman</code> but add syntax highlighting as follows:
    </div><pre class="programlisting"><span class="perl_DataType">static</span> <span class="perl_DataType">int</span> kvm_vm_ioctl_deassign_device(<span class="perl_Keyword">struct</span> kvm *kvm,
                 <span class="perl_Keyword">struct</span> kvm_assigned_pci_dev *assigned_dev)
{
         <span class="perl_DataType">int</span> r = 0;
         <span class="perl_Keyword">struct</span> kvm_assigned_dev_kernel *match;

         mutex_lock(&amp;kvm-&gt;lock);

         match = kvm_find_assigned_dev(&amp;kvm-&gt;arch.assigned_dev_head,
                                       assigned_dev-&gt;assigned_dev_id);
         <span class="perl_Keyword">if</span> (!match) {
                 printk(KERN_INFO <span class="perl_String">&quot;%s: device hasn't been assigned before, &quot;</span>
                   <span class="perl_String">&quot;so cannot be deassigned</span><span class="perl_Char">\n</span><span class="perl_String">&quot;</span>, __func__);
                 r = -EINVAL;
                 <span class="perl_Keyword">goto</span> out;
         }

         kvm_deassign_device(kvm, match);

         kvm_free_assigned_device(kvm, match);

out:
         mutex_unlock(&amp;kvm-&gt;lock);
         <span class="perl_Keyword">return</span> r;
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm8240296"></a>1.3.&nbsp;Notes and Warnings</h3></div></div></div><div class="para">
      Finally, we use three visual styles to draw attention to information that might otherwise be overlooked.
    </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
        Notes are tips, shortcuts or alternative approaches to the task at hand. Ignoring a note should have no negative consequences, but you might miss out on a trick that makes your life easier.
      </div></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
        Important boxes detail things that are easily missed: configuration changes that only apply to the current session, or services that need restarting before an update will apply. Ignoring a box labeled 'Important' will not cause data loss but may cause irritation and frustration.
      </div></div></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
        Warnings should not be ignored. Ignoring warnings will most likely cause data loss.
      </div></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Getting_Help_and_Giving_Feedback"></a>2.&nbsp;Getting Help and Giving Feedback</h2></div></div></div><div class="para">
    If you experience difficulty with a procedure described in this documentation, visit the Red Hat Customer Portal at <a href="http://access.redhat.com">http://access.redhat.com</a>. Through the customer portal, you can:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        search or browse through a knowledge base of technical support articles about Red Hat products.
      </div></li><li class="listitem"><div class="para">
        submit a support case to Red Hat Global Support Services (GSS).
      </div></li><li class="listitem"><div class="para">
        access other product documentation.
      </div></li></ul></div><div class="para">
    Red Hat also hosts a large number of electronic mailing lists for discussion of Red Hat software and technology. You can find a list of publicly available mailing lists at <a href="https://www.redhat.com/mailman/listinfo">https://www.redhat.com/mailman/listinfo</a>. Click on the name of any mailing list to subscribe to that list or to access the list archives.
  </div><div class="formalpara"><div class="title">We Need Feedback</div>
      If you find a typographical error in this manual, or if you have thought of a way to make this manual better, we would love to hear from you. Please submit a report in Bugzilla: <a href="http://bugzilla.redhat.com/">http://bugzilla.redhat.com/</a> against the product <a href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red Hat OpenStack"><span class="application"><strong>Red Hat OpenStack</strong></span></a>.
    </div><div class="para">
    When submitting a bug report, be sure to mention the manual's identifier: <a href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20OpenStack&amp;component=doc-Installation_and_Configuration_Guide"><em class="citetitle">doc-Installation_and_Configuration_Guide</em></a>
  </div><div class="para">
    If you have a suggestion for improving the documentation, try to be as specific as possible when describing it. If you have found an error, please include the section number and some of the surrounding text so we can find it easily.
  </div></div></div><div class="part"><div class="titlepage"><div><div><h1 class="title"><a id="part-Introduction"></a>Part&nbsp;I.&nbsp;Introduction</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#chap-Product_Introduction">1. Product Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#Overview10">1.1. Overview</a></span></dt><dt><span class="section"><a href="#Architecture6">1.2. Architecture</a></span></dt><dt><span class="section"><a href="#sect-Service_Details">1.3. Service Details</a></span></dt><dd><dl><dt><span class="section"><a href="#Dashboard_-_Horizon">1.3.1. Dashboard Service</a></span></dt><dt><span class="section"><a href="#Identity_-_Keystone">1.3.2. Identity Service</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking">1.3.3. OpenStack Networking Service</a></span></dt><dt><span class="section"><a href="#Block_Storage_-_Cinder">1.3.4. Block Storage Service</a></span></dt><dt><span class="section"><a href="#Compute_-_Nova">1.3.5. Compute Service</a></span></dt><dt><span class="section"><a href="#Image_-_Glance">1.3.6. Image Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_-_Swift">1.3.7. Object Storage Service</a></span></dt><dt><span class="section"><a href="#Metering_-_Ceilometer_Technical_Preview">1.3.8. Metering Service</a></span></dt><dt><span class="section"><a href="#Orchestration_-_Heat_Technical_Preview">1.3.9. Orchestration Service</a></span></dt></dl></dd><dt><span class="section"><a href="#Additional_Documentation1">1.4. Additional Documentation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Prerequisites">2. Prerequisites</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Software_Requirements">2.1. Software Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Operating_System_Requirements">2.1.1. Operating System Requirements</a></span></dt><dt><span class="section"><a href="#sect-Software_Repository_Configuration">2.1.2. Software Repository Configuration</a></span></dt><dt><span class="section"><a href="#Reserved_UIDs_and_GUIDs">2.1.3. Reserved UIDs and GIDs</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Hardware_Requirements">2.2. Hardware Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Compute_Node_Requirements">2.2.1. Compute Node Requirements</a></span></dt><dt><span class="section"><a href="#Network_Node_Requirements">2.2.2. Network Node Requirements</a></span></dt><dt><span class="section"><a href="#Storage_Node_Requirements">2.2.3. Block Storage Node Requirements</a></span></dt></dl></dd></dl></dd></dl></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Product_Introduction"></a>Chapter&nbsp;1.&nbsp;Product Introduction</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Overview10">1.1. Overview</a></span></dt><dt><span class="section"><a href="#Architecture6">1.2. Architecture</a></span></dt><dt><span class="section"><a href="#sect-Service_Details">1.3. Service Details</a></span></dt><dd><dl><dt><span class="section"><a href="#Dashboard_-_Horizon">1.3.1. Dashboard Service</a></span></dt><dt><span class="section"><a href="#Identity_-_Keystone">1.3.2. Identity Service</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking">1.3.3. OpenStack Networking Service</a></span></dt><dt><span class="section"><a href="#Block_Storage_-_Cinder">1.3.4. Block Storage Service</a></span></dt><dt><span class="section"><a href="#Compute_-_Nova">1.3.5. Compute Service</a></span></dt><dt><span class="section"><a href="#Image_-_Glance">1.3.6. Image Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_-_Swift">1.3.7. Object Storage Service</a></span></dt><dt><span class="section"><a href="#Metering_-_Ceilometer_Technical_Preview">1.3.8. Metering Service</a></span></dt><dt><span class="section"><a href="#Orchestration_-_Heat_Technical_Preview">1.3.9. Orchestration Service</a></span></dt></dl></dd><dt><span class="section"><a href="#Additional_Documentation1">1.4. Additional Documentation</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Overview10"></a>1.1.&nbsp;Overview</h2></div></div></div><div class="para">
    Red Hat Enterprise Linux OpenStack Platform provides the foundation to build a private or public Infrastructure-as-a-Service (IaaS) cloud on top of Red Hat Enterprise Linux. It offers a massively scalable, fault-tolerant platform for the development of cloud-enabled workloads.
  </div><div class="para">
    The current Red Hat system is based on OpenStack Havana, and packaged so that available physical hardware can be turned into a private, public, or hybrid cloud platform including:
  </div><div class="para">
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Fully distributed object storage
        </div></li><li class="listitem"><div class="para">
          Persistent block-level storage
        </div></li><li class="listitem"><div class="para">
          Virtual-machine provisioning engine and image storage
        </div></li><li class="listitem"><div class="para">
          Authentication and authorization mechanism
        </div></li><li class="listitem"><div class="para">
          Integrated networking
        </div></li><li class="listitem"><div class="para">
          Web browser-based GUI for both users and administration.
        </div></li></ul></div>

  </div><div class="para">
    The Red Hat Enterprise Linux OpenStack Platform IaaS cloud is implemented by a collection of interacting services that control its computing, storage, and networking resources. The cloud is managed using a web-based interface which allows administrators to control, provision, and automate resources. Additionally, the Red Hat Enterprise Linux OpenStack Platform infrastructure is facilitated through an extensive API, which is also available to end users of the cloud.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15923-542873+%5BLatest%5D&amp;cf_build_id=15923-542873+03+Oct+2013+10%3A41+en-US+%5BLatest%5D&amp;comment=Title%3A+Overview%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Architecture6"></a>1.2.&nbsp;Architecture</h2></div></div></div><div class="para">
    The following diagram provides a high-level overview of the OpenStack architecture.
    <div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2440.png" align="middle" width="100%" alt="alternate text goes here" /></div>

  </div><div class="para">
    Each OpenStack service has a code name, which is reflected in the names of configuration files and command-line utility programs. For example, the Identity service has a configuration file called keystone.conf.
  </div><div class="para">
    <div class="table"><a id="idp3720920"></a><p class="title"><strong>Table&nbsp;1.1.&nbsp;Services</strong></p><div class="table-contents"><table summary="Services"><colgroup><col width="5%" align="left" class="c1" /><col width="20%" align="left" class="c2" /><col width="10%" align="left" class="c3" /><col width="54%" align="left" class="c4" /></colgroup><thead><tr><th class="" align="left">

            </th><th class="" align="left">
              Service
            </th><th class="" align="left">
              Codename
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2427.png" align="middle" /></span>

            </td><td class="" align="left">
              Dashboard
            </td><td class="" align="left">
              horizon
            </td><td class="" align="left">
              <div class="para">
                A web-based dashboard for managing OpenStack services.
              </div>

            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2428.png" align="middle" /></span>

            </td><td class="" align="left">
              Identity
            </td><td class="" align="left">
              keystone
            </td><td class="" align="left">
              A centralized identity service that provides authentication and authorization for other services, and manages users, tenants, and roles.
            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2429.png" /></span>

            </td><td class="" align="left">
              OpenStack Networking
            </td><td class="" align="left">
              neutron
            </td><td class="" align="left">
              A networking service that provides connectivity between the interfaces of other OpenStack services.
            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2430.png" /></span>

            </td><td class="" align="left">
              Block Storage
            </td><td class="" align="left">
              cinder
            </td><td class="" align="left">
              A service that manages persistent block storage volumes for virtual machines.
            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2431.png" /></span>

            </td><td class="" align="left">
              Compute
            </td><td class="" align="left">
              nova
            </td><td class="" align="left">
              A service that launches and schedules networks of machines running on nodes.
            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2432.png" /></span>

            </td><td class="" align="left">
              Image
            </td><td class="" align="left">
              glance
            </td><td class="" align="left">
              A registry service for virtual machine images.
            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2433.png" /></span>

            </td><td class="" align="left">
              Object Storage
            </td><td class="" align="left">
              swift
            </td><td class="" align="left">
              A service providing object storage which allows users to store and retrieve files (arbitrary data).
            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2441.png" /></span>

            </td><td class="" align="left">
              <div class="para">
                Metering
              </div>

            </td><td class="" align="left">
              ceilometer
            </td><td class="" align="left">
              A service providing measurements of cloud resources.
            </td></tr><tr><td class="" align="left">
              <span class="inlinemediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2442.png" /></span>

            </td><td class="" align="left">
              <div class="para">
                Orchestration
              </div>

            </td><td class="" align="left">
              heat
            </td><td class="" align="left">
              A service providing a template-based orchestration engine, which supports the automatic creation of resource stacks.
            </td></tr></tbody></table></div></div><br class="table-break" />
     The following Service Details section provides more detailed information about the Openstack service components. Each OpenStack service is comprised of a collection of Linux services, MySQL databases, or other components, which together provide a functional group. For example, the <code class="systemitem">glance-api</code> and <code class="systemitem">glance-registry</code> Linux services, together with a MySQL database, implement the Image service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15847-550054+%5BLatest%5D&amp;cf_build_id=15847-550054+01+Nov+2013+09%3A47+en-US+%5BLatest%5D&amp;comment=Title%3A+Architecture%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;assigned_to=slong%40redhat.com&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Service_Details"></a>1.3.&nbsp;Service Details</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Dashboard_-_Horizon"></a>1.3.1.&nbsp;Dashboard Service</h3></div></div></div><div class="para">
    The Dashboard service provides a graphical user interface for end users and administrators, allowing operations such as creating and launching instances, managing networking, and setting access controls. Its modular design allows interfacing with other products such as billing, monitoring, and additional management tools. The service provides three basic dashboards: user, system, and settings.
  </div><div class="para">
    The following screenshot displays a user's dashboard after OpenStack is first installed:
  </div><div class="para">
    <div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2434.png" width="670" alt="alternate text goes here" /></div>

  </div><div class="para">
    The identity of the logged-in user determines the dashboards and panels that are visible in the dashboard.
  </div><div class="para">
    <div class="table"><a id="idp212000"></a><p class="title"><strong>Table&nbsp;1.2.&nbsp;Dashboard Service components</strong></p><div class="table-contents"><table summary="Dashboard Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                openstack-dashboard
              </div>

            </td><td class="" align="left">
              <div class="para">
                A Django (Python) web application, provides access to the dashboard using any web browser.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                An Apache HTTP server (<code class="systemitem">httpd</code> service)
              </div>

            </td><td class="" align="left">
              <div class="para">
                Hosts the application.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Database
              </div>

            </td><td class="" align="left">
              <div class="para">
                For managing sessions.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15853-541150+%5BLatest%5D&amp;cf_build_id=15853-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Dashboard+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Identity_-_Keystone"></a>1.3.2.&nbsp;Identity Service</h3></div></div></div><div class="para">
    The Identity service authenticates and authorizes OpenStack users (that is, keeps track of users and their permitted activities); the service is used by all OpenStack components. The service supports multiple forms of authentication including user name and password credentials, token-based systems, and AWS-style logins (Amazon Web Services).
  </div><div class="para">
    The Identity service also provides a central catalog of services and endpoints running in a particular OpenStack cloud, which acts as a service directory for other OpenStack systems. Each endpoint is assigned:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          <code class="systemitem">adminURL</code>, the URL for the administrative endpoint for the service. Only the Identity service might use a value here that is different from publicURL; all other services will use the same value.
        </div></li><li class="listitem"><div class="para">
          <code class="systemitem">internalURL</code>, the URL of an internal-facing endpoint for the service (typically same as the publicURL).
        </div></li><li class="listitem"><div class="para">
          <code class="systemitem">publicURL</code>, the URL of the public-facing endpoint for the service.
        </div></li><li class="listitem"><div class="para">
          <code class="systemitem">region</code>, in which the service is located. By default, if a region is not specified, the 'RegionOne' location is used.
        </div></li></ul></div>

  </div><div class="para">
    The Identity service uses the following concepts:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Users, which have associated information (such as a name and password). In addition to custom users, a user must be defined for each cataloged service (for example, the 'glance' user for the Image service).
        </div></li><li class="listitem"><div class="para">
          Tenants, which are generally the user's group, project, or organization.
        </div></li><li class="listitem"><div class="para">
          Roles, which determine a user's permissions.
        </div></li></ul></div>

  </div><div class="para">
    <div class="table"><a id="idm474544"></a><p class="title"><strong>Table&nbsp;1.3.&nbsp;Identity Service components</strong></p><div class="table-contents"><table summary="Identity Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                keystone
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides the administrative and public APIs.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Databases
              </div>

            </td><td class="" align="left">
              <div class="para">
                For each of the internal services.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15940-541150+%5BLatest%5D&amp;cf_build_id=15940-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Identity+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="OpenStack_Networking"></a>1.3.3.&nbsp;OpenStack Networking Service</h3></div></div></div><div class="para">
    The OpenStack Networking service provides a scalable and API-driven system for managing the network connectivity, addressing, and services within an OpenStack IaaS cloud deployment. Because the OpenStack network is software-defined, it can easily and quickly react to changing network needs (for example, creating and assigning new IP addresses).
  </div><div class="para">
    Advantages include:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Users can create networks, control traffic, and connect servers and devices to one or more networks.
        </div></li><li class="listitem"><div class="para">
          OpenStack offers flexible networking models, so that administrators can change the networking model to adapt to their volume and tenancy.
        </div></li><li class="listitem"><div class="para">
          IPs can be dedicated or floating; floating IPs allow dynamic traffic rerouting.
        </div></li></ul></div>

  </div><div class="para">
    <div class="table"><a id="idm4241984"></a><p class="title"><strong>Table&nbsp;1.4.&nbsp;Networking Service components</strong></p><div class="table-contents"><table summary="Networking Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                neutron-server
              </div>

            </td><td class="" align="left">
              <div class="para">
                A Python daemon, which manages user requests (and exposes the API). It is configured with a plugin that implements the OpenStack Networking API operations using a specific set of networking mechanisms. A wide choice of plugins are also available. For example, the <code class="systemitem">openvswitch</code> and <code class="systemitem">linuxbridge</code> plugins utilize native Linux networking mechanisms, while other plugins interface with external devices or SDN controllers.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                neutron-l3-agent
              </div>

            </td><td class="" align="left">
              <div class="para">
                An agent providing L3/NAT forwarding.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                neutron-*-agent
              </div>

            </td><td class="" align="left">
              <div class="para">
                A plug-in agent that runs on each node to perform local networking configuration for the node's VMs and networking services.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                neutron-dhcp-agent
              </div>

            </td><td class="" align="left">
              <div class="para">
                An agent providing DHCP services to tenant networks.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Database
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides persistent storage.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15859-550055+%5BLatest%5D&amp;cf_build_id=15859-550055+01+Nov+2013+09%3A47+en-US+%5BLatest%5D&amp;comment=Title%3A+OpenStack+Networking+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Block_Storage_-_Cinder"></a>1.3.4.&nbsp;Block Storage Service</h3></div></div></div><div class="para">
    The Block Storage (or volume) service provides persistent block storage management for virtual hard drives. The block storage system manages the creation of block devices to servers. Block storage volumes are fully integrated into both the Compute and Dashboard services, which allows cloud users to manage their own storage needs (Compute handles the attaching and detaching of devices). Both regions and zones (for details, refer to the Object Storage section) can be used to handle distributed block storage hosts.
  </div><div class="para">
    Block storage is appropriate for performance-sensitive scenarios such as database storage, expandable file systems, or providing a server with access to raw block-level storage. Additionally, snapshots can be taken to either restore data or to create new block storage volumes (snapshots are dependent upon driver support).
  </div><div class="para">
    Basic operations include:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Create, list, and delete volumes.
        </div></li><li class="listitem"><div class="para">
          Create, list, and delete snapshots.
        </div></li><li class="listitem"><div class="para">
          Attach and detach volumes to running virtual machines.
        </div></li></ul></div>

  </div><div class="para">
    <div class="table"><a id="idm10149712"></a><p class="title"><strong>Table&nbsp;1.5.&nbsp;Block Storage Service components</strong></p><div class="table-contents"><table summary="Block Storage Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                openstack-cinder-volume
              </div>

            </td><td class="" align="left">
              <div class="para">
                Carves out storage for virtual machines on demand. A number of drivers are included for interaction with storage providers.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-cinder-api
              </div>

            </td><td class="" align="left">
              <div class="para">
                Responds to and handles requests, and places them in the message queue.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-cinder-scheduler
              </div>

            </td><td class="" align="left">
              <div class="para">
                Assigns tasks to the queue and determines the provisioning volume server.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Database
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides state information.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Compute_-_Nova">Section&nbsp;1.3.5, “Compute Service”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15941-541150+%5BLatest%5D&amp;cf_build_id=15941-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Block+Storage+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Compute_-_Nova"></a>1.3.5.&nbsp;Compute Service</h3></div></div></div><div class="para">
    The Compute service is the heart of the OpenStack cloud by providing virtual machines on demand. Compute schedules virtual machines to run on a set of nodes by defining drivers that interact with underlying virtualization mechanisms, and exposing the functionality to the other OpenStack components.
  </div><div class="para">
    Compute interacts with the Identity service for authentication, Image service for images, and the Dashboard service for the user and administrative interface. Access to images is limited by project and by user; quotas are limited per project (for example, the number of instances). The Compute service is designed to scale horizontally on standard hardware, and can download images to launch instances as required.
  </div><div class="para">
    <div class="table"><a id="idm1943112"></a><p class="title"><strong>Table&nbsp;1.6.&nbsp;Ways to Segregate the Cloud</strong></p><div class="table-contents"><table summary="Ways to Segregate the Cloud"><colgroup><col width="20%" align="left" class="c1" /><col width="80%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Concept
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Regions
              </div>

            </td><td class="" align="left">
              <div class="para">
                Each service cataloged in the Identity service is identified by its region, which typically represents a geographical location, and its endpoint. In a cloud with multiple Compute deployments, regions allow for the discrete separation of services, and are a robust way to share some infrastructure between Compute installations, while allowing for a high degree of failure tolerance.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Cells
              </div>

            </td><td class="" align="left">
              <div class="para">
                A cloud's Compute hosts can be partitioned into groups called cells (to handle large deployments or geographically separate installations). Cells are configured in a tree. The top-level cell ('API cell') runs the <code class="systemitem">nova-api</code> service, but no <code class="systemitem">nova-compute</code> services. In contrast, each child cell runs all of the other typical <code class="systemitem">nova-*</code> services found in a regular installation, except for the <code class="systemitem">nova-api</code> service. Each cell has its own message queue and database service, and also runs <code class="systemitem">nova-cells</code>, which manages the communication between the API cell and its child cells.
              </div>
               <div class="para">
                This means that:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      A single API server can be used to control access to multiple Compute installations.
                    </div></li><li class="listitem"><div class="para">
                      A second level of scheduling at the cell level is available (versus host scheduling), which provides greater flexibility over the control of where virtual machines are run.
                    </div></li></ul></div>

              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Host Aggregates and Availability Zones
              </div>

            </td><td class="" align="left">
              <div class="para">

              </div>
               <div class="para">
                A single Compute deployment can be partitioned into logical groups (for example, into multiple groups of hosts that share common resources like storage and network, or which have a special property such as trusted computing hardware).
              </div>
               <div class="para">
                If the user is:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      An administrator, the group is presented as a Host Aggregate, which has assigned Compute hosts and associated metadata. An aggregate's metadata is commonly used to provide information for use with <code class="systemitem">nova-scheduler</code> (for example, limiting specific flavors or images to a subset of hosts).
                    </div></li><li class="listitem"><div class="para">
                      A user, the group is presented as an Availability Zone. The user cannot view the group's metadata, nor which hosts make up the zone.
                    </div></li></ul></div>

              </div>
               <div class="para">
                Aggregates, or zones, can be used to:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      Handle load balancing and instance distribution.
                    </div></li><li class="listitem"><div class="para">
                      Provide some form of physical isolation and redundancy from other zones (such as by using a separate power supply or network equipment).
                    </div></li><li class="listitem"><div class="para">
                      Identify a set of servers that have some common attribute.
                    </div></li><li class="listitem"><div class="para">
                      Separate out different classes of hardware.
                    </div></li></ul></div>

              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idp624672"></a><p class="title"><strong>Table&nbsp;1.7.&nbsp;Compute Service components</strong></p><div class="table-contents"><table summary="Compute Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                openstack-nova-api
              </div>

            </td><td class="" align="left">
              <div class="para">
                Handles requests and provides access to the Compute services (such as booting an instance).
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-nova-cert
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides the certificate manager.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-nova-compute
              </div>

            </td><td class="" align="left">
              <div class="para">
                Creates and terminates virtual instances. Interacts with the Hypervisor to bring up new instances, and ensures that the state is maintained in the Compute database.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-nova-conductor
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides database-access support for Compute nodes (thereby reducing security risks).
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-nova-consoleauth
              </div>

            </td><td class="" align="left">
              <div class="para">
                Handles console authentication.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-nova-network
              </div>

            </td><td class="" align="left">
              <div class="para">
                Handles Compute network traffic (both private and public access). Handles such tasks as assigning an IP address to a new virtual instance, and implementing security group rules.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-nova-novncproxy
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides a VNC proxy for browsers (enabling VNC consoles to access virtual machines).
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-nova-scheduler
              </div>

            </td><td class="" align="left">
              <div class="para">
                Dispatches requests for new virtual machines to the correct node.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Apache Qpid server (<code class="systemitem">qpidd</code>)
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides the AMPQ message queue. This server (also used by Block Storage) handles the OpenStack transaction management, including queuing, distribution, security, management, clustering, and federation. Messaging becomes especially important when an OpenStack deployment is scaled and its services are running on multiple machines.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                libvirtd
              </div>

            </td><td class="" align="left">
              <div class="para">
                The driver for the hypervisor. Enables the creation of virtual machines.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                KVM Linux hypervisor
              </div>

            </td><td class="" align="left">
              <div class="para">
                Creates virtual machines and enables their live migration from node to node.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Database
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides build-time and run-time infrastructure state.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15939-549818+%5BLatest%5D&amp;cf_build_id=15939-549818+31+Oct+2013+10%3A52+en-US+%5BLatest%5D&amp;comment=Title%3A+Compute+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Image_-_Glance"></a>1.3.6.&nbsp;Image Service</h3></div></div></div><div class="para">
    The Image service acts as a registry for virtual disk images. Users can add new images or take a snapshot (copy) of an existing server for immediate storage. Snapshots can be used as back up or as templates for new servers. Registered images can be stored in the Object Storage service, as well as in other locations (for example, in simple file systems or external web servers).
  </div><div class="para">
    The following image formats are supported:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          raw (unstructured format)
        </div></li><li class="listitem"><div class="para">
          aki/ami/ari (Amazon kernel, ramdisk, or machine image)
        </div></li><li class="listitem"><div class="para">
          iso (archive format for optical discs; for example, CDROM)
        </div></li><li class="listitem"><div class="para">
          qcow2 (Qemu/KVM, supports <em class="firstterm">Copy on Write</em>)
        </div></li><li class="listitem"><div class="para">
          vhd (Hyper-V, common for virtual machine monitors from VMWare, Xen, Microsoft, VirtualBox, and others)
        </div></li><li class="listitem"><div class="para">
          vdi (Qemu/VirtualBox)
        </div></li><li class="listitem"><div class="para">
          vmdk (VMWare)
        </div></li></ul></div>

  </div><div class="para">
    Container formats can also be used by the Image service; the format determines the type of metadata stored in the image about the actual virtual machine. The following formats are supported.
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          bare (no metadata is included)
        </div></li><li class="listitem"><div class="para">
          ovf (OVF format)
        </div></li><li class="listitem"><div class="para">
          aki/ami/ari (Amazon kernel, ramdisk, or machine image)
        </div></li></ul></div>

  </div><div class="para">
    <div class="table"><a id="idp9319064"></a><p class="title"><strong>Table&nbsp;1.8.&nbsp;Image Service components</strong></p><div class="table-contents"><table summary="Image Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                openstack-glance-api
              </div>

            </td><td class="" align="left">
              <div class="para">
                Handles requests and image delivery (interacts with storage back-ends for retrieval and storage). Uses the registry to retrieve image information (the registry service is never, and should never be, accessed directly).
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-glance-registry
              </div>

            </td><td class="" align="left">
              <div class="para">
                Manages all metadata associated with each image. Requires a database.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Database
              </div>

            </td><td class="" align="left">
              <div class="para">
                Stores image metadata.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15945-541150+%5BLatest%5D&amp;cf_build_id=15945-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Image+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Object_Storage_-_Swift"></a>1.3.7.&nbsp;Object Storage Service</h3></div></div></div><div class="para">
    The Object Storage service provides object storage in virtual containers, which allows users to store and retrieve files. The service's distributed architecture supports horizontal scaling; redundancy as failure-proofing is provided through software-based data replication.
  </div><div class="para">
    Because it supports asynchronous eventual consistency replication, it is well suited to multiple data-center deployment. Object Storage uses the concept of:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Storage replicas, which are used to maintain the state of objects in the case of outage. A minimum of three replicas is recommended.
        </div></li><li class="listitem"><div class="para">
          Storage zones, which are used to host replicas. Zones ensure that each replica of a given object can be stored separately. A zone might represent an individual disk drive or array, a server, all the servers in a rack, or even an entire data center.
        </div></li><li class="listitem"><div class="para">
          Storage regions, which are essentially a group of zones sharing a location. Regions can be, for example, groups of servers or server farms, usually located in the same geographical area. Regions have a separate API endpoint per Object Storage service installation, which allows for a discrete separation of services.
        </div></li></ul></div>

  </div><div class="para">
    <div class="table"><a id="idp9770760"></a><p class="title"><strong>Table&nbsp;1.9.&nbsp;Object Storage Service components</strong></p><div class="table-contents"><table summary="Object Storage Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                openstack-swift-proxy
              </div>

            </td><td class="" align="left">
              <div class="para">
                Exposes the public API, and is responsible for handling requests and routing them accordingly. Objects are streamed through the proxy server to the user (not spooled). Objects can also be served out via HTTP.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-swift-object
              </div>

            </td><td class="" align="left">
              <div class="para">
                Stores, retrieves, and deletes objects.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-swift-account
              </div>

            </td><td class="" align="left">
              <div class="para">
                Responsible for listings of containers, using the account database.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                openstack-swift-container
              </div>

            </td><td class="" align="left">
              <div class="para">
                Handles listings of objects (what objects are in a specific container), using the container database.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Ring files
              </div>

            </td><td class="" align="left">
              <div class="para">
                Contain details of all the storage devices, and are used to deduce where a particular piece of data is stored (maps the names of stored entities to their physical location). One file is created for each object, account, and container server.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Account database
              </div>

            </td><td class="auto-generated">&nbsp;</td></tr><tr><td class="" align="left">
              <div class="para">
                Container database
              </div>

            </td><td class="auto-generated">&nbsp;</td></tr><tr><td class="" align="left">
              <div class="para">
                ext4 (recommended) or XFS file system
              </div>

            </td><td class="" align="left">
              <div class="para">
                Used for object storage.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Housekeeping processes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Replication and auditors.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15938-541150+%5BLatest%5D&amp;cf_build_id=15938-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Object+Storage+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Metering_-_Ceilometer_Technical_Preview"></a>1.3.8.&nbsp;Metering Service</h3></div></div></div><div class="para">
    The Metering service provides user-level usage data for OpenStack-based clouds, which can be used for customer billing, system monitoring, or alerts. Data can be collected by notifications sent by existing OpenStack components (for example, usage events emitted from Compute) or by polling the infrastructure (for example, libvirt).
  </div><div class="para">
    Metering includes a storage daemon that communicates with authenticated agents via a trusted messaging system, to collect and aggregate data. Additionally, the service uses a plugin system, which makes it easy to add new monitors.
  </div><div class="para">
    <div class="table"><a id="idm259360"></a><p class="title"><strong>Table&nbsp;1.10.&nbsp;Metering Service components</strong></p><div class="table-contents"><table summary="Metering Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                ceilometer-agent-compute
              </div>

            </td><td class="" align="left">
              <div class="para">
                An agent that runs on each Compute node to poll for resource utilization statistics.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                ceilometer-agent-central
              </div>

            </td><td class="" align="left">
              <div class="para">
                An agent that runs on a central management server to poll for utilization statistics about resources not tied to instances or Compute nodes.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                ceilometer-collector
              </div>

            </td><td class="" align="left">
              <div class="para">
                An agent that runs on one or more central management servers to monitor the message queues. Notification messages are processed and turned into metering messages, and sent back out on to the message bus using the appropriate topic. Metering messages are written to the data store without modification.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Mongo database
              </div>

            </td><td class="" align="left">
              <div class="para">
                For collected usage sample data.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                API Server
              </div>

            </td><td class="" align="left">
              <div class="para">
                Runs on one or more central management servers to provide access to the data store's data. Only the Collector and the API server have access to the data store.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15821-547974+%5BLatest%5D&amp;cf_build_id=15821-547974+21+Oct+2013+08%3A02+en-US+%5BLatest%5D&amp;comment=Title%3A+Metering+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Orchestration_-_Heat_Technical_Preview"></a>1.3.9.&nbsp;Orchestration Service</h3></div></div></div><div class="para">
    The Orchestration service provides a template-based orchestration engine for the OpenStack cloud, which can be used to create and manage cloud infrastructure resources such as storage, networking, instances, and applications as a repeatable running environment.
  </div><div class="para">
    Templates are used to create stacks, which are collections of resources (for example instances, floating IPs, volumes, security groups, or users). The service offers access to all OpenStack core services via a single modular template, with additional orchestration capabilities such as auto-scaling and basic high availability.
  </div><div class="para">
    Features include:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          A single template provides access to all underlying service APIs.
        </div></li><li class="listitem"><div class="para">
          Templates are modular (resource oriented).
        </div></li><li class="listitem"><div class="para">
          Templates can be recursively defined, and therefore reusable (nested stacks). This means that the cloud infrastructure can be defined and reused in a modular way.
        </div></li><li class="listitem"><div class="para">
          Resource implementation is pluggable, which allows for custom resources.
        </div></li><li class="listitem"><div class="para">
          Autoscaling functionality (automatically adding or removing resources depending upon usage).
        </div></li><li class="listitem"><div class="para">
          Basic high availability functionality.
        </div></li></ul></div>

  </div><div class="para">
    <div class="table"><a id="idp7758240"></a><p class="title"><strong>Table&nbsp;1.11.&nbsp;Orchestration Service components</strong></p><div class="table-contents"><table summary="Orchestration Service components"><colgroup><col width="40%" align="left" class="c1" /><col width="60%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                heat
              </div>

            </td><td class="" align="left">
              <div class="para">
                A CLI tool that communicates with the heat-api to execute AWS CloudFormation APIs.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                heat-api
              </div>

            </td><td class="" align="left">
              <div class="para">
                An OpenStack-native REST API that processes API requests by sending them to the heat-engine over RPC.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                heat-api-cfn
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides an AWS-Query API that is compatible with AWS CloudFormation and processes API requests by sending them to the heat-engine over RPC.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                heat-engine
              </div>

            </td><td class="" align="left">
              <div class="para">
                Orchestrates the launching of templates and provide events back to the API consumer.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                heat-api-cloudwatch
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provides monitoring (metrics collection) for the Orchestration service.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                heat-cfntools
              </div>

            </td><td class="" align="left">
              <div class="para">
                A package of helper scripts (for example, cfn-hup, which handles updates to metadata and executes custom hooks).
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      The <code class="systemitem">heat-cfntools</code> package is only installed on images that are launched by heat into Compute servers.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15869-547975+%5BLatest%5D&amp;cf_build_id=15869-547975+21+Oct+2013+08%3A02+en-US+%5BLatest%5D&amp;comment=Title%3A+Orchestration+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Additional_Documentation1"></a>1.4.&nbsp;Additional Documentation</h2></div></div></div><div class="para">
    You can find additional documentation for the Red Hat Enterprise Linux OpenStack Platform in the customer portal:
  </div><div class="para">
    <a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform">https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform</a>
  </div><div class="para">
    The following documents are included in the documentation suite:
    <div class="table"><a id="idm1150552"></a><p class="title"><strong>Table&nbsp;1.12.&nbsp;TableTitle</strong></p><div class="table-contents"><table summary="TableTitle"><colgroup><col width="20%" align="left" class="c1" /><col width="80%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Guide
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                <em class="citetitle">Administration User Guide</em>
              </div>

            </td><td class="" align="left">
              <div class="para">
                HowTo procedures for administrating Red Hat Enterprise Linux OpenStack Platform environments.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <em class="citetitle">Configuration Reference Guide</em>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Configuration options and sample configuration files for each OpenStack component.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <em class="citetitle">End User Guide</em>
              </div>

            </td><td class="" align="left">
              <div class="para">
                HowTo procedures for using Red Hat Enterprise Linux OpenStack Platform environments.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <em class="citetitle">Getting Started Guide</em>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Packstack deployment procedures for a Red Hat Enterprise Linux OpenStack Platform cloud, as well as brief HowTos for getting your cloud up and running.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <em class="citetitle">Installation and Configuration Guide</em> (this guide)
              </div>

            </td><td class="" align="left">
              <div class="para">
                Deployment procedures for a Red Hat Enterprise Linux OpenStack Platform cloud; procedures for both a manual and Foreman installation are included. Also included are brief procedures for validating and monitoring the installation.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <em class="citetitle">Release Notes</em>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Information about the current release, including notes about technology previews, recommended practices, and known issues.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+25104-556338+%5BLatest%5D&amp;cf_build_id=25104-556338+18+Nov+2013+13%3A37+en-US+%5BLatest%5D&amp;comment=Title%3A+Additional+Documentation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Prerequisites"></a>Chapter&nbsp;2.&nbsp;Prerequisites</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#sect-Software_Requirements">2.1. Software Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Operating_System_Requirements">2.1.1. Operating System Requirements</a></span></dt><dt><span class="section"><a href="#sect-Software_Repository_Configuration">2.1.2. Software Repository Configuration</a></span></dt><dt><span class="section"><a href="#Reserved_UIDs_and_GUIDs">2.1.3. Reserved UIDs and GIDs</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Hardware_Requirements">2.2. Hardware Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Compute_Node_Requirements">2.2.1. Compute Node Requirements</a></span></dt><dt><span class="section"><a href="#Network_Node_Requirements">2.2.2. Network Node Requirements</a></span></dt><dt><span class="section"><a href="#Storage_Node_Requirements">2.2.3. Block Storage Node Requirements</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Software_Requirements"></a>2.1.&nbsp;Software Requirements</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Operating_System_Requirements"></a>2.1.1.&nbsp;Operating System Requirements</h3></div></div></div><div class="para">
    Red Hat Enterprise Linux OpenStack Platform 4 requires Red Hat Enterprise Linux 6.5 Server.
  </div><div class="para">
    For further information on installing Red Hat Enterprise Linux 6.5 Server, refer to the Red Hat Enterprise Linux 6 <em class="citetitle">Installation Guide</em>.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Register_to_Red_Hat_Network">Section&nbsp;2.1.2.1, “Register to Red Hat Network”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Red_Hat_Enterprise_Linux_Repository_Configuration">Section&nbsp;2.1.2.2, “Red Hat Enterprise Linux Repository Configuration”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Red_Hat_OpenStack_Repository_Configuration">Section&nbsp;2.1.2.3, “Red Hat Enterprise Linux OpenStack Platform Repository Configuration”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15892-552711+%5BLatest%5D&amp;cf_build_id=15892-552711+11+Nov+2013+09%3A30+en-US+%5BLatest%5D&amp;comment=Title%3A+Operating+System+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Software_Repository_Configuration"></a>2.1.2.&nbsp;Software Repository Configuration</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Register_to_Red_Hat_Network"></a>2.1.2.1.&nbsp;Register to Red Hat Network</h4></div></div></div><div class="para">
    Red Hat Enterprise Linux OpenStack Platform requires that each system in the OpenStack environment be running Red Hat Enterprise Linux Server and that all systems be signed up to receive updates from Red Hat Network using Subscription Manager. For further information on managing Red Hat subscriptions refer to the Red Hat <em class="citetitle">Subscription Management Guide</em>.
  </div><div class="para">
    All steps in this procedure must be executed while logged in to the account of the <code class="systemitem">root</code> user on the system being registered.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      RHN Classic is intended to be used with legacy systems (Red Hat Enterprise Linux&nbsp;6.0 or Red Hat Enterprise Linux&nbsp;5.6 and earlier releases). It is strongly recommended that Red Hat Enterprise Linux&nbsp;6.1/5.7 and later systems use Customer Portal Subscription Management, Subscription Asset Manager, or similar certificate-based subscription management service. As such these instructions are <span class="bold bold"><strong>not</strong></span> intended for use on systems which have been registered to Red Hat Network using RHN Classic.
    </div></div></div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Run the <code class="command">subscription-manager register</code> command to register the system to Red Hat Network.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">subscription-manager register</code></code></strong></pre></li><li class="step"><div class="para">
        Enter your Red Hat Network user name when prompted.
      </div><pre class="screen">Username: <em class="replaceable"><code>admin@example.com</code></em></pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          Your Red Hat Network account must have Red Hat Enterprise Linux OpenStack Platform entitlements. If your Red Hat Network account does not have Red Hat Enterprise Linux OpenStack entitlements then you may register for access to the evaluation program at <a href="http://www.redhat.com/openstack/">http://www.redhat.com/openstack/</a>.
        </div></div></div></li><li class="step"><div class="para">
        Enter your Red Hat Network password when prompted.
      </div><pre class="screen">Password:</pre></li><li class="step"><div class="para">
        When registration completes successfully system is assigned a unique identifier.
      </div><pre class="screen">The system has been registered with id: <em class="replaceable"><code>IDENTIFIER</code></em></pre></li></ol></div><div class="para">
    The system has been registered to Red Hat Network and is ready to be attached to specific software subscriptions.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15955-541150+%5BLatest%5D&amp;cf_build_id=15955-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Register+to+Red+Hat+Network%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Red_Hat_Enterprise_Linux_Repository_Configuration"></a>2.1.2.2.&nbsp;Red Hat Enterprise Linux Repository Configuration</h4></div></div></div><div class="para">
    Follow the steps in this procedure to register a Red Hat Enterprise Linux system to receive updates from Red Hat Network. These steps must be run while logged in as the <code class="systemitem">root</code> user. Repeat these steps on each system in the OpenStack environment.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">subscription-manager list</code> command to locate the pool identifier of the Red Hat Enterprise Linux subscription.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">subscription-manager list <em class="parameter"><code>--available</code></em></code></code></strong>
+-------------------------------------------+
    Available Subscriptions
+-------------------------------------------+

Product Name:          Red Hat Enterprise Linux Server
Product Id:            69
Pool Id:               <em class="replaceable"><code>POOLID</code></em>
Quantity:              1
Service Level:         None
Service Type:          None
Multi-Entitlement:     No
Expires:               01/01/2022
Machine Type:          physical
...</pre><div class="para">
        The pool identifier is indicated in the <code class="literal">Pool Id</code> field associated with the <code class="literal">Red Hat Enterprise Linux Server</code> product. The identifier will be unique to your subscription. Take note of this identifier as it will be required to perform the next step.
      </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          The output displayed in this step has been truncated to conserve space. All other available subscriptions will also be listed in the output of the command.
        </div></div></div></li><li class="step"><div class="para">
        Use the <code class="command">subscription-manager attach</code> command to attach the subscription identified in the previous step.
      </div><pre class="screen"><code class="prompt">#</code> <code class="command">subscription-manager <em class="parameter"><code>attach</code></em> <em class="parameter"><code>--pool=<em class="replaceable"><code>POOLID</code></em></code></em></code>
Successfully attached a subscription for Red Hat Enterprise Linux Server.</pre><div class="para">
        Replace <em class="replaceable"><code>POOLID</code></em> with the unique identifier associated with your Red Hat Enterprise Linux Server subscription. This is the identifier that was located in the previous step.
      </div></li><li class="step"><div class="para">
        Run the <code class="command">yum repolist</code> command. This command ensures that the repository configuration file <code class="filename">/etc/yum.repos.d/redhat.repo</code> exists and is up to date.
      </div><pre class="screen"><code class="prompt">#</code> <code class="command">yum <em class="parameter"><code>repolist</code></em></code></pre><div class="para">
        Once repository metadata has been downloaded and examined, the list of repositories enabled will be displayed, along with the number of available packages.
      </div><pre class="screen">repo id                  repo name                                    status
rhel-6-server-rpms       Red Hat Enterprise Linux 6 Server (RPMs)      8,816
repolist: 8,816</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          The output displayed in this step may differ from that which appears when you run the <code class="command">yum repolist</code> command on your system. In particular the number of packages listed will vary if or when additional packages are added to the <code class="literal">rhel-6-server-rpms</code> repository.
        </div></div></div></li></ol></div><div class="para">
    You have successfully configured your system to receive Red Hat Enterprise Linux updates from Red Hat Network.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15956-541150+%5BLatest%5D&amp;cf_build_id=15956-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Red+Hat+Enterprise+Linux+Repository+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Red_Hat_OpenStack_Repository_Configuration"></a>2.1.2.3.&nbsp;Red Hat Enterprise Linux OpenStack Platform Repository Configuration</h4></div></div></div><div class="para">
    Follow the steps in this procedure to configure a Red Hat Enterprise Linux system to receive OpenStack packages and updates from Red Hat Network. Access to a Red Hat software entitlement that includes Red Hat Enterprise Linux OpenStack Platform is required, such entitlements include:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Red Hat Cloud Infrastructure
      </div></li><li class="listitem"><div class="para">
        Red Hat Cloud Infrastructure (without Guest OS)
      </div></li><li class="listitem"><div class="para">
        Red Hat Enterprise Linux OpenStack Platform
      </div></li><li class="listitem"><div class="para">
        Red Hat Enterprise Linux OpenStack Platform Preview
      </div></li><li class="listitem"><div class="para">
        Red Hat Enterprise Linux OpenStack Platform (without Guest OS)
      </div></li></ul></div><div class="para">
    These steps must be run while logged in as the <code class="systemitem">root</code> user. Repeat these steps on each system in the environment.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">subscription-manager list</code> command to locate the pool identifier of the relevant Red Hat Cloud Infrastructure or Red Hat Enterprise Linux OpenStack Platform entitlement.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">subscription-manager list <em class="parameter"><code>--available</code></em></code></code></strong>
+-------------------------------------------+
    Available Subscriptions
+-------------------------------------------+
...
Product Name:          <em class="replaceable"><code>ENTITLEMENT</code></em>
Product Id:            <em class="replaceable"><code>ID_1</code></em>
Pool Id:               <em class="replaceable"><code>POOLID_1</code></em>
Quantity:              3
Service Level:         None
Service Type:          None
Multi-Entitlement:     No
Expires:               02/14/2013
Machine Type:          physical

Product Name:          <em class="replaceable"><code>ENTITLEMENT</code></em>
Product Id:            <em class="replaceable"><code>ID_2</code></em>
Pool Id:               <em class="replaceable"><code>POOLID_2</code></em>
Quantity:              unlimited
Service Level:         None
Service Type:          None
Multi-Entitlement:     No
Expires:               02/14/2013
Machine Type:          virtual
...</pre><div class="para">
        Locate the entry in the list where the <code class="literal">Product Name</code> matches the name of the entitlement that will be used to access Red Hat Enterprise Linux OpenStack Platform packages. Take note of the pool identifier associated with the entitlement, this value is indicated in the <code class="literal">Pool Id</code> field. The pool identifier is unique to your subscription and will be required to complete the next step.
      </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          The output displayed in this step has been truncated to conserve space. All other available subscriptions will also be listed in the output of the command.
        </div></div></div></li><li class="step"><div class="para">
        Use the <code class="command">subscription-manager attach</code> command to attach the subscription identified in the previous step.
      </div><pre class="screen"><code class="prompt">#</code> <code class="command">subscription-manager <em class="parameter"><code>attach</code></em> <em class="parameter"><code>--pool=<em class="replaceable"><code>POOLID</code></em></code></em></code>
Successfully attached a subscription for <em class="replaceable"><code>ENTITLEMENT</code></em>.</pre><div class="para">
        Replace <em class="replaceable"><code>POOLID</code></em> with the unique identifier associated with your Red Hat Cloud Infrastructure or Red Hat Enterprise Linux OpenStack Platform entitlement. This is the identifier that was located in the previous step.
      </div></li><li class="step"><div class="para">
        Install the <span class="package">yum-utils</span> package. The <span class="package">yum-utils</span> package is provided by the Red Hat Enterprise Linux subscription but provides the <code class="command">yum-config-manager</code> utility required to complete configuration of the Red Hat Enterprise Linux OpenStack Platform software repositories.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y yum-utils</code></code></strong></pre><div class="para">
        Note that depending on the options selected during Red Hat Enterprise Linux installation the <span class="package">yum-utils</span> package may already be installed.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">yum-config-manager</code> command to ensure that the correct software repositories are enabled. Each successful invocation of the command will display the updated repository configuration.
      </div><ol class="a"><li class="step"><div class="para">
            Ensure that the repository for Red Hat OpenStack 1.0 (Essex) has been disabled.
          </div><pre class="screen"><code class="prompt">#</code> <code class="command">yum-config-manager <em class="parameter"><code>--disable rhel-server-ost-6-preview-rpms</code></em></code>
Loaded plugins: product-id
==== repo: rhel-server-ost-6-preview-rpms ====
[rhel-server-ost-6-preview-rpms]
bandwidth = 0
base_persistdir = /var/lib/yum/repos/x86_64/6Server
baseurl = https://cdn.redhat.com/content/beta/rhel/server/6/6Server/x86_64/openstack/essex/os
cache = 0
cachedir = /var/cache/yum/x86_64/6Server/rhel-server-ost-6-preview-rpms
cost = 1000
<span class="bold bold"><strong>enabled = False</strong></span>
...</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
              Yum treats the values <code class="literal">False</code> and <code class="literal">0</code> as equivalent. As a result the output on your system may instead contain this string:
            </div><pre class="screen"><span class="bold bold"><strong>enabled = 0</strong></span></pre></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
              If you encounter this message in the output from <code class="command">yum-config-manager</code> then the system has been registered to Red Hat Network using either RHN Classic or RHN Satellite.
            </div><pre class="screen">This system is receiving updates from RHN Classic or RHN Satellite.</pre><div class="para">
              Consult the Red Hat <em class="citetitle">Subscription Management Guide</em> for more information on managing subscriptions using RHN Classic or RHN Satellite.
            </div></div></div></li><li class="step"><div class="para">
            Ensure that the repository for Red Hat OpenStack 2.1 (Folsom) is disabled.
          </div><pre class="screen"><code class="prompt">#</code> <code class="command">yum-config-manager <em class="parameter"><code>--disable rhel-server-ost-6-folsom-rpms</code></em></code>
Loaded plugins: product-id
==== repo: rhel-server-ost-6-folsom-rpms ====
[rhel-server-ost-6-folsom-rpms]
bandwidth = 0
base_persistdir = /var/lib/yum/repos/x86_64/6Server
baseurl = https://cdn.redhat.com/content/beta/rhel/server/6/6Server/x86_64/openstack/folsom/os
cache = 0
cachedir = /var/cache/yum/x86_64/6Server/rhel-server-ost-6-folsom-rpms
cost = 1000
<span class="bold bold"><strong>enabled = False</strong></span>
...</pre></li><li class="step"><div class="para">
            Ensure that the repository for Red Hat Enterprise Linux OpenStack Platform 3 (Grizzly) has been disabled.
          </div><pre class="screen"><code class="prompt">#</code> <code class="command">yum-config-manager <em class="parameter"><code>--disable rhel-server-ost-6-3-rpms</code></em></code>
Loaded plugins: product-id
==== repo: rhel-server-ost-6-3-rpms ====
[rhel-server-ost-6-3-rpms]
bandwidth = 0
base_persistdir = /var/lib/yum/repos/x86_64/6Server
baseurl = https://cdn.redhat.com/content/dist/rhel/server/6/6Server/x86_64/openstack/3/os
cache = 0
cachedir = /var/cache/yum/x86_64/6Server/rhel-server-ost-6-3-rpms
cost = 1000
<span class="bold bold"><strong>enabled = False</strong></span>
...</pre></li><li class="step"><div class="para">
            Ensure that the repository for Red Hat Enterprise Linux OpenStack Platform 4 (Havana) has been enabled.
          </div><pre class="screen"><code class="prompt">#</code> <code class="command">yum-config-manager <em class="parameter"><code>--enable rhel-server-ost-6-4-rpms</code></em></code>
                  Loaded plugins: product-id
==== repo: rhel-server-ost-6-4-rpms ====
[rhel-server-ost-6-4-rpms]
bandwidth = 0
base_persistdir = /var/lib/yum/repos/x86_64/6Server
baseurl = https://cdn.redhat.com/content/dist/rhel/server/6/6Server/x86_64/openstack/4/os
cache = 0
cachedir = /var/cache/yum/x86_64/6Server/rhel-server-ost-6-4-rpms
cost = 1000
<span class="bold bold"><strong>enabled = True</strong></span>
...
</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
              Yum treats the values <code class="literal">True</code> and <code class="literal">1</code> as equivalent. As a result the output on your system may instead contain this string:
            </div><pre class="screen"><span class="bold bold"><strong>enabled = 1</strong></span></pre></div></div></li></ol></li><li class="step"><div class="para">
        Run the <code class="command">yum repolist</code> command. This command ensures that the repository configuration file <code class="filename">/etc/yum.repos.d/redhat.repo</code> exists and is up to date.
      </div><pre class="screen"><code class="prompt">#</code> <code class="command">yum <em class="parameter"><code>repolist</code></em></code></pre><div class="para">
        Once repository metadata has been downloaded and examined, the list of repositories enabled will be displayed, along with the number of available packages.
      </div><pre class="screen">repo id                   repo name                                  status
rhel-6-server-rpms        Red Hat Enterprise Linux 6 Server (RPMs)    8,816
rhel-server-ost-6-4-rpms  Red Hat OpenStack 4 (RPMs)                    144
repolist: 10,058</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          The output displayed in this step may differ from that which appears when you run the <code class="command">yum repolist</code> command on your system. In particular the number of packages listed will vary if or when additional packages are added to the repositories.
        </div></div></div></li><li class="step"><div class="para">
        Install the <span class="package">yum-plugin-priorities</span> package. The <span class="package">yum-plugin-priorities</span> package provides a <code class="command">yum</code> plug-in allowing configuration of per-repository priorities.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y yum-plugin-priorities</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">yum-config-manager</code> command to set the priority of the Red Hat Enterprise Linux OpenStack Platform software repository to <code class="literal">1</code>. This is the highest priority value supported by the <span class="package">yum-plugin-priorities</span> plug-in.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum-config-manager --enable rhel-server-ost-6-4-rpms \</code></code></strong>
        <strong class="userinput"><code><code class="command">--setopt=&quot;rhel-server-ost-6-4-rpms.priority=1&quot;</code></code></strong>
Loaded plugins: product-id
==== repo: rhel-server-ost-6-4-rpms ====
[rhel-server-ost-6-4-rpms]
bandwidth = 0
base_persistdir = /var/lib/yum/repos/x86_64/6Server
baseurl = https://cdn.redhat.com/content/dist/rhel/server/6/6Server/x86_64/openstack/4/os
cache = 0
cachedir = /var/cache/yum/x86_64/6Server/rhel-server-ost-6-4-rpms
cost = 1000
<span class="bold bold"><strong>enabled = True</strong></span>
...
<span class="bold bold"><strong>priority = 1</strong></span>
...</pre></li><li class="step"><div class="para">
        Run the <code class="command">yum</code> <em class="parameter"><code>update</code></em> command and reboot to ensure that the most up to date packages, including the kernel, are installed and running.
      </div><pre class="screen"><code class="prompt">#</code> <code class="command">yum</code> <em class="parameter"><code>update</code></em> <em class="parameter"><code>-y</code></em></pre><pre class="screen"><code class="prompt">#</code> <code class="command">reboot</code></pre></li></ol></div><div class="para">
    You have successfully configured your system to receive Red Hat Enterprise Linux OpenStack Platform packages. You may use the <code class="command">yum repolist</code> command to confirm the repository configuration again at any time.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      Red Hat Enterprise Linux OpenStack Platform 4.0 subscriptions include access to Red Hat Software Collections, a set of dynamic programming languages, database servers, and various related packages that are either more recent than their equivalent versions included in the base Red Hat Enterprise Linux system, or are available for this system for the first time. See <a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Software_Collections/1/html-single/1.0_Release_Notes/index.html">https://access.redhat.com/site/documentation/en-US/Red_Hat_Software_Collections/1/html-single/1.0_Release_Notes/index.html</a> for more details on Red Hat Software Collections and how to enable the required software repository.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15957-553419+%5BLatest%5D&amp;cf_build_id=15957-553419+12+Nov+2013+14%3A59+en-US+%5BLatest%5D&amp;comment=Title%3A+Red+Hat+Enterprise+Linux+OpenStack+Platform+Repository+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Reserved_UIDs_and_GUIDs"></a>2.1.3.&nbsp;Reserved UIDs and GIDs</h3></div></div></div><div class="para">
    The reserved range for UIDs and GIDs in Red Hat Enterprise Linux is currently 0-500. Because your organization may need to change one or more of these, the following tables are provided for OpenStack and third-party components that it uses. If you are assigning UIDs and GIDS, it is best to start at a number higher than 1000 (higher than 5000 might be a good strategy).
    <div class="table"><a id="idp4743744"></a><p class="title"><strong>Table&nbsp;2.1.&nbsp;OpenStack Daemons</strong></p><div class="table-contents"><table summary="OpenStack Daemons"><colgroup><col width="30%" align="left" class="c1" /><col width="20%" align="left" class="c2" /><col width="25%" align="left" class="c2" /><col width="25%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Code
            </th><th class="" align="left">
              Reserved UID
            </th><th class="" align="left">
              Reserved GID
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Identity
              </div>

            </td><td class="" align="left">
              <div class="para">
                keystone
              </div>

            </td><td class="" align="left">
              <div class="para">
                163
              </div>

            </td><td class="" align="left">
              <div class="para">
                163
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                OpenStack Networking
              </div>

            </td><td class="" align="left">
              <div class="para">
                neutron
              </div>

            </td><td class="" align="left">
              <div class="para">
                164
              </div>

            </td><td class="" align="left">
              <div class="para">
                164
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Block Storage
              </div>

            </td><td class="" align="left">
              <div class="para">
                cinder
              </div>

            </td><td class="" align="left">
              <div class="para">
                165
              </div>

            </td><td class="" align="left">
              <div class="para">
                165
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Compute
              </div>

            </td><td class="" align="left">
              <div class="para">
                nova
              </div>

            </td><td class="" align="left">
              <div class="para">
                162
              </div>

            </td><td class="" align="left">
              <div class="para">
                162
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Image
              </div>

            </td><td class="" align="left">
              <div class="para">
                glance
              </div>

            </td><td class="" align="left">
              <div class="para">
                161
              </div>

            </td><td class="" align="left">
              <div class="para">
                161
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Object Storage
              </div>

            </td><td class="" align="left">
              <div class="para">
                swift
              </div>

            </td><td class="" align="left">
              <div class="para">
                160
              </div>

            </td><td class="" align="left">
              <div class="para">
                160
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Metering
              </div>

            </td><td class="" align="left">
              <div class="para">
                ceilometer
              </div>

            </td><td class="" align="left">
              <div class="para">
                166
              </div>

            </td><td class="" align="left">
              <div class="para">
                166
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Orchestration
              </div>

            </td><td class="" align="left">
              <div class="para">
                heat
              </div>

            </td><td class="" align="left">
              <div class="para">
                187
              </div>

            </td><td class="" align="left">
              <div class="para">
                187
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />
     <div class="table"><a id="idp335896"></a><p class="title"><strong>Table&nbsp;2.2.&nbsp;Third-party Components</strong></p><div class="table-contents"><table summary="Third-party Components"><colgroup><col width="40%" align="left" class="c1" /><col width="30%" align="left" class="c2" /><col width="30%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Component
            </th><th class="" align="left">
              Reserved UID
            </th><th class="" align="left">
              Reserved GID
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                MongoDB
              </div>

            </td><td class="" align="left">
              <div class="para">
                184
              </div>

            </td><td class="" align="left">
              <div class="para">
                184
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Memcached
              </div>

            </td><td class="" align="left">
              <div class="para">
                497
              </div>

            </td><td class="" align="left">
              <div class="para">
                497
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                MySQL
              </div>

            </td><td class="" align="left">
              <div class="para">
                27
              </div>

            </td><td class="" align="left">
              <div class="para">
                27
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Nagios
              </div>

            </td><td class="" align="left">
              <div class="para">
                496
              </div>

            </td><td class="" align="left">
              <div class="para">
                495
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Qpidd
              </div>

            </td><td class="" align="left">
              <div class="para">
                498
              </div>

            </td><td class="" align="left">
              <div class="para">
                499
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+24391-556272+%5BLatest%5D&amp;cf_build_id=24391-556272+18+Nov+2013+09%3A48+en-US+%5BLatest%5D&amp;comment=Title%3A+Reserved+UIDs+and+GIDs%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Hardware_Requirements"></a>2.2.&nbsp;Hardware Requirements</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Compute_Node_Requirements"></a>2.2.1.&nbsp;Compute Node Requirements</h3></div></div></div><div class="para">
    Compute nodes are responsible for running virtual machine instances once they have been launched. Compute nodes must have hardware virtualization support. In addition they must have enough available RAM and disk space to support the requirements of the virtual machine instances that they will host.
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Processor</span></dt><dd><div class="para">
          64-bit x86 processor with support for the Intel 64 or AMD64 CPU extensions, and the AMD-V or Intel VT hardware virtualization extensions enabled.
        </div></dd><dt><span class="term">Memory</span></dt><dd><div class="para">
          A minimum of 2 GB of RAM is recommended.
        </div><div class="para">
          Add additional RAM to this requirement based on the amount of memory that you intend to make available to virtual machine instances.
        </div></dd><dt><span class="term">Disk Space</span></dt><dd><div class="para">
          A minimum of 50 GB of available disk space is recommended.
        </div><div class="para">
          Add additional disk space to this requirement based on the amount of space that you intend to make available to virtual machine instances. This figure varies based on both the size of each disk image you intend to create and whether you intend to share one or more disk images between multiple instances.
        </div><div class="para">
          1 TB of disk space is recommended for a realistic environment capable of hosting multiple instances of varying sizes.
        </div></dd><dt><span class="term">Network Interface Cards</span></dt><dd><div class="para">
          2 x 1 Gbps Network Interface Cards.
        </div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15866-541150+%5BLatest%5D&amp;cf_build_id=15866-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Compute+Node+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Network_Node_Requirements"></a>2.2.2.&nbsp;Network Node Requirements</h3></div></div></div><div class="para">
    Network nodes as are responsible for hosting the services that provided networking functionality to compute instances. In particular they host the DHCP agent, layer 3 agent, and metadata proxy services. Like all systems that handle networking in an OpenStack environment they also host an instance of the layer 2 agent.
  </div><div class="para">
    The hardware requirements of network nodes vary widely depending on the networking workload of the environment. The requirements listed here are intended as a guide to the minimum requirements of a network node.
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Processor</span></dt><dd><div class="para">
          No specific CPU requirements are imposed by the networking services.
        </div></dd><dt><span class="term">Memory</span></dt><dd><div class="para">
          A minimum of 2 GB of RAM is recommended.
        </div></dd><dt><span class="term">Disk Space</span></dt><dd><div class="para">
          A minimum of 10 GB of available disk space is recommended.
        </div><div class="para">
          No additional disk space is required by the networking services other than that required to install the packages themselves. Some disk space however must be available for log and temporary files.
        </div></dd><dt><span class="term">Network Interface Cards</span></dt><dd><div class="para">
          2 x 1 Gbps Network Interface Cards.
        </div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15870-541150+%5BLatest%5D&amp;cf_build_id=15870-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Network+Node+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Storage_Node_Requirements"></a>2.2.3.&nbsp;Block Storage Node Requirements</h3></div></div></div><div class="para">
    Block storage nodes are those nodes that will host the volume service (<code class="systemitem">openstack-cinder-volume</code>) and provide volumes for use by virtual machine instances or other cloud users. The block storage API (<code class="systemitem">openstack-cinder-api</code>) and scheduling services (<code class="systemitem">openstack-cinder-scheduler</code>) may run on the same nodes as the volume service or separately. In either case the primary hardware requirement of the block storage nodes is that there is enough block storage available to serve the needs of the OpenStack environment.
  </div><div class="para">
    The amount of block storage required in an OpenStack environment varies based on:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        The number of volumes that will be created in the environment.
      </div></li><li class="listitem"><div class="para">
        The average size of the volumes that will be created in the environment.
      </div></li><li class="listitem"><div class="para">
        Whether or not the storage backend will be configured to support redundancy.
      </div></li><li class="listitem"><div class="para">
        Whether or not the storage backend will be configured to create sparse volumes by default.
      </div></li></ul></div><div class="para">
    Use this formula to assist with estimating the initial block storage needs of an OpenStack environment.
  </div><pre class="screen"><em class="replaceable"><code>VOLUMES</code></em> * <em class="replaceable"><code>SIZE</code></em> * <em class="replaceable"><code>REDUNDANCY</code></em> * <em class="replaceable"><code>UTILIZATION</code></em> = <em class="replaceable"><code>TOTAL</code></em></pre><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Replace <em class="replaceable"><code>VOLUMES</code></em> with the number of volumes that it is expected will exist in the environment at any one time.
      </div></li><li class="listitem"><div class="para">
        Replace <em class="replaceable"><code>SIZE</code></em> with the expected average size of the volumes that will exist in the environment at any one time.
      </div></li><li class="listitem"><div class="para">
        Replace <em class="replaceable"><code>REDUNDANCY</code></em> with the expected number of redundant copies of each volume the backend storage will be configured to keep. Use <code class="literal">1</code> or skip this multiplication operation if no redundancy will be used.
      </div></li><li class="listitem"><div class="para">
        Replace <em class="replaceable"><code>UTILIZATION</code></em> with the expected percentage of each volume that will actually be used. Use <code class="literal">1</code>, indicating 100%, if the use of sparse volumes will not be enabled.
      </div></li></ul></div><div class="para">
    The resultant figure represents an <span class="bold bold"><strong>estimate</strong></span> of the block storage needs of your OpenStack environment in gigabytes. It is recommended that some additional space is allowed for future growth. Addition of further block storage once the environment has been deployed is facilitated by adding more block storage providers and, if necessary, additional instances of the volume service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15878-541150+%5BLatest%5D&amp;cf_build_id=15878-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Block+Storage+Node+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div></div><div class="part"><div class="titlepage"><div><div><h1 class="title"><a id="part-Deploying_OpenStack_with_Foreman"></a>Part&nbsp;II.&nbsp;Deploying OpenStack with Foreman</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#chap-Foreman_Overview_and_Installation">3. Foreman Overview and Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#Overview13">3.1. Introduction to Foreman OpenStack Manager</a></span></dt><dt><span class="section"><a href="#Installing_Packages">3.2. Installing Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Installer">3.3. Configuring the Installer</a></span></dt><dt><span class="section"><a href="#Running_the_Installer">3.4. Running the Installer</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Configuring_Foreman">4. Configuring Foreman</a></span></dt><dd><dl><dt><span class="section"><a href="#Changing_the_Password">4.1. Changing the Password</a></span></dt><dt><span class="section"><a href="#Configuring_Provisioning">4.2. Configuring Installation Media</a></span></dt><dt><span class="section"><a href="#sect-Editing_Host_Groups">4.3. Editing Host Groups</a></span></dt><dd><dl><dt><span class="section"><a href="#Controller_Node">4.3.1. Controller Node</a></span></dt><dt><span class="section"><a href="#Compute_Node">4.3.2. Compute Node</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Adding_Hosts">5. Adding Hosts</a></span></dt><dd><dl><dt><span class="section"><a href="#Registering_Hosts">5.1. Registering Existing Hosts</a></span></dt><dt><span class="section"><a href="#Provisioning_New_Hosts">5.2. Provisioning New Hosts</a></span></dt><dt><span class="section"><a href="#Provisioning_Hosts">5.3. Assigning Hosts</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Logging_In">6. Logging In</a></span></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Foreman_Overview_and_Installation"></a>Chapter&nbsp;3.&nbsp;Foreman Overview and Installation</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Overview13">3.1. Introduction to Foreman OpenStack Manager</a></span></dt><dt><span class="section"><a href="#Installing_Packages">3.2. Installing Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Installer">3.3. Configuring the Installer</a></span></dt><dt><span class="section"><a href="#Running_the_Installer">3.4. Running the Installer</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Overview13"></a>3.1.&nbsp;Introduction to Foreman OpenStack Manager</h2></div></div></div><div class="para">
    Foreman OpenStack Manager is a deployment management tool. It provides a web user interface for managing the installation and configuration of remote systems. Deployment of changes is performed using Puppet. Additionally, <em class="firstterm">Dynamic Host Configuration Protocol</em> (DHCP), <em class="firstterm">Domain Name System</em> (DNS), <em class="firstterm">Preboot Execution Environment</em> (PXE), and <em class="firstterm">Trivial File Transfer Protocol</em> (TFTP) services can be provided. Controlling these services also enables provisioning of physical systems that do not yet have an operating system installed.
  </div><div class="para">
    Foreman OpenStack Manager uses what is referred to as <em class="firstterm">host group</em> definitions, to group hosts that share common configuration requirements together. Two of these host groups are provided in Red Hat Enterprise Linux OpenStack Platform:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">OpenStack Controller</span></dt><dd><div class="para">
          This host group is intended for use on a single host that will act as a controller for the OpenStack deployment. Services that will be deployed to hosts added to this host group include:
        </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
              OpenStack Dashboard (Horizon).
            </div></li><li class="listitem"><div class="para">
              OpenStack Image Storage service (Glance).
            </div></li><li class="listitem"><div class="para">
              OpenStack Identity service (Keystone).
            </div></li><li class="listitem"><div class="para">
              MySQL database server.
            </div></li><li class="listitem"><div class="para">
              Qpid message broker.
            </div></li></ul></div><div class="para">
          The OpenStack API and scheduling services, including those of the Compute service (Nova), also run on the controller.
        </div></dd><dt><span class="term">OpenStack Nova Compute</span></dt><dd><div class="para">
          This host group is intended for use on one or more hosts that will act as compute nodes for the OpenStack deployment. These are the systems that virtual machine instances will run on, while accessing the authentication, storage, and messaging infrastructure provided by the controller node. An instance of the Compute service (Nova) runs on each compute node.
        </div></dd></dl></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      At this time compute servics deployed using Foreman OpenStack Manager are configured to use Nova Networking (<code class="systemitem">openstack-nova-network</code>) instead of OpenStack Networking to provide network services. Additionally the OpenStack Block Storage service (Cinder) is not currently included in the provided host group definitions.
    </div></div></div><div class="para">
    This guide documents the steps involved in installing, configuring and adding hosts to Foreman OpenStack Manager.
  </div><div class="para">
    Completion of the steps detailed in this guide will result in the deployment of a Foreman OpenStack Manager server, an OpenStack controller node, and one or more OpenStack compute nodes.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      The steps outlined here assume you already meet the hardware, software, and repository configuration requirements detailed in the Prerequisites chapter.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19223-551388+%5BLatest%5D&amp;cf_build_id=19223-551388+07+Nov+2013+11%3A41+en-US+%5BLatest%5D&amp;comment=Title%3A+Introduction+to+Foreman+OpenStack+Manager%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_Packages"></a>3.2.&nbsp;Installing Packages</h2></div></div></div><div class="para">
    The Foreman installer is included in the <span class="package">openstack-foreman-installer</span> package. Additionally it is recommended that the <span class="package">foreman-selinux</span> package is also installed, allowing SELinux to be run in enforcing mode on the Foreman server.
  </div><div class="procedure"><a id="idp4802304"></a><p class="title"><strong>Procedure&nbsp;3.1.&nbsp;Installing Packages</strong></p><ol class="1"><li class="step"><div class="para">
        Log in to the system that will host the Foreman installation as the <code class="systemitem">root</code> user.
      </div></li><li class="step"><div class="para">
        Install the <span class="package">openstack-foreman-installer</span> and <span class="package">foreman-selinux</span> packages.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>yum install -y openstack-foreman-installer foreman-selinux</code></strong></pre></li></ol></div><div class="para">
    The Foreman installer is now locally installed and ready to be configured and run.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19221-549385+%5BLatest%5D&amp;cf_build_id=19221-549385+29+Oct+2013+14%3A14+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_the_Installer"></a>3.3.&nbsp;Configuring the Installer</h2></div></div></div><div class="para">
    The Foreman installer sets several environment variables which influence the installation process. These environment variables must be set with values specific to the target environment before running the installer.
  </div><div class="procedure"><a id="idm2461800"></a><p class="title"><strong>Procedure&nbsp;3.2.&nbsp;Configuring the Installer</strong></p><ol class="1"><li class="step"><div class="para">
        Log in to the system that will host the Foreman installation as the <code class="systemitem">root</code> user.
      </div></li><li class="step"><div class="para">
        Open the <code class="filename">/usr/share/foreman-installer/bin/foreman_server.sh</code> file in a text editor.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>vi /usr/share/foreman-installer/bin/foreman_server.sh</code></strong></pre></li><li class="step"><div class="para">
        Locate the OpenStack configuration keys within the file. The first configuration key listed is <code class="literal">PRIVATE_CONTROLLER_IP</code>.
      </div><div class="example"><a id="idm3955256"></a><p class="title"><strong>Example&nbsp;3.1.&nbsp;OpenStack Configuration</strong></p><div class="example-contents"><pre class="programlisting"><span class="perl_Comment">#PRIVATE_CONTROLLER_IP=10.0.0.10</span><span class="perl_Comment"></span>
<span class="perl_Comment"></span><span class="perl_Comment">#PRIVATE_INTERFACE=eth1</span><span class="perl_Comment"></span>
<span class="perl_Comment"></span><span class="perl_Comment">#PRIVATE_NETMASK=10.0.0.0/23</span><span class="perl_Comment"></span>
<span class="perl_Comment"></span><span class="perl_Comment">#PUBLIC_CONTROLLER_IP=10.9.9.10</span><span class="perl_Comment"></span>
<span class="perl_Comment"></span><span class="perl_Comment">#PUBLIC_INTERFACE=eth2</span><span class="perl_Comment"></span>
<span class="perl_Comment"></span><span class="perl_Comment">#PUBLIC_NETMASK=10.9.9.0/24</span><span class="perl_Comment"></span>
<span class="perl_Comment"></span><span class="perl_Comment">#FOREMAN_GATEWAY=10.0.0.1 (or false for no gateway)</span></pre></div></div><br class="example-break" /></li><li class="step"><div class="para">
        Remove the comment character (<span class="keycap"><strong>#</strong></span>) from the start of each line, then edit the value of each configuration key. These configuration keys will determine the network topology of the OpenStack environment, once deployed:
      </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">PRIVATE_CONTROLLER_IP</code></span></dt><dd><div class="para">
              The IP address to assign to the Compute controller node on the private OpenStack network.
            </div><div class="example"><a id="idm5877344"></a><p class="title"><strong>Example&nbsp;3.2.&nbsp;Value for <code class="literal">PRIVATE_CONTROLLER_IP</code></strong></p><div class="example-contents"><div class="para">
                <em class="replaceable"><code>10.0.0.10</code></em>
              </div></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">PRIVATE_INTERFACE</code></span></dt><dd><div class="para">
              The network interface on the controller node to connect to the private OpenStack network.
            </div><div class="example"><a id="idp3562304"></a><p class="title"><strong>Example&nbsp;3.3.&nbsp;Values for <code class="literal">PRIVATE_INTERFACE</code></strong></p><div class="example-contents"><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    <em class="replaceable"><code>eth1</code></em>
                  </div></li><li class="listitem"><div class="para">
                    <em class="replaceable"><code>em1</code></em>
                  </div></li><li class="listitem"><div class="para">
                    <em class="replaceable"><code>p1p3</code></em>
                  </div></li></ul></div></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">PRIVATE_NETMASK</code></span></dt><dd><div class="para">
              The IP range to associate with the OpenStack private network is defined using Classless Inter-Domain Routing (CIDR) notation.
            </div><div class="example"><a id="idp5765080"></a><p class="title"><strong>Example&nbsp;3.4.&nbsp;Value for <code class="literal">PRIVATE_NETMASK</code></strong></p><div class="example-contents"><div class="para">
                <em class="replaceable"><code>10.0.0.0/23</code></em>
              </div></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">PUBLIC_CONTROLLER_IP</code></span></dt><dd><div class="para">
              The IP address to assign to the Compute controller node on the public OpenStack network.
            </div><div class="example"><a id="idm4640160"></a><p class="title"><strong>Example&nbsp;3.5.&nbsp;Value for <code class="literal">PUBLIC_CONTROLLER_IP</code></strong></p><div class="example-contents"><div class="para">
                <em class="replaceable"><code>10.9.9.10</code></em>
              </div></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">PUBLIC_INTERFACE</code></span></dt><dd><div class="para">
              The network interface on the Compute controller node to connect to the public OpenStack network.
            </div><div class="example"><a id="idm4238384"></a><p class="title"><strong>Example&nbsp;3.6.&nbsp;Values for <code class="literal">PUBLIC_INTERFACE</code></strong></p><div class="example-contents"><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    <em class="replaceable"><code>eth2</code></em>
                  </div></li><li class="listitem"><div class="para">
                    <em class="replaceable"><code>em2</code></em>
                  </div></li><li class="listitem"><div class="para">
                    <em class="replaceable"><code>p1p4</code></em>
                  </div></li></ul></div></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">PUBLIC_NETMASK</code></span></dt><dd><div class="para">
              The IP range to associate with the OpenStack public network is defined using Classless Inter-Domain Routing (CIDR) notation.
            </div><div class="example"><a id="idp6898136"></a><p class="title"><strong>Example&nbsp;3.7.&nbsp;Value for <code class="literal">PUBLIC_NETMASK</code></strong></p><div class="example-contents"><div class="para">
                <em class="replaceable"><code>10.9.9.0/24</code></em>
              </div></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">FOREMAN_GATEWAY</code></span></dt><dd><div class="para">
              The IP address of the default gateway on the Foreman network. The nodes will use this gateway to access installation media during the provisioning process.
            </div><div class="example"><a id="idm4872760"></a><p class="title"><strong>Example&nbsp;3.8.&nbsp;Value for <code class="literal">FOREMAN_GATEWAY</code></strong></p><div class="example-contents"><div class="para">
                <em class="replaceable"><code>10.0.0.1</code></em>
              </div></div></div><br class="example-break" /><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
                If bare metal provisoning is not required then set the value of the <code class="literal">FOREMAN_GATEWAY</code> configuration key to <code class="literal">false</code>. The <code class="literal">FOREMAN_PROVISIONING</code> configuration key found elsewhere in the file must also be set to <code class="literal">false</code>.
              </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    Before:
                  </div><pre class="programlisting"><span class="perl_Keyword">if</span><span class="perl_Reserved"> [</span> <span class="perl_String">&quot;x</span><span class="perl_Others">$FOREMAN_PROVISIONING</span><span class="perl_String">&quot;</span> = <span class="perl_String">&quot;x&quot;</span><span class="perl_Reserved"> ]</span>; <span class="perl_Keyword">then</span>
  <span class="perl_Others">FOREMAN_PROVISIONING=</span>true
<span class="perl_Keyword">fi</span>
</pre></li><li class="listitem"><div class="para">
                    After:
                  </div><pre class="programlisting"><span class="perl_Keyword">if</span><span class="perl_Reserved"> [</span> <span class="perl_String">&quot;x</span><span class="perl_Others">$FOREMAN_PROVISIONING</span><span class="perl_String">&quot;</span> = <span class="perl_String">&quot;x&quot;</span><span class="perl_Reserved"> ]</span>; <span class="perl_Keyword">then</span>
  <span class="perl_Others">FOREMAN_PROVISIONING=</span>false
<span class="perl_Keyword">fi</span>
</pre></li></ul></div></div></div></dd></dl></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          It is possible to use identical network definitions for the OpenStack public and private network for testing purposes. Such a configuration is not recommended for production environments.
        </div></div></div></li><li class="step"><div class="para">
        Save the file and exit the text editor.
      </div></li></ol></div><div class="para">
    The Foreman installer is now configured and ready for use.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19224-549379+%5BLatest%5D&amp;cf_build_id=19224-549379+29+Oct+2013+14%3A05+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Installer%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Running_the_Installer"></a>3.4.&nbsp;Running the Installer</h2></div></div></div><div class="para">
    The installer is a script provided by the <span class="package">ruby193-openstack-foreman-installer</span> package for deploying Foreman OpenStack Manager. It uses Puppet manifests to deploy Foreman OpenStack Manager on the local system.
  </div><div class="procedure"><a id="idm10339832"></a><p class="title"><strong>Procedure&nbsp;3.3.&nbsp;Running the Installer</strong></p><ol class="1"><li class="step"><div class="para">
        Log in to the system that will host the Foreman installation as the <code class="systemitem">root</code> user.
      </div></li><li class="step"><div class="para">
        Change to the <code class="filename">/usr/share/openstack-foreman-installer/bin/</code> directory. The installer <span class="emphasis"><em>must</em></span> be run from this directory.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/share/openstack-foreman-installer/bin/</code></strong></pre></li><li class="step"><div class="para">
        Run the <code class="filename">foreman_server.sh</code> script.
      </div><pre class="screen"><code class="prompt">#</code> sh <strong class="userinput"><code>foreman_server.sh</code></strong></pre></li><li class="step"><div class="para">
        A message is displayed indicating that the functionality being deployed is provided as a <a href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview</a>:
      </div><pre class="screen">#################### RED HAT OPENSTACK #####################
Thank you for using the Red Hat OpenStack Foreman Installer!
Please note that this tool is a Technology Preview
For more information about Red hat Technology Previews, see
<a href="https://access.redhat.com/support/offerings/techpreview/">https://access.redhat.com/support/offerings/techpreview/</a>
############################################################
Press [Enter] to continue</pre><div class="para">
        Press the <span class="keycap"><strong>Enter</strong></span> key to indicate that you understand the support ramifications of the Technology Preview designation and wish to proceed with installation.
      </div></li><li class="step"><div class="para">
        The installer deploys Foreman using Puppet manifests. This may take a significant amount of time.
      </div></li><li class="step"><div class="para">
        A message is displayed once deployment of the Puppet manifests has been completed:
      </div><pre class="screen">Foreman is installed and almost ready for setting up your OpenStack
First, you need to alter a few parameters in Foreman.
Visit:
https://<em class="replaceable"><code>FQDN</code></em>/puppetclasses/quickstack::compute/edit
https://<em class="replaceable"><code>FQDN</code></em>/puppetclasses/quickstack::controller/edit
Go to the Smart Class Parameters tab and work though each of the parameters
in the left-hand column

Then copy /tmp/foreman_client.sh to your openstack client nodes
Run that script and visit the HOSTS tab in foreman. Pick CONTROLLER
host group for your controller node and COMPUTE host group for the rest

Once puppet runs on the machines, OpenStack is ready!</pre><div class="para">
        In the actual output <em class="replaceable"><code>FQDN</code></em> will have been replaced with the fully qualified domain name of the system to which Foreman was deployed.
      </div></li></ol></div><div class="para">
    Foreman has been installed successfully.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19227-552958+%5BLatest%5D&amp;cf_build_id=19227-552958+12+Nov+2013+09%3A37+en-US+%5BLatest%5D&amp;comment=Title%3A+Running+the+Installer%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Configuring_Foreman"></a>Chapter&nbsp;4.&nbsp;Configuring Foreman</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Changing_the_Password">4.1. Changing the Password</a></span></dt><dt><span class="section"><a href="#Configuring_Provisioning">4.2. Configuring Installation Media</a></span></dt><dt><span class="section"><a href="#sect-Editing_Host_Groups">4.3. Editing Host Groups</a></span></dt><dd><dl><dt><span class="section"><a href="#Controller_Node">4.3.1. Controller Node</a></span></dt><dt><span class="section"><a href="#Compute_Node">4.3.2. Compute Node</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Changing_the_Password"></a>4.1.&nbsp;Changing the Password</h2></div></div></div><div class="para">
    By default the Foreman installer creates an administration account with the user name <code class="systemitem">admin</code> and password <code class="literal">changeme</code>. It is highly recommended that users change this password immediately following installation.
  </div><div class="procedure"><a id="idm10543272"></a><p class="title"><strong>Procedure&nbsp;4.1.&nbsp;Changing the Password</strong></p><ol class="1"><li class="step"><div class="para">
        Open a web browser either on the Foreman server itself or on a system with network access to the Foreman server.
      </div></li><li class="step"><div class="para">
        Browse to <code class="uri">https://<em class="replaceable"><code>FQDN</code></em>/</code>. Replace <em class="replaceable"><code>FQDN</code></em> with the fully qualified domain name of your Foreman server.
      </div><div class="example"><a id="idm1203664"></a><p class="title"><strong>Example&nbsp;4.1.&nbsp;Foreman URL</strong></p><div class="example-contents"><div class="para">
          <code class="uri">https://<em class="replaceable"><code>foreman.example.com/</code></em></code>
        </div></div></div><br class="example-break" /></li><li class="step"><div class="para">
        The login screen is displayed. Type <code class="systemitem">admin</code> in the <span class="guilabel"><strong>Username</strong></span> field and <code class="literal">changeme</code> in the <span class="guilabel"><strong>Password</strong></span> field. Click the <span class="guibutton"><strong>Login</strong></span> button to log in.
      </div><div class="figure"><a id="idm5249904"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3101.png" alt="Foreman login screen containing Username and Password fields as well as a Login button." /></div></div><p class="title"><strong>Figure&nbsp;4.1.&nbsp;Foreman Login Screen</strong></p></div><br class="figure-break" /></li><li class="step"><div class="para">
        The <span class="guilabel"><strong>Overview</strong></span> screen is displayed. Select the <span class="guimenu"><strong>Admin User</strong></span> → <span class="guimenuitem"><strong>My account</strong></span> option in the top right hand corner of the screen to access account settings.
      </div><div class="figure"><a id="idm2236624"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3102.png" alt="Accessing the account settings using the Admin User → My account option." /></div></div><p class="title"><strong>Figure&nbsp;4.2.&nbsp;Accessing Account Settings</strong></p></div><br class="figure-break" /></li><li class="step"><div class="para">
        The <span class="guilabel"><strong>Edit User</strong></span> screen is displayed. Enter a new password in the <span class="guilabel"><strong>Password</strong></span> field.
      </div></li><li class="step"><div class="para">
        Enter the new password again in the <span class="guilabel"><strong>Verified</strong></span> field.
      </div></li><li class="step"><div class="para">
        Click the <span class="guibutton"><strong>Submit</strong></span> button to save the change.
      </div></li></ol></div><div class="para">
    The password of the Foreman <code class="systemitem">admin</code> user has been updated.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19430-542381+%5BLatest%5D&amp;cf_build_id=19430-542381+02+Oct+2013+07%3A31+en-US+%5BLatest%5D&amp;comment=Title%3A+Changing+the+Password%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_Provisioning"></a>4.2.&nbsp;Configuring Installation Media</h2></div></div></div><div class="para">
    To support provisioning of bare-metal hosts some additional configuration is required. In particular the Foreman installation media configuration must be updated to include a path to a local copy of the Red Hat Enterprise Linux installation media. This installation media will be used when provisioning bare-metal hosts.
  </div><div class="para">
    The installation media must already exist and be accessible using HTTP on the Foreman network. For more information on preparing installation media for network installation see the Red Hat Enterprise Linux <em class="citetitle">Installation Guide</em>.
  </div><div class="procedure"><a id="idp4071552"></a><p class="title"><strong>Procedure&nbsp;4.2.&nbsp;Configuring Installation Media</strong></p><ol class="1"><li class="step"><div class="para">
        Use a web browser on a system with network access to the Foreman server to open the Foreman web user interface.
      </div></li><li class="step"><div class="para">
        Log in using the <code class="systemitem">admin</code> user and the password that was set in <a class="xref" href="#Changing_the_Password">Section&nbsp;4.1, “Changing the Password”</a>.
      </div></li><li class="step"><div class="para">
        Click <span class="guimenu"><strong>More</strong></span> → <span class="guisubmenu"><strong>Provisioning</strong></span> → <span class="guimenuitem"><strong>Installation Media</strong></span> in the top right hand corner of the page.
      </div><div class="figure"><a id="idm4636592"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3130.png" alt="The More → Provisioning → Installation Media menu item being selected." /></div></div><p class="title"><strong>Figure&nbsp;4.3.&nbsp;Provisioning Menu Items</strong></p></div><br class="figure-break" /></li><li class="step"><div class="para">
        The <span class="guilabel"><strong>Installation Media</strong></span> page is displayed. An <code class="literal">OpenStack RHEL mirror</code> entry already exists by default but the associated path is only provided as an example and must be corrected.
      </div><div class="figure"><a id="idm8802672"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3131.png" alt="The Installation Media page displaying the OpenStack RHEL mirror entry." /></div></div><p class="title"><strong>Figure&nbsp;4.4.&nbsp;<span class="guilabel">Installation Media</span> Page</strong></p></div><br class="figure-break" /></li><li class="step"><div class="para">
        Click the <code class="literal">OpenStack RHEL mirror</code> entry.
      </div></li><li class="step"><div class="para">
        The <span class="guilabel"><strong>Edit Medium</strong></span> page is displayed.
      </div></li><li class="step"><div class="para">
        Update the <span class="guilabel"><strong>Path</strong></span> field to contain the URL of a local installation mirror. These variables can be used in the URL and will be replaced automatically:
      </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">$arch</code></span></dt><dd><div class="para">
              The system architecture, for example <code class="literal">x86_64</code>.
            </div></dd><dt><span class="term"><code class="literal">$version</code></span></dt><dd><div class="para">
              The operating system version, for example <code class="literal">6.5</code>.
            </div></dd><dt><span class="term"><code class="literal">$major</code></span></dt><dd><div class="para">
              The operating system major version, for example <code class="literal">6</code>.
            </div></dd><dt><span class="term"><code class="literal">$minor</code></span></dt><dd><div class="para">
              The operating system minor version, for example <code class="literal">4</code>.
            </div></dd></dl></div><div class="example"><a id="idp9225736"></a><p class="title"><strong>Example&nbsp;4.2.&nbsp;Path</strong></p><div class="example-contents"><div class="para">
          <code class="uri"><em class="replaceable"><code>http://download.example.com/rhel/$version/Server/$arch/os/</code></em></code>
        </div></div></div><br class="example-break" /></li><li class="step"><div class="para">
        Click <span class="guilabel"><strong>Submit</strong></span> to save the updated <span class="guilabel"><strong>Path</strong></span>.
      </div></li></ol></div><div class="para">
    The Foreman <code class="literal">OpenStack RHEL mirror</code> installation media configuration has been updated.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+20070-546955+%5BLatest%5D&amp;cf_build_id=20070-546955+17+Oct+2013+11%3A13+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Installation+Media%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Editing_Host_Groups"></a>4.3.&nbsp;Editing Host Groups</h2></div></div></div><div class="para">
      Foreman allows users to override the parameters that will be used when adding new hosts to a host group. In particular the host groups contain parameters for manipulating the passwords that will be used for a variety of user and service accounts that will be created on hosts that Foreman manages.
    </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
        It is highly recommended that users edit the value of the <code class="literal">admin_password</code> configuration key in the OpenStack Controller host group. This configuration key determines the password to be used when logging into the OpenStack dashboard as the <code class="systemitem">admin</code> user.
      </div></div></div><div class="procedure"><a id="idp6084768"></a><p class="title"><strong>Procedure&nbsp;4.3.&nbsp;Editing Host Groups</strong></p><ol class="1"><li class="step"><div class="para">
          Use a web browser on a system with network access to the Foreman server to open the Foreman web user interface.
        </div></li><li class="step"><div class="para">
          Log in using the <code class="systemitem">admin</code> user and the associated password.
        </div></li><li class="step"><div class="para">
          Click <span class="guimenuitem"><strong>More</strong></span> → <span class="guisubmenu"><strong>Configuration</strong></span> → <span class="guimenuitem"><strong>Host Groups</strong></span>.
        </div><div class="figure"><a id="idm4929176"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3133.png" alt="Selecting More → Configuration → Host Groups." /></div></div><p class="title"><strong>Figure&nbsp;4.5.&nbsp;The Host Groups Menu Item</strong></p></div><br class="figure-break" /></li><li class="step"><div class="para">
          The <span class="guilabel"><strong>Host Groups</strong></span> page is displayed. The available options are:
        </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
              OpenStack Controller
            </div></li><li class="listitem"><div class="para">
              OpenStack Nova Compute
            </div></li></ul></div><div class="para">
          Click the name of the host group to edit.
        </div></li><li class="step"><div class="para">
          The <span class="guilabel"><strong>Edit</strong></span> page is displayed. Select the <span class="guilabel"><strong>Parameters</strong></span> tab.
        </div></li><li class="step"><div class="para">
          The list of parameters associated with the host group is displayed. For each parameter to be edited click the associated <span class="guibutton"><strong>override</strong></span> button. A text field will appear at the bottom of the page. Enter the new value for the parameter in the text field.
        </div><div class="figure"><a id="idp10025008"></a><div class="figure-contents"><div class="mediaobject" align="left"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3132.png" align="left" alt="Override button associated with the admin_password parameter." /></div></div><p class="title"><strong>Figure&nbsp;4.6.&nbsp;Override Button</strong></p></div><br class="figure-break" /><div class="para">
          For more information on the available host group parameters see:
        </div><div class="para">
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                <a class="xref" href="#Controller_Node">Section&nbsp;4.3.1, “Controller Node”</a>
              </div></li><li class="listitem"><div class="para">
                <a class="xref" href="#Compute_Node">Section&nbsp;4.3.2, “Compute Node”</a>
              </div></li></ul></div>

        </div></li><li class="step"><div class="para">
          Repeat the previous step for each parameter in the host group that needs to be edited.
        </div></li><li class="step"><div class="para">
          Click <span class="guibutton"><strong>Submit</strong></span> to save the updated parameter values.
        </div></li></ol></div><div class="para">
      The host group has been updated and the values of the selected parameters have been overridden.
    </div><div class="RoleCreateBugPara RoleCreateBugPara">
      <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+20082-542381+%5BLatest%5D&amp;cf_build_id=20082-542381+02+Oct+2013+07%3A31+en-US+%5BLatest%5D&amp;comment=Title%3A+Editing+Host+Groups%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
    </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Controller_Node"></a>4.3.1.&nbsp;Controller Node</h3></div></div></div><div class="table"><a id="idm2029976"></a><p class="title"><strong>Table&nbsp;4.1.&nbsp;Controller Node Parameters</strong></p><div class="table-contents"><table summary="Controller Node Parameters"><colgroup><col width="33%" /><col width="33%" /><col width="33%" /></colgroup><thead><tr><th class="">
            Parameter Name
          </th><th class="">
            Default Value
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="literal">admin_email</code>
            </div>

          </td><td class="">
            <div class="para">
              admin@<em class="replaceable"><code>DOMAIN</code></em>
            </div>

          </td><td class="">
            <div class="para">
              The email address to associate with the OpenStack <code class="systemitem">admin</code> user when it is created using the Identity service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">admin_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">admin</code> Identity user when it is created. This is the password of the user that will be used to administer the cloud.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">cinder_db_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">cinder</code> database user, for use by the Block Storage service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">cinder_user_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">cinder</code> Identity service user, for use by the Block Storage service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">glance_db_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">glance</code> database user, for use by the Image Storage service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">glance_user_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">glance</code> Identity service user, for use by the Image Storage service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">horizon_secret_key</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The unique secret key to be stored in the Dashboard configuration.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">keystone_admin_token</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The unique administrator token to be used by the Identity service. This token can be used by an administrator to access the Identity service when normal user authentication is not working or not yet configured.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">keystone_db_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">keystone</code> database user, for use by the Identity service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">mysql_root_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">root</code> database user, for use when administering the database.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">nova_db_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">nova</code> database user, for use by the Compute service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">nova_user_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password to associate with the <code class="systemitem">nova</code> Identity service user, for use by the Compute service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">pacemaker_priv_floating_ip</code>
            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">pacemaker_pub_floating_ip</code>
            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">verbose</code>
            </div>

          </td><td class="">
            <div class="para">
              <code class="literal">true</code>
            </div>

          </td><td class="">
            <div class="para">
              Boolean value indicating whether or not verbose logging information must be generated.
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19228-542381+%5BLatest%5D&amp;cf_build_id=19228-542381+02+Oct+2013+07%3A31+en-US+%5BLatest%5D&amp;comment=Title%3A+Controller+Node%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Compute_Node"></a>4.3.2.&nbsp;Compute Node</h3></div></div></div><div class="table"><a id="idm9160544"></a><p class="title"><strong>Table&nbsp;4.2.&nbsp;Compute Node Parameters</strong></p><div class="table-contents"><table summary="Compute Node Parameters"><colgroup><col width="33%" /><col width="33%" /><col width="33%" /></colgroup><thead><tr><th class="">
            Parameter Name
          </th><th class="">
            Default Value
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="literal">fixed_network_range</code>
            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">floating_network_range</code>
            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">nova_db_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password associated with the <code class="systemitem">nova</code> database user. This password must match the value used for the same field in the controller host group.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">nova_user_password</code>
            </div>

          </td><td class="">
            <div class="para">
              Random
            </div>

          </td><td class="">
            <div class="para">
              The password associated with the <code class="systemitem">nova</code> Identity service user. This password must match the value used for the same field in the controller host group.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">pacemaker_priv_floating_ip</code>
            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td><td class="">
            <div class="para">

            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">private_interface</code>
            </div>

          </td><td class="">
            <div class="para">
              <code class="systemitem">eth1</code>
            </div>

          </td><td class="">
            <div class="para">
              The interface to attach to the private OpenStack network.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">public_interface</code>
            </div>

          </td><td class="">
            <div class="para">
              <code class="systemitem">eth2</code>
            </div>

          </td><td class="">
            <div class="para">
              The interface to attach to the public OpenStack network.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="literal">verbose</code>
            </div>

          </td><td class="">
            <div class="para">
              <code class="literal">true</code>
            </div>

          </td><td class="">
            <div class="para">
              Boolean value indicating whether or not verbose logging information must be generated.
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19229-542381+%5BLatest%5D&amp;cf_build_id=19229-542381+02+Oct+2013+07%3A31+en-US+%5BLatest%5D&amp;comment=Title%3A+Compute+Node%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Adding_Hosts"></a>Chapter&nbsp;5.&nbsp;Adding Hosts</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Registering_Hosts">5.1. Registering Existing Hosts</a></span></dt><dt><span class="section"><a href="#Provisioning_New_Hosts">5.2. Provisioning New Hosts</a></span></dt><dt><span class="section"><a href="#Provisioning_Hosts">5.3. Assigning Hosts</a></span></dt></dl></div><div class="para">
    To deploy OpenStack on hosts in a Foreman managed environment it is necessary to add the hosts to Foreman. Hosts are added by either adding the Puppet agent to existing servers or using the PXE boot provided by Foreman to provision new hosts.
  </div><div class="para">
    Once the hosts have been added to Foreman they are assigned to one of the host groups defined in earlier procedures. The host group selected for each host determines which of the provided deployment templates will be applied to it. Once a host group is selected the associated templates are then applied to the host when the Puppet agent next connects to Foreman.
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        To add existing Red Hat Enterprise Linux hosts to Foreman, see <a class="xref" href="#Registering_Hosts">Section&nbsp;5.1, “Registering Existing Hosts”</a>.
      </div></li><li class="listitem"><div class="para">
        To provision bare metal hosts and add them to Foreman, see <a class="xref" href="#Provisioning_New_Hosts">Section&nbsp;5.2, “Provisioning New Hosts”</a>.
      </div></li></ul></div><div class="para">
    Once all required hosts are visible from the Foreman web user interface follow the steps outlined in <a class="xref" href="#Provisioning_Hosts">Section&nbsp;5.3, “Assigning Hosts”</a> to assign roles to the hosts and complete deployment.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+20069-542381+%5BLatest%5D&amp;cf_build_id=20069-542381+02+Oct+2013+07%3A31+en-US+%5BLatest%5D&amp;comment=Title%3A+Adding+Hosts%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Registering_Hosts"></a>5.1.&nbsp;Registering Existing Hosts</h2></div></div></div><div class="para">
    The Foreman installer generates a script for registering new hosts. By default this script is saved to the <code class="filename">/tmp/foreman_client.sh</code> file on the Foreman server. The script must be copied to each new host to facilitate registration with the Foreman server. When run on a new host the script performs these actions:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Installs the <span class="package">augeas</span> and <span class="package">ruby193-puppet</span> packages.
      </div></li><li class="listitem"><div class="para">
        Configures the Puppet agent to access the Foreman server.
      </div></li><li class="listitem"><div class="para">
        Starts the Puppet agent.
      </div></li></ul></div><div class="para">
    Once started the Puppet agent registers the host to Foreman, allowing the host to be managed from the Foreman user interface.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      For the host to be added successfully it <span class="emphasis"><em>must</em></span> already be registered to receive packages from the Red Hat Enterprise Linux and Red Hat Enterprise Linux OpenStack Platform software repositories.
    </div></div></div><div class="procedure"><a id="idm6229704"></a><p class="title"><strong>Procedure&nbsp;5.1.&nbsp;Registering Hosts</strong></p><ol class="1"><li class="step"><div class="para">
        Log in to the Foreman server.
      </div></li><li class="step"><div class="para">
        Copy the <code class="filename">/tmp/foreman_client.sh</code> file from the Foreman server to the new host:
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>scp /tmp/foreman_client.sh <em class="replaceable"><code>USER</code></em>@<em class="replaceable"><code>IP</code></em>:<em class="replaceable"><code>DIR</code></em></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>USER</code></em> with the user to use when logging in to the new host, replace <em class="replaceable"><code>IP</code></em> with the IP address or fully qualified domain name of the new host, and replace <em class="replaceable"><code>DIR</code></em> with the path to the directory in which the file must be stored on the remote machine. The directory must already exist.
      </div><div class="example"><a id="idp6482848"></a><p class="title"><strong>Example&nbsp;5.1.&nbsp;Copying the Script</strong></p><div class="example-contents"><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>scp /tmp/foreman_client.sh <em class="replaceable"><code>root</code></em>@<em class="replaceable"><code>controller.example.com</code></em>:<em class="replaceable"><code>~/</code></em></code></strong></pre></div></div><br class="example-break" /></li><li class="step"><div class="para">
        Log in to the new host as the <code class="systemitem">root</code> user.
      </div></li><li class="step"><div class="para">
        Change into the directory to which the <code class="filename">foreman_client.sh</code> script was copied:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd <em class="replaceable"><code>DIR</code></em></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>DIR</code></em> with the path to the directory used when copying the file to the host.
      </div></li><li class="step"><div class="para">
        Run the <code class="filename">foreman_client.sh</code> script:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sh foreman_client.sh</code></strong></pre></li><li class="step"><div class="para">
        When the script completes successfully the Puppet agent is started and this message is displayed:
      </div><pre class="screen">Starting puppet agent:        [  OK  ]</pre></li><li class="step"><div class="para">
        Use a web browser on a system with network access to the Foreman server to open the Foreman web user interface.
      </div></li><li class="step"><div class="para">
        Log in using the <code class="systemitem">admin</code> user and the password that was defined during the Foreman installation.
      </div></li><li class="step"><div class="para">
        Click the <span class="guilabel"><strong>Hosts</strong></span> tab.
      </div></li><li class="step"><div class="para">
        Verify that the newly registered host is listed:
      </div><div class="para">
        <div class="figure"><a id="idp45572968"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3124.png" alt="Foreman Hosts tab showing two hosts, controller.example.com and foreman.example.com." /><div class="caption"><div class="para">
              In this example the two hosts listed are:
            </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                  The Foreman server (<code class="literal">foreman.example.com</code>).
                </div></li><li class="listitem"><div class="para">
                  The host destined to be the controller node (<code class="literal">controller.example.com</code>).
                </div></li></ul></div><div class="para">
              Note that although the fully qualified domain name indicates the role that the new host will take (controller node) this is not actually determined until the host is assigned to the relevant host group.
            </div></div></div></div><p class="title"><strong>Figure&nbsp;5.1.&nbsp;Hosts Tab</strong></p></div><br class="figure-break" />

      </div></li></ol></div><div class="para">
    Repeat this process for all existing hosts that will be included in the OpenStack deployment. See <a class="xref" href="#Provisioning_Hosts">Section&nbsp;5.3, “Assigning Hosts”</a> for information on adding the newly registered hosts to a host group and deploying OpenStack to them.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19225-547049+%5BLatest%5D&amp;cf_build_id=19225-547049+17+Oct+2013+12%3A10+en-US+%5BLatest%5D&amp;comment=Title%3A+Registering+Existing+Hosts%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Provisioning_New_Hosts"></a>5.2.&nbsp;Provisioning New Hosts</h2></div></div></div><div class="para">
    Foreman provisions new physical hosts by using networking infrastructure it controls including DHCP, DNS, PXE, and TFTP services. New physical hosts are added to Foreman by providing the MAC address associated with the network interface of the system that is connected to the Foreman network and some other configuration details. The new host will be provisioned using this configuration when it next starts.
  </div><div class="para">
    To provision a new host an activation key will be required. An activation key facilitates non-interactive registration of systems to Red Hat Network or an equivalent service provided by a Red Hat Network Satellite server. To learn how to create an activation key see <a href="https://access.redhat.com/site/solutions/2474">https://access.redhat.com/site/solutions/2474</a>. The activation key must be created with access to both the Red Hat Enterprise Linux and Red Hat OpenStack software repositories.
  </div><div class="procedure"><a id="idp14454048"></a><p class="title"><strong>Procedure&nbsp;5.2.&nbsp;Provisioning New Hosts</strong></p><ol class="1"><li class="step"><div class="para">
        Use a web browser on a system with network access to the Foreman server to open the Foreman web user interface.
      </div></li><li class="step"><div class="para">
        Log in using the <code class="systemitem">admin</code> user and associated password.
      </div></li><li class="step"><div class="para">
        Click the <span class="guilabel"><strong>Hosts</strong></span> tab.
      </div></li><li class="step"><div class="para">
        Click the <span class="guibutton"><strong>New Host</strong></span> button.
      </div></li><li class="step"><div class="para">
        Enter the desired fully qualified domain name for the new host in the <span class="guilabel"><strong>Name</strong></span> field.
      </div></li><li class="step"><div class="para">
        Do not select a <span class="guilabel"><strong>Host Group</strong></span> at this time.
      </div></li><li class="step"><div class="para">
        Click the <span class="guilabel"><strong>Network</strong></span> tab. The <span class="guilabel"><strong>Network</strong></span> tab contains settings that define the networking configuration for the new host.
      </div><ol class="a"><li class="step"><div class="para">
            Enter the MAC address of the network interface on the physical machine that is connected to the Foreman network in the <span class="guilabel"><strong>MAC address</strong></span> field.
          </div><div class="example"><a id="idp14378872"></a><p class="title"><strong>Example&nbsp;5.2.&nbsp;MAC Address</strong></p><div class="example-contents"><div class="para">
              In this example the <code class="command">ip link</code> command is used to identify the MAC address of the <code class="literal">eth0</code> network interface.
            </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ip link show <em class="replaceable"><code>eth0</code></em></code></strong>
2: <em class="replaceable"><code>eth0</code></em>: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    link/ether <em class="replaceable"><code>00:1a:4a:0f:18:bb</code></em> brd ff:ff:ff:ff:ff:ff</pre><div class="para">
              The MAC address of the <code class="literal">eth0</code> network device is <em class="replaceable"><code>00:1a:4a:0f:18:bb</code></em>.
            </div></div></div><br class="example-break" /></li><li class="step"><div class="para">
            Ensure that the value in the <span class="guilabel"><strong>Domain</strong></span> field matches the domain that Foreman is expected to manage.
          </div><div class="example"><a id="idm5545912"></a><p class="title"><strong>Example&nbsp;5.3.&nbsp;Domain</strong></p><div class="example-contents"><div class="para">
              <em class="replaceable"><code>example.com</code></em>
            </div></div></div><br class="example-break" /></li><li class="step"><div class="para">
            Ensure that a subnet is selected in the <span class="guilabel"><strong>Subnet</strong></span> field. The <span class="guilabel"><strong>IP address</strong></span> field will be automatically selected based on the subnet selection.
          </div><div class="example"><a id="idm228872"></a><p class="title"><strong>Example&nbsp;5.4.&nbsp;Subnet</strong></p><div class="example-contents"><div class="para">
              <em class="replaceable"><code>OpenStack (192.0.43.0/24)</code></em>
            </div></div></div><br class="example-break" /></li></ol></li><li class="step"><div class="para">
        Click the <span class="guilabel"><strong>Operating System</strong></span> tab. The <span class="guilabel"><strong>Operating System</strong></span> tab contains options for configuring the operating system installation for the host.
      </div><ol class="a"><li class="step"><div class="para">
            Select <code class="literal">x86_64</code> in the <span class="guilabel"><strong>Architecture</strong></span> field.
          </div></li><li class="step"><div class="para">
            Select <code class="literal">RedHat 6.5</code> in the <span class="guilabel"><strong>Operating System</strong></span> field.
          </div></li><li class="step"><div class="para">
            Enter a password for the <code class="systemitem">root</code> user in the <span class="guilabel"><strong>Root password</strong></span> field.
          </div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
              It is highly recommended that a secure <code class="systemitem">root</code> password is provided. Strong passwords contain a mix of uppercase, lowercase, numeric and punctuation characters. They are six or more characters long and do not contain dictionary words. Failure to enter a secure <code class="systemitem">root</code> password in this field will result in the default <code class="systemitem">root</code> password, <code class="literal">123123</code>, being used.
            </div></div></div></li><li class="step"><div class="para">
            Click the <span class="guibutton"><strong>Resolve</strong></span> button. Two templates will appear:
          </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                <code class="literal">OpenStack PXE Template</code>
              </div></li><li class="listitem"><div class="para">
                <code class="literal">OpenStack Kickstart Template</code>
              </div></li></ul></div></li></ol></li><li class="step"><div class="para">
        Click the <span class="guilabel"><strong>Parameters</strong></span> tab. The <span class="guilabel"><strong>Parameters</strong></span> tab contains settings that will be used to register the new host to Red Hat Network or a Red Hat Network Satellite server.
      </div><ul class="stepalternatives">
        <li class="step"><div class="para">
            To configure the host to register to Red Hat Network:
          </div><ol class="a"><li class="step"><div class="para">
                Click the <span class="guibutton"><strong>Override</strong></span> button next to the <code class="literal">satellite_type</code> configuration key. Enter <code class="literal">hosted</code> in the <span class="guilabel"><strong>Value</strong></span> field.
              </div></li><li class="step"><div class="para">
                Click the <span class="guibutton"><strong>Override</strong></span> button next to the <code class="literal">satellite_host</code> configuration key. Enter <code class="literal">xmlrpc.rhn.redhat.com</code> in the associated <span class="guilabel"><strong>Value</strong></span> field.
              </div></li><li class="step"><div class="para">
                Click the <span class="guibutton"><strong>Override</strong></span> button next to the <code class="literal">activation_key</code> configuration key. Enter the Red Hat Network activation key to be used when registering the host in the associated <span class="guilabel"><strong>Value</strong></span> field.
              </div></li></ol></li>
         <li class="step"><div class="para">
            To configure the host to register to a Red Hat Network Satellite server:
          </div><ol class="a"><li class="step"><div class="para">
                Ensure the <code class="literal">satellite_type</code> is set to the default value, <code class="literal">site</code>.
              </div></li><li class="step"><div class="para">
                Click the <span class="guibutton"><strong>Override</strong></span> button next to the <code class="literal">satellite_host</code> configuration key. Enter the IP address or fully qualified domain name of the Red Hat Network Satellite server in the associated <span class="guilabel"><strong>Value</strong></span> field.
              </div></li><li class="step"><div class="para">
                Click the <span class="guibutton"><strong>Override</strong></span> button next to the <code class="literal">activation_key</code> configuration key. Enter the Red Hat Network activation key to be used when registering the host in the associated <span class="guilabel"><strong>Value</strong></span> field.
              </div></li></ol></li>

      </ul><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          If the system is intended to be provisioned using packages from a different location instead of Red Hat Network or a Red Hat Network Satellite server then the <code class="literal">OpenStack Kickstart Template</code> must be edited. Access the template editor by clicking <span class="guimenu"><strong>More</strong></span> → <span class="guisubmenu"><strong>Provisioning</strong></span> → <span class="guimenuitem"><strong>Provisioning Templates</strong></span>, selecting the <code class="literal">OpenStack Kickstart Template</code> entry, and removing this line from the template:
        </div><pre class="programlisting">&lt;%= snippets &quot;redhat_register&quot; %&gt;</pre><div class="para">
          The line must be replaced with environment specific commands suitable for registering the system and adding equivalent software repositories.
        </div></div></div></li><li class="step"><div class="para">
        Click the <span class="guibutton"><strong>Submit</strong></span> button. Foreman will prepare to add the hosts the next time they boot.
      </div></li><li class="step"><div class="para">
        Ensure network boot (PXE) is enabled on the new host. Instructions for confirming this will be in the manufacturer instructions for the specific system.
      </div></li><li class="step"><div class="para">
        Restart the host. The host will retrieve an installation image from the Foreman PXE/TFTP server and begin the installation process.
      </div></li><li class="step"><div class="para">
        The host will restart again once installation has completed. Once this occurs use the Foreman web user interface to verify that the new host appears by clicking the <span class="guilabel"><strong>Hosts</strong></span> tab.
      </div></li></ol></div><div class="para">
    Repeat this process for all new hosts that will be added to the OpenStack deployment. See <a class="xref" href="#Provisioning_Hosts">Section&nbsp;5.3, “Assigning Hosts”</a> for information on adding the newly added hosts to a host group and deploying OpenStack to them.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      Once a host has been booted successfully over the network the Foreman server updates the PXE configuration directory (<code class="literal">/var/lib/tftpboot/pxelinux.cfg/</code>) to ensure that future boots are performed using local boot devices. This ensures that the host does not re-provision itself when restarted. To re-provision a system that has already been registered to Foreman either:
    </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Use the web user interface to delete and re-add the host; or
        </div></li><li class="listitem"><div class="para">
          Use the web user interface to view the details of the host and click the <span class="guilabel"><strong>Build</strong></span> button.
        </div></li></ul></div><div class="para">
      In either case use the <span class="guibutton"><strong>Resolve Templates</strong></span> button on the resultant page to ensure the correct PXE and Kickstart templates are used. Additionally use this command on the Foreman server while logged in as the <code class="systemitem">root</code> user to allow the host to register with a new certificate:
    </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scl enable ruby193 'puppet cert clean <em class="replaceable"><code>HOST</code></em>'</code></strong></pre><div class="para">
      Replace <em class="replaceable"><code>HOST</code></em> with the fully qualified domain name of the host.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+20006-546975+%5BLatest%5D&amp;cf_build_id=20006-546975+17+Oct+2013+11%3A46+en-US+%5BLatest%5D&amp;comment=Title%3A+Provisioning+New+Hosts%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Provisioning_Hosts"></a>5.3.&nbsp;Assigning Hosts</h2></div></div></div><div class="para">
    Once client hosts have been registered with Foreman they must be assigned to host groups to allow installation and configuration of OpenStack. Which host group a host is assigned to defines what role it performs in the environment and which packages will be deployed.
  </div><div class="procedure"><a id="idm3776840"></a><p class="title"><strong>Procedure&nbsp;5.3.&nbsp;Assigning Hosts</strong></p><ol class="1"><li class="step"><div class="para">
        Use a web browser on a system with network access to the Foreman server to open the Foreman web user interface.
      </div></li><li class="step"><div class="para">
        Log in using the <code class="systemitem">admin</code> user and associated password.
      </div></li><li class="step"><div class="para">
        Click the <span class="guilabel"><strong>Hosts</strong></span> tab.
      </div></li><li class="step"><div class="para">
        Select the host from the list displayed in the table.
      </div></li><li class="step"><div class="para">
        Click the <span class="guimenu"><strong>Select Action</strong></span> → <span class="guimenuitem"><strong>Change Group</strong></span> option.
      </div><div class="figure"><a id="idm2775032"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3125.png" alt="Selecting an action to perform on a host from the Select Action menu." /><div class="caption"><div class="para">
            In this example one host (<code class="literal">controller.example.com</code>) is selected and the options available in the <span class="guimenu"><strong>Select Action</strong></span> menu are visible.
          </div></div></div></div><p class="title"><strong>Figure&nbsp;5.2.&nbsp;Selecting an Action</strong></p></div><br class="figure-break" /></li><li class="step"><div class="para">
        The <span class="guilabel"><strong>Change Group</strong></span> window is displayed.
      </div><div class="figure"><a id="idm860792"></a><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/3128.png" alt="The Change Group window with the controller node (controller.example.com) selected." /></div></div><p class="title"><strong>Figure&nbsp;5.3.&nbsp;The <span class="guilabel">Change Group</span> Window</strong></p></div><br class="figure-break" /></li><li class="step"><div class="para">
        Use the <span class="guilabel"><strong>Select host group</strong></span> field to select a host group. The available options are:
      </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
            <span class="guilabel"><strong>OpenStack Controller</strong></span>
          </div></li><li class="listitem"><div class="para">
            <span class="guilabel"><strong>OpenStack Nova Compute</strong></span>
          </div></li></ul></div><div class="para">
        If no controller node has been configured yet, select <span class="guilabel"><strong>OpenStack Controller</strong></span>, otherwise select <span class="guilabel"><strong>OpenStack Nova Compute</strong></span> to provision compute nodes.
      </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          A controller node <span class="emphasis"><em>must</em></span> be provisioned before attempting to provision a compute node. Puppet <span class="emphasis"><em>must</em></span> have completed installation and configuration of the controller node before compute nodes are deployed.
        </div></div></div></li><li class="step"><div class="para">
        Click the <span class="guibutton"><strong>Submit</strong></span> button to save the host group selection.
      </div></li></ol></div><div class="para">
    The host group configuration of the host has been updated. The Puppet agent installed on the host will connect to Foreman every 30 minutes by default. When the Puppet agent next connects, the host group change will be detected and the associated configuration changes applied.
  </div><div class="para">
    Once a controller has been provisioned using the <span class="guilabel"><strong>OpenStack Controller</strong></span> host group, repeat the process to provision each compute node, selecting the <span class="guilabel"><strong>OpenStack Nova Compute</strong></span> host group.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To force the Puppet agent to connect to Foreman immediately, log in to the host as the <code class="systemitem">root</code> user and run this command:
    </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>scl enable ruby193 &quot;puppet agent --test&quot;</code></strong></pre></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+19226-542381+%5BLatest%5D&amp;cf_build_id=19226-542381+02+Oct+2013+07%3A31+en-US+%5BLatest%5D&amp;comment=Title%3A+Assigning+Hosts%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Logging_In"></a>Chapter&nbsp;6.&nbsp;Logging In</h2></div></div></div><div class="para">
    Once at least one controller node and one compute node are successfully installed and configured, access the user interface with a web browser. Replace <em class="replaceable"><code>HOSTNAME</code></em> with the host name or IP address of the server acting as the controller node:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          HTTPS
<pre class="screen">https://<em class="replaceable"><code>HOSTNAME</code></em>/dashboard/</pre>

        </div></li><li class="listitem"><div class="para">
          HTTP
<pre class="screen">http://<em class="replaceable"><code>HOSTNAME</code></em>/dashboard/</pre>

        </div></li></ul></div>

  </div><div class="para">
    When prompted, log in using the credentials of the <code class="systemitem">admin</code> user. This is the password that was set for the <code class="literal">admin_password</code> configuration key of the controller node ( <a class="xref" href="#Controller_Node">Section&nbsp;4.3.1, “Controller Node”</a>). To begin using the OpenStack deployment refer to <em class="citetitle">Using OpenStack With the Dashboard</em> in the <em class="citetitle">Getting Started Guide</em>.
  </div><div class="figure"><a id="idm988784"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2450.png" align="middle" alt="Dashboard Login Screen" /></div></div><p class="title"><strong>Figure&nbsp;6.1.&nbsp;Dashboard Login Screen</strong></p></div><br class="figure-break" /><div class="para">

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+20157-542381+%5BLatest%5D&amp;cf_build_id=20157-542381+02+Oct+2013+07%3A31+en-US+%5BLatest%5D&amp;comment=Title%3A+Logging+In%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="part"><div class="titlepage"><div><div><h1 class="title"><a id="part-Installing_OpenStack_Manually"></a>Part&nbsp;III.&nbsp;Installing OpenStack Manually</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#chap-Installing_the_Database_Server">7. Installing the Database Server</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Packages2">7.1. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall3">7.2. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Starting_the_Database_Service">7.3. Starting the Database Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_Database">7.4. Setting the Database Administrator Password</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_Message_Broker">8. Installing the Message Broker</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Packages">8.1. Installing the Packages</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Message_Broker">8.2. Configuring the Message Broker</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Simple_Authentication_and_Security_Layer_-_SASL">8.2.1. Simple Authentication and Security Layer - SASL</a></span></dt><dt><span class="section"><a href="#sect-Configuring_TLSSSL">8.2.2. Configuring TLS/SSL</a></span></dt></dl></dd><dt><span class="section"><a href="#Firewall_Configuration">8.3. Firewall Configuration</a></span></dt><dt><span class="section"><a href="#Starting_the_Messaging_Server">8.4. Starting the Messaging Server</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Identity_Service">9. Installing the OpenStack Identity Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Identity_Service_Requirements">9.1. Identity Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Packages1">9.2. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Creating_the_Identity_Database">9.3. Creating the Identity Database</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Service">9.4. Configuring the Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Setting_the_Initial_Administration_Token">9.4.1. Setting the Administration Token</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String">9.4.2. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Public_Key_Infrastructure">9.4.3. Configuring the Public Key Infrastructure</a></span></dt><dt><span class="section"><a href="#Configuring_for_an_LDAP_Backend">9.4.4. Configuring for an LDAP Backend</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall7">9.4.5. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Identity_Service_Database">9.4.6. Populating the Identity Service Database</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Identity_Service">9.5. Starting the Identity Service</a></span></dt><dt><span class="section"><a href="#Creating_the_Permanent_Service_Endpoint">9.6. Creating the Identity Service Endpoint</a></span></dt><dt><span class="section"><a href="#Creating_Roles1">9.7. Creating an Administrator Account</a></span></dt><dt><span class="section"><a href="#Creating_User_Accounts1">9.8. Creating a Regular User Account</a></span></dt><dt><span class="section"><a href="#Creating_the_Services_Tenant">9.9. Creating the Services Tenant</a></span></dt><dt><span class="section"><a href="#Validating_the_Identity_Service_Installation">9.10. Validating the Identity Service Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Object_Storage_Service">10. Installing the OpenStack Object Storage Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Services_that_Make_Up_the_Object_Storage_Service">10.1. Services that Make Up the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Architecture_of_the_Object_Storage_Service">10.2. Architecture of the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_Service_Requirements">10.3. Object Storage Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Object_Storage_Service_Packages">10.4. Installing the Object Storage Service Packages</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Object_Storage_Service">10.5. Configuring the Object Storage Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuraing_Keystone_for_the_Object_Storage_Service">10.5.1. Configuring the Identity Service to work with the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_Object_Storage_Service_Storage_Nodes">10.5.2. Configuring the Object Storage Service Storage Nodes</a></span></dt><dt><span class="section"><a href="#Configuring_the_Object_Storage_Service_Proxy_Service">10.5.3. Configuring the Object Storage Service Proxy Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_Service_Ring_Files">10.5.4. Object Storage Service Rings</a></span></dt><dt><span class="section"><a href="#Building_Object_Storage_Ring_Files">10.5.5. Building Object Storage Service Ring Files</a></span></dt></dl></dd><dt><span class="section"><a href="#Validating_the_Object_Storage_Service_Installation">10.6. Validating the Object Storage Service Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Image_Service">11. Installing the OpenStack Image Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Image_Storage_Service_Requirements">11.1. Image Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Image_Storage_Service_Packages">11.2. Installing the Image Service Packages</a></span></dt><dt><span class="section"><a href="#Creating_the_Image_Storage_Database">11.3. Creating the Image Service Database</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Image_Service">11.4. Configuring the Image Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_the_Backing_Storage">11.4.1. Configuration Overview</a></span></dt><dt><span class="section"><a href="#Creating_the_Image_Storage_Service_Endpoint">11.4.2. Creating the Image Identity Records</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String5">11.4.3. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String2">11.4.4. Configuring the Use of the Identity Service</a></span></dt><dt><span class="section"><a href="#Using_the_Object_Storage_Service_for_Image_Storage">11.4.5. Using the Object Storage Service for Image Storage</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall">11.4.6. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Image_Storage_Database">11.4.7. Populating the Image Service Database</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Image_Storage_Services">11.5. Starting the Image API and Registry Services</a></span></dt><dt><span class="section"><a href="#sect-Validating_the_Image_Service_Installation">11.6. Validating the Image Service Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#Obtaining_a_Disk_Image_from_Red_Hat_Network">11.6.1. Obtaining a Test Disk Image</a></span></dt><dt><span class="section"><a href="#Building_a_Custom_Disk_Image">11.6.2. Building a Custom Virtual Machine Image</a></span></dt><dt><span class="section"><a href="#Uploading_a_Disk_Image1">11.6.3. Uploading a Disk Image</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Installing_OpenStack_Block_Storage">12. Installing OpenStack Block Storage</a></span></dt><dd><dl><dt><span class="section"><a href="#Block_Storage_Installation_Overview">12.1. Block Storage Installation Overview</a></span></dt><dt><span class="section"><a href="#sect-Block_Storage_Prerequisite_Configuration">12.2. Block Storage Prerequisite Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Block_Storage_Database">12.2.1. Creating the Block Storage Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Block_Storage_Service_Endpoint">12.2.2. Creating the Block Storage Identity Records</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Common_Block_Storage_Configuration">12.3. Common Block Storage Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Block_Storage_Service_Packages">12.3.1. Installing the Block Storage Service Packages</a></span></dt><dt><span class="section"><a href="#Configuring_Authentication3">12.3.2. Configuring Authentication</a></span></dt><dt><span class="section"><a href="#Setting_the_Message_Broker">12.3.3. Setting the Message Broker</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String3">12.3.4. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall6">12.3.5. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Block_Storag_Database">12.3.6. Populating the Block Storage Database</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Volume_Service_Specific_Configuration">12.4. Volume Service Specific Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Block_Storage_Service_Requirements">12.4.1. Block Storage Driver Support</a></span></dt><dt><span class="section"><a href="#Configuring_for_LVM_Storage_Default">12.4.2. Configuring for LVM Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_NFS_Storage">12.4.3. Configuring for NFS Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_Red_Hat_Storage_Backend">12.4.4. Configuring for Red Hat Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_Multiple_Storage_Backends">12.4.5. Configuring for Multiple Storage Backends</a></span></dt><dt><span class="section"><a href="#Configuring_tgtd">12.4.6. Configuring tgtd</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Block_Storage_Service">12.5. Starting the Block Storage Services</a></span></dt><dt><span class="section"><a href="#Validating_the_Block_Storage_Service_Installation">12.6. Validating the Block Storage Service Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Networking_Service">13. Installing the OpenStack Networking Service</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-OpenStack_Networking_Installation_Overview">13.1. OpenStack Networking Installation Overview</a></span></dt><dd><dl><dt><span class="section"><a href="#OpenStack_Netorking_Architecture">13.1.1. OpenStack Networking Architecture</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_API">13.1.2. OpenStack Networking API</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_API_Extensions">13.1.3. OpenStack Networking API Extensions</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_Plug-ins">13.1.4. OpenStack Networking Plug-ins</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_Agents">13.1.5. OpenStack Networking Agents</a></span></dt><dt><span class="section"><a href="#Networking_Service_Requirements">13.1.6. Recommended Networking Deployment</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Networking_Prerequisite_Configuration">13.2. Networking Prerequisite Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Database">13.2.1. Creating the OpenStack Networking Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Service_Endpoint">13.2.2. Creating the OpenStack Networking Identity Records</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Common_Networking_Configuration">13.3. Common Networking Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Upgrading_the_Kernel">13.3.1. Upgrading the Kernel</a></span></dt><dt><span class="section"><a href="#Disabling_Network_Manager">13.3.2. Disabling Network Manager</a></span></dt><dt><span class="section"><a href="#Installing_the_Packages3">13.3.3. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall4">13.3.4. Configuring the Firewall</a></span></dt></dl></dd><dt><span class="section"><a href="#Configuring_the_Networking_Service1">13.4. Configuring the Networking Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_DHCP_Agent">13.5. Configuring the DHCP Agent</a></span></dt><dt><span class="section"><a href="#Configuring_a_Provider_Network1">13.6. Configuring a Provider Network</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Plug-in_Agent">13.7. Configuring the Plug-in Agent</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_the_Open_vSwitch_Plug-in">13.7.1. Configuring the Open vSwitch Plug-in Agent</a></span></dt><dt><span class="section"><a href="#Configuring_the_Linux_Bridge_Plug-in">13.7.2. Configuring the Linux Bridge Plug-in Agent</a></span></dt></dl></dd><dt><span class="section"><a href="#Configuring_the_L3_Agent">13.8. Configuring the L3 Agent</a></span></dt><dt><span class="section"><a href="#Validating_the_OpenStack_Networking_Installation1">13.9. Validating the OpenStack Networking Installation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_OpenStack_Compute_Service">14. Installing the OpenStack Compute Service</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Compute_Service_Requirements">14.1. Compute Service Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Checking_for_Hardware_Virtualization_Support">14.1.1. Checking for Hardware Virtualization Support</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Installing_a_Compute_VNC_Proxy">14.2. Installing a Compute VNC Proxy</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Compute_VNC_Proxy_Packages">14.2.1. Installing the Compute VNC Proxy Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall2">14.2.2. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Starting_the_VNC_Proxy_Server">14.2.3. Controlling the VNC Proxy service</a></span></dt><dt><span class="section"><a href="#Accessing_Instances_with_the_Compute_VNC_Proxy">14.2.4. Accessing Instances with the Compute VNC Proxy</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Installing_a_Compute_Node">14.3. Installing a Compute Node</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Compute_Service_Database">14.3.1. Creating the Compute Service Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Compute_Service_Endpoint">14.3.2. Creating the Compute Identity Records</a></span></dt><dt><span class="section"><a href="#Installing_the_Compute_Service_Packages">14.3.3. Installing the Compute Service</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Compute_Service">14.3.4. Configuring the Compute Service</a></span></dt><dt><span class="section"><a href="#Populating_the_Compute_Service_Database">14.3.5. Populating the Compute Service Database</a></span></dt><dt><span class="section"><a href="#Starting_the_Compute_Services">14.3.6. Starting the Compute Services</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Installing_the_Dashboard">15. Installing the Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#Dashboard_Service_Requirements">15.1. Dashboard Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Dashboard_Packages">15.2. Installing the Dashboard Packages</a></span></dt><dt><span class="section"><a href="#Starting_the_Dashboard_Service">15.3. Starting the Apache Web Service</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Dashboard">15.4. Configuring the Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_Connections_and_Logging">15.4.1. Configuring Connections and Logging</a></span></dt><dt><span class="section"><a href="#Configuring_Secured_Deployment_HTTPS">15.4.2. Configuring Secured Deployment (HTTPS)</a></span></dt><dt><span class="section"><a href="#Creating_a_Member_Role">15.4.3. Creating a Member Role</a></span></dt><dt><span class="section"><a href="#Configuring_SELinux">15.4.4. Configuring SELinux</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall5">15.4.5. Configuring the Dashboard Firewall</a></span></dt><dt><span class="section"><a href="#sect-Session_Storage_Options">15.4.6. Session Storage Options</a></span></dt></dl></dd><dt><span class="section"><a href="#Validating_the_Dashboard_Installation">15.5. Validating the Dashboard Installation</a></span></dt></dl></dd></dl></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_Database_Server"></a>Chapter&nbsp;7.&nbsp;Installing the Database Server</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Installing_the_Packages2">7.1. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall3">7.2. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Starting_the_Database_Service">7.3. Starting the Database Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_Database">7.4. Setting the Database Administrator Password</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_the_Packages2"></a>7.1.&nbsp;Installing the Packages</h2></div></div></div><div class="para">
    The steps listed in this procedure install the packages required by the MySQL database server. The packages that will be installed are:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">mysql-server</span></span></dt><dd><div class="para">
          Provides the MySQL database server.
        </div></dd><dt><span class="term"><span class="package">mysql</span></span></dt><dd><div class="para">
          Provides the MySQL client tools and libraries. Installed as a dependency of the <span class="package">mysql-server</span> package.
        </div></dd></dl></div><div class="para">
    All steps listed in this procedure must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Install the required packages using the <code class="command">yum</code> command:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y mysql-server</code></code></strong></pre></li></ul></div><div class="para">
    The database server is installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15832-549359+%5BLatest%5D&amp;cf_build_id=15832-549359+29+Oct+2013+11%3A19+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_the_Firewall3"></a>7.2.&nbsp;Configuring the Firewall</h2></div></div></div><div class="para">
    As the database service is used by all of the components in the OpenStack environment it must be accessible by them.
  </div><div class="para">
    To allow this the firewall on the system hosting the database service must be altered to allow network traffic on the required port. All steps in this procedure must be run while logged in to the server hosting the database service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
      </div></li><li class="step"><div class="para">
        Add an INPUT rule allowing TCP traffic on port <code class="literal">3306</code> to the file. The new rule must appear before any INPUT rules that REJECT traffic.
      </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 3306 -j ACCEPT</pre></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
      </div></li><li class="step"><div class="para">
        Restart the <code class="command">iptables</code> service to ensure that the change takes effect.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">iptables</code> firewall is now configured to allow incoming connections to the MySQL database service on port <code class="literal">3306</code>.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15837-549360+%5BLatest%5D&amp;cf_build_id=15837-549360+29+Oct+2013+11%3A19+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Starting_the_Database_Service"></a>7.3.&nbsp;Starting the Database Service</h2></div></div></div><div class="para">
    All steps in this procedure must be performed while logged in to the server hosting the database service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">service</code> command to start the <code class="systemitem">mysqld</code> service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service mysqld start</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chkconfig</code> command to ensure that the <code class="systemitem">mysqld</code> service will be started automatically in the future.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig mysqld on</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">mysqld</code> service has been started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15954-541150+%5BLatest%5D&amp;cf_build_id=15954-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+the+Database+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_the_Database"></a>7.4.&nbsp;Setting the Database Administrator Password</h2></div></div></div><div class="para">
    The MySQL database server maintains its own list of user accounts and authentication details including a <code class="systemitem">root</code> user account. This account acts as the database administrator account.
  </div><div class="para">
    For security reasons it is recommended that you set a password for the <code class="systemitem">root</code> database user once the database service has been started for the first time.
  </div><div class="para">
    All steps in this procedure must be run while logged in to the system hosting the MySQL database as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">mysqladmin</code> command to set the password for the <code class="systemitem">root</code> database user.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">/usr/bin/mysqladmin -u root password &quot;<em class="replaceable"><code>PASSWORD</code></em>&quot;</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with the intended password.
      </div></li><li class="step"><div class="para">
        The <code class="command">mysqladmin</code> command can also be used to change the password of the <code class="systemitem">root</code> database user if required.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">/usr/bin/mysqladmin -u root -p <em class="replaceable"><code>OLDPASS</code></em> <em class="replaceable"><code>NEWPASS</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>OLDPASS</code></em> with the existing password and <em class="replaceable"><code>NEWPASS</code></em> with the password that is intended to replace it.
      </div></li></ol></div><div class="para">
    The MySQL administrator, or <code class="systemitem">root</code>, password has been set. This password will be required when logging in to create databases and database users.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15899-541150+%5BLatest%5D&amp;cf_build_id=15899-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Database+Administrator+Password%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_Message_Broker"></a>Chapter&nbsp;8.&nbsp;Installing the Message Broker</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Installing_the_Packages">8.1. Installing the Packages</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Message_Broker">8.2. Configuring the Message Broker</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Simple_Authentication_and_Security_Layer_-_SASL">8.2.1. Simple Authentication and Security Layer - SASL</a></span></dt><dt><span class="section"><a href="#sect-Configuring_TLSSSL">8.2.2. Configuring TLS/SSL</a></span></dt></dl></dd><dt><span class="section"><a href="#Firewall_Configuration">8.3. Firewall Configuration</a></span></dt><dt><span class="section"><a href="#Starting_the_Messaging_Server">8.4. Starting the Messaging Server</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_the_Packages"></a>8.1.&nbsp;Installing the Packages</h2></div></div></div><div class="para">
    The steps listed in this procedure install the packages required by the Qpid message broker. The packages that will be installed are:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">qpid-cpp-server</span></span></dt><dd><div class="para">
          Provides the Qpid message broker.
        </div></dd><dt><span class="term"><span class="package">qpid-cpp-server-ssl</span></span></dt><dd><div class="para">
          Provides the Qpid plug-in enabling support for SSL as a transport later for AMQP traffic. This package is optional but recommended to support secure configuration of Qpid.
        </div></dd></dl></div><div class="para">
    All steps listed in this procedure must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Install the required packages using the <code class="command">yum</code> command:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y qpid-cpp-server qpid-cpp-server-ssl</code></code></strong></pre></li></ul></div><div class="para">
    The Qpid message broker is installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15820-541150+%5BLatest%5D&amp;cf_build_id=15820-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuring_the_Message_Broker"></a>8.2.&nbsp;Configuring the Message Broker</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Simple_Authentication_and_Security_Layer_-_SASL"></a>8.2.1.&nbsp;Simple Authentication and Security Layer - SASL</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="SASL_-_Simple_Authentication_and_Security_Layer"></a>8.2.1.1.&nbsp;SASL - Simple Authentication and Security Layer</h4></div></div></div><div class="para">
    Qpid is optionally able to use Simple Authentication and Security Layer (SASL) for identifying and authorizing incoming connections to the broker, as mandated in the AMQP specification. SASL provides a variety of authentication methods. Clients can negotiate with the Messaging Broker to find a SASL mechanism that both can use.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17954-541150+%5BLatest%5D&amp;cf_build_id=17954-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+SASL+-+Simple+Authentication+and+Security+Layer%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="SASL_Mechanisms1"></a>8.2.1.2.&nbsp;SASL Mechanisms</h4></div></div></div><div class="para">
    The SASL authentication mechanisms allowed by the broker are controlled by the file <code class="filename">/etc/sasl2/qpidd.conf</code> on the broker. To narrow the allowed mechanisms to a smaller subset, edit this file and remove mechanisms.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      The PLAIN authentication mechanism sends passwords in cleartext. If using this mechanism, for complete security using Security Services Library (SSL) is recommended.
    </div></div></div><div class="variablelist"><p class="title"><strong>SASL Mechanisms</strong></p><dl class="variablelist"><dt><span class="term">ANONYMOUS</span></dt><dd><div class="para">
          Clients are able to connect anonymously.
        </div><div class="para">
          Note that when the broker is started with <code class="code">auth=no</code>, authentication is disabled. <code class="code">PLAIN</code> and <code class="code">ANONYMOUS</code> authentication mechanisms are available as <span class="emphasis"><em>identification mechanisms</em></span>, but they have no authentication value.
        </div></dd><dt><span class="term">PLAIN</span></dt><dd><div class="para">
          Passwords are passed in plain text between the client and the broker. This is not a secure mechanism, and should be used in development environments only. If PLAIN is used in production, it should only be used over SSL connections, where the SSL encryption of the transport protects the password.
        </div><div class="para">
          Note that when the broker is started with <code class="code">auth=no</code>, authentication is disabled. The <code class="code">PLAIN</code> and <code class="code">ANONYMOUS</code> authentication mechanisms are available as <span class="emphasis"><em>identification mechanisms</em></span>, but they have no authentication value.
        </div></dd><dt><span class="term">DIGEST-MD5</span></dt><dd><div class="para">
          MD5 hashed passwords are exchanged using HTTP headers. This is a medium strength security protocol.
        </div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17953-541150+%5BLatest%5D&amp;cf_build_id=17953-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+SASL+Mechanisms%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="SASL_Mechanisms_and_Packages1"></a>8.2.1.3.&nbsp;SASL Mechanisms and Packages</h4></div></div></div><div class="para">
    The following table lists the <code class="filename">cyrus-sasl-*</code> package(s) that need to be installed on the server for each authentication mechanism to be available.
  </div><div class="table"><a id="idp2485080"></a><p class="title"><strong>Table&nbsp;8.1.&nbsp;</strong></p><div class="table-contents"><table summary=""><colgroup><col width="33%" /><col width="33%" /><col width="33%" /></colgroup><thead><tr><th class="">
            Method
          </th><th class="">
            Package
          </th><th class="">
            <code class="filename">/etc/sasl2/qpidd.conf</code> entry
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              ANONYMOUS
            </div>

          </td><td class="">
            <div class="para">
              -
            </div>

          </td><td class="">
            <div class="para">
              -
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              PLAIN
            </div>

          </td><td class="">
            <div class="para">
              <code class="filename">cyrus-sasl-plain</code>
            </div>

          </td><td class="">
            <div class="para">
              <code class="code">mech_list: PLAIN</code>
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              DIGEST-MD5
            </div>

          </td><td class="">
            <div class="para">
              <code class="filename">cyrus-sasl-md5</code>
            </div>

          </td><td class="">
            <div class="para">
              <code class="code">mech_list: DIGEST-MD5</code>
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17955-541150+%5BLatest%5D&amp;cf_build_id=17955-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+SASL+Mechanisms+and+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configure_SASL_using_a_Local_Password_File1"></a>8.2.1.4.&nbsp;Configure SASL using a Local Password File</h4></div></div></div><div class="para">
    The local SASL database is used by the PLAIN and DIGEST-MD5 authentication mechanisms.
  </div><div class="procedure"><a id="idp2659224"></a><p class="title"><strong>Procedure&nbsp;8.1.&nbsp;Configure SASL using a Local Password File</strong></p><div class="para">
      To use the default SASL PLAIN authentication mechanism implemented by Qpid, either use the default username and password of <em class="parameter"><code>guest</code></em>, which are included in the database at <code class="filename">/var/lib/qpidd/qpidd.sasldb</code> on installation, or add your own accounts.
    </div><ol class="1"><li class="step"><div class="para">
        Add new users to the database by using the <code class="command">saslpasswd2</code> command. The User ID for authentication and ACL authorization uses the form <code class="command"><em class="replaceable"><code>user-id</code></em>@<em class="replaceable"><code>domain</code></em></code>.
      </div><div class="para">
        Ensure that the correct realm has been set for the broker. This can be done by editing the configuration file or using the <code class="command">-u</code> option. The default realm for the broker is <em class="parameter"><code>QPID</code></em>.
      </div><pre class="screen">
# saslpasswd2 -f /var/lib/qpidd/qpidd.sasldb -u <em class="replaceable"><code>QPID</code></em> <em class="replaceable"><code>new_user_name</code></em></pre></li><li class="step"><div class="para">
        Existing user accounts can be listed by using the <code class="command">-f</code> option:
      </div><pre class="screen">
# sasldblistusers2 -f /var/lib/qpidd/qpidd.sasldb
</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          The user database at <code class="filename">/var/lib/qpidd/qpidd.sasldb</code> is readable only by the <code class="systemitem">qpidd</code> user. If you start the broker from a user other than the <code class="systemitem">qpidd</code> user, you will need to either modify the configuration file, or turn authentication off.
        </div><div class="para">
          Note also that this file must be readable by the <code class="systemitem">qpidd</code> user. If you delete and recreate this file, make sure the qpidd user has read permissions, or authentication attempts will fail.
        </div></div></div></li><li class="step"><div class="para">
        To switch authentication on or off, add the appropriate line to to the <code class="filename">/etc/qpidd.conf</code> configuration file:
      </div><pre class="programlisting">
auth=no

auth=yes
</pre><div class="para">
        The SASL configuration file is in <code class="filename">/etc/sasl2/qpidd.conf</code> for Red Hat Enterprise Linux.
      </div></li></ol></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17951-541150+%5BLatest%5D&amp;cf_build_id=17951-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configure+SASL+using+a+Local+Password+File%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Configuring_TLSSSL"></a>8.2.2.&nbsp;Configuring TLS/SSL</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Encryption_Using_SSL1"></a>8.2.2.1.&nbsp;Encryption Using SSL</h4></div></div></div><div class="para">
    Encryption and certificate management for <code class="command">qpidd</code> is provided by Mozilla's Network Security Services Library (NSS).
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17957-541150+%5BLatest%5D&amp;cf_build_id=17957-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Encryption+Using+SSL%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Enable_SSL_on_the_Broker1"></a>8.2.2.2.&nbsp;Enable SSL on the Broker</h4></div></div></div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        You will need a certificate that has been signed by a Certification Authority (CA). This certificate will also need to be trusted by your client. If you require client authentication in addition to server authentication, the client certificate will also need to be signed by a CA and trusted by the broker.
      </div><div class="para">
        In the broker, SSL is provided through the <code class="command">ssl.so</code> module. This module is installed and loaded by default in MRG Messaging. To enable the module, you need to specify the location of the database containing the certificate and key to use. This is done using the <code class="command">ssl-cert-db</code> option.
      </div><div class="para">
        The certificate database is created and managed by the Mozilla Network Security Services (NSS) <code class="command">certutil</code> tool. Information on this utility can be found on the <a href="http://www.mozilla.org/projects/security/pki/nss/tools/certutil.html">Mozilla website</a>, including tutorials on setting up and testing SSL connections. The certificate database will generally be password protected. The safest way to specify the password is to place it in a protected file, use the password file when creating the database, and specify the password file with the <code class="command">ssl-cert-password-file</code> option when starting the broker.
      </div><div class="para">
        The following script shows how to create a certificate database using certutil:
      </div><pre class="programlisting">mkdir ${CERT_DIR}
certutil -N -d ${CERT_DIR} -f ${CERT_PW_FILE}
certutil -S -d ${CERT_DIR} -n ${NICKNAME} -s &quot;CN=${NICKNAME}&quot; -t &quot;CT,,&quot; -x -f ${CERT_PW_FILE} -z /usr/bin/certutil
</pre><div class="para">
        When starting the broker, set <code class="command">ssl-cert-password-file</code> to the value of <code class="command">${CERT_PW_FILE}</code>, set <code class="command">ssl-cert-db</code> to the value of <code class="command">${CERT_DIR}</code>, and set <code class="command">ssl-cert-name</code> to the value of <code class="command">${NICKNAME}</code>.
      </div></li><li class="step"><div class="para">
        The following SSL options can be used when starting the broker:
        <div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="command">--ssl-use-export-policy</code></span></dt><dd><div class="para">
                Use NSS export policy
              </div></dd><dt><span class="term"><code class="command">--ssl-cert-password-file <em class="replaceable"><code>PATH</code></em></code></span></dt><dd><div class="para">
                Required. Plain-text file containing password to use for accessing certificate database.
              </div></dd><dt><span class="term"><code class="command">--ssl-cert-db <em class="replaceable"><code>PATH</code></em></code></span></dt><dd><div class="para">
                Required. Path to directory containing certificate database.
              </div></dd><dt><span class="term"><code class="command">--ssl-cert-name <em class="replaceable"><code>NAME</code></em></code></span></dt><dd><div class="para">
                Name of the certificate to use. Default is <code class="literal">localhost.localdomain</code>.
              </div></dd><dt><span class="term"><code class="command">--ssl-port <em class="replaceable"><code>NUMBER</code></em></code></span></dt><dd><div class="para">
                Port on which to listen for SSL connections. If no port is specified, port 5671 is used.
              </div><div class="para">
                If the SSL port chosen is the same as the port for non-SSL connections (i.e. if the <code class="command">--ssl-port</code> and <code class="command">--port</code> options are the same), both SSL encrypted and unencrypted connections can be established to the same port. However in this configuration there is no support for IPv6.
              </div></dd><dt><span class="term"><code class="command">--ssl-require-client-authentication</code></span></dt><dd><div class="para">
                Require SSL client authentication (i.e. verification of a client certificate) during the SSL handshake. This occurs before SASL authentication, and is independent of SASL.
              </div><div class="para">
                This option enables the <code class="literal">EXTERNAL</code> SASL mechanism for SSL connections. If the client chooses the <code class="literal">EXTERNAL</code> mechanism, the client's identity is taken from the validated SSL certificate, using the <code class="literal">CN</code>, and appending any <code class="literal">DC</code>'s to create the domain. For instance, if the certificate contains the properties <code class="literal">CN=bob</code>, <code class="literal">DC=acme</code>, <code class="literal">DC=com</code>, the client's identity is <code class="literal">bob@acme.com</code>.
              </div><div class="para">
                If the client chooses a different SASL mechanism, the identity take from the client certificate will be replaced by that negotiated during the SASL handshake.
              </div></dd><dt><span class="term"><code class="command">--ssl-sasl-no-dict</code></span></dt><dd><div class="para">
                Do not accept SASL mechanisms that can be compromised by dictionary attacks. This prevents a weaker mechanism being selected instead of <code class="literal">EXTERNAL</code>, which is not vulnerable to dictionary attacks.
              </div></dd><dt><span class="term"><code class="code">--require-encryption</code></span></dt><dd><div class="para">
                This will cause <code class="command">qpidd</code> to only accept encrypted connections. This means only clients with EXTERNAL SASL on the SSL-port, or with GSSAPI on the TCP port.
              </div></dd></dl></div>

      </div></li></ol></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17958-541150+%5BLatest%5D&amp;cf_build_id=17958-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Enable+SSL+on+the+Broker%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Export_an_SSL_Certificate_for_Clients1"></a>8.2.2.3.&nbsp;Export an SSL Certificate for Clients</h4></div></div></div><div class="para">
    When SSL is enabled on a server, the clients require a copy of the SSL certificate to establish a secure connection.
  </div><div class="para">
    The following example commands can be used to export a client certificate and the private key from the broker's NSS database:
  </div><pre class="programlisting">pk12util -o <em class="replaceable"><code>&lt;p12exportfile&gt;</code></em> -n <em class="replaceable"><code>&lt;certname&gt;</code></em> -d <em class="replaceable"><code>&lt;certdir&gt;</code></em> -w <em class="replaceable"><code>&lt;p12filepwfile&gt;</code></em>

openssl pkcs12 -in <em class="replaceable"><code>&lt;p12exportfile&gt;</code></em> -out <em class="replaceable"><code>&lt;clcertname&gt;</code></em> -nodes -clcerts -passin pass:<em class="replaceable"><code>&lt;p12pw&gt;</code></em></pre><div class="para">
    For more information on SSL commands and options, refer to the <a href="http://www.openssl.org/docs/apps/openssl.html">OpenSSL Documentation</a>. On Red Hat Enterprise Linux type: <code class="command">man openssl</code>.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17956-541150+%5BLatest%5D&amp;cf_build_id=17956-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Export+an+SSL+Certificate+for+Clients%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Firewall_Configuration"></a>8.3.&nbsp;Firewall Configuration</h2></div></div></div><div class="para">
    You must allow incoming connections on the port used by the Messaging System. The default port for AMQP traffic is <code class="literal">5672</code>.
  </div><div class="para">
    On a Red Hat Enterprise Linux system, the firewall is provided by <code class="command">iptables</code>. You can configure the firewall by editing the <code class="command">iptables</code> configuration file, namely <code class="filename">/etc/sysconfig/iptables</code>. To do so:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
      </div></li><li class="step"><div class="para">
        Add an <code class="literal">INPUT</code> rule allowing incoming connections on port <code class="literal">5672</code> to the file. The new rule must appear before any <code class="literal">INPUT</code> rules that <code class="literal">REJECT</code> traffic.
      </div><pre class="screen">-A INPUT -p tcp -m tcp --dport 5672  -j ACCEPT</pre></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
      </div></li><li class="step"><div class="para">
        Restart the <code class="systemitem">iptables</code> service for the firewall changes to take effect.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    To view the currently configured firewall rules, issue the command:
  </div><pre class="screen"><code class="prompt">#</code>service iptables status</pre><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+8388-555727+%5BSpecified%5D&amp;cf_build_id=8388-555727+14+Nov+2013+10%3A49+en-US+%5BSpecified%5D&amp;comment=Title%3A+Firewall+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Starting_the_Messaging_Server"></a>8.4.&nbsp;Starting the Messaging Server</h2></div></div></div><div class="para">
    The <code class="systemitem">qpidd</code> service must be started before the broker can commence sending and receiving messages.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">service</code> command to start the service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service qpidd start</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chkconfig</code> command to enable the service permanently.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig qpidd on</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">qpidd</code> service has been started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15809-541150+%5BLatest%5D&amp;cf_build_id=15809-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+the+Messaging+Server%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_OpenStack_Identity_Service"></a>Chapter&nbsp;9.&nbsp;Installing the OpenStack Identity Service</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Identity_Service_Requirements">9.1. Identity Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Packages1">9.2. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Creating_the_Identity_Database">9.3. Creating the Identity Database</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Service">9.4. Configuring the Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Setting_the_Initial_Administration_Token">9.4.1. Setting the Administration Token</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String">9.4.2. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Public_Key_Infrastructure">9.4.3. Configuring the Public Key Infrastructure</a></span></dt><dt><span class="section"><a href="#Configuring_for_an_LDAP_Backend">9.4.4. Configuring for an LDAP Backend</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall7">9.4.5. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Identity_Service_Database">9.4.6. Populating the Identity Service Database</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Identity_Service">9.5. Starting the Identity Service</a></span></dt><dt><span class="section"><a href="#Creating_the_Permanent_Service_Endpoint">9.6. Creating the Identity Service Endpoint</a></span></dt><dt><span class="section"><a href="#Creating_Roles1">9.7. Creating an Administrator Account</a></span></dt><dt><span class="section"><a href="#Creating_User_Accounts1">9.8. Creating a Regular User Account</a></span></dt><dt><span class="section"><a href="#Creating_the_Services_Tenant">9.9. Creating the Services Tenant</a></span></dt><dt><span class="section"><a href="#Validating_the_Identity_Service_Installation">9.10. Validating the Identity Service Installation</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Identity_Service_Requirements"></a>9.1.&nbsp;Identity Service Requirements</h2></div></div></div><div class="para">
    The system hosting the identity service must have:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Access to Red Hat Network or equivalent service provided by a tool such as Satellite.
      </div></li><li class="listitem"><div class="para">
        A network interface that is addressable by all other systems that will host OpenStack services.
      </div></li><li class="listitem"><div class="para">
        Network access to the database server.
      </div></li><li class="listitem"><div class="para">
        Network access to the directory server if using an LDAP backend.
      </div></li></ul></div><div class="para">
    Ensure that these requirements are met before proceeding with installation and configuration of the identity service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15865-541150+%5BLatest%5D&amp;cf_build_id=15865-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Identity+Service+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_the_Packages1"></a>9.2.&nbsp;Installing the Packages</h2></div></div></div><div class="para">
    The steps listed in this procedure install the packages required by the OpenStack Identity service. The packages that will be installed are:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">openstack-keystone</span></span></dt><dd><div class="para">
          Provides the OpenStack Identity service.
        </div></dd><dt><span class="term"><span class="package">openstack-utils</span></span></dt><dd><div class="para">
          Provides supporting utilities to assist with a number of tasks including the editing of configuration files.
        </div></dd><dt><span class="term"><span class="package">openstack-selinux</span></span></dt><dd><div class="para">
          Provides OpenStack specific SELinux policy modules.
        </div></dd></dl></div><div class="para">
    All steps listed in this procedure must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Install the required packages using the <code class="command">yum</code> command:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y openstack-keystone \</code></code></strong>
      <strong class="userinput"><code><code class="command">openstack-utils \</code></code></strong>
      <strong class="userinput"><code><code class="command">openstack-selinux</code></code></strong></pre></li></ul></div><div class="para">
    The OpenStack Identity service is installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15816-541150+%5BLatest%5D&amp;cf_build_id=15816-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_the_Identity_Database"></a>9.3.&nbsp;Creating the Identity Database</h2></div></div></div><div class="para">
    In this procedure the database and database user that will be used by the identity service will be created. These steps must be performed while logged in to the database server as the <code class="systemitem">root</code> user (or at least as a user with the correct permissions: <code class="systemitem">create db</code>, <code class="systemitem">create user</code>, <code class="systemitem">grant permissions</code>).
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Connect to the database service using the <code class="command">mysql</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">mysql -u root -p</code></code></strong></pre></li><li class="step"><div class="para">
        Create the <code class="literal">keystone</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> CREATE DATABASE keystone;</pre></li><li class="step"><div class="para">
        Create a <code class="literal">keystone</code> database user and grant it access to the <code class="literal">keystone</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON keystone.* TO 'keystone'@'%' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON keystone.* TO 'keystone'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used to authenticate with the database server as this user.
      </div></li><li class="step"><div class="para">
        Flush the database privileges to ensure that they take effect immediately.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> FLUSH PRIVILEGES;</pre></li><li class="step"><div class="para">
        Exit the <code class="command">mysql</code> client command.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> quit</pre></li></ol></div><div class="para">
    The database has been created. The database will be populated during service configuration.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15813-541150+%5BLatest%5D&amp;cf_build_id=15813-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Identity+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuring_the_Service"></a>9.4.&nbsp;Configuring the Service</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Setting_the_Initial_Administration_Token"></a>9.4.1.&nbsp;Setting the Administration Token</h3></div></div></div><div class="para">
    Before the identity service is started for the first time you must define an administrative token in an environment variable. This value will be used to authenticate before user and service accounts have been defined using the identity service.
  </div><div class="para">
    All steps listed in this procedure must be performed while logged in to the server that will host the identity service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use OpenSSL to generate an initial service token and save it in the <code class="literal">SERVICE_TOKEN</code> environment variable.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">export SERVICE_TOKEN=$(openssl rand -hex 10)</code></code></strong></pre></li><li class="step"><div class="para">
        Store the value of the administration token in a file for future use.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">echo $SERVICE_TOKEN &gt; ~/ks_admin_token</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> tool to set the value of the <code class="literal">admin_token</code> configuration key to that of the newly created token.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/keystone/keystone.conf \</code></code></strong>
<strong class="userinput"><code><code class="command">DEFAULT admin_token $SERVICE_TOKEN</code></code></strong></pre></li></ol></div><div class="para">
    The administration token for the identity service has been created. This value will be used in subsequent identity configuration procedures.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15815-541150+%5BLatest%5D&amp;cf_build_id=15815-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Administration+Token%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Setting_the_Database_Connection_String"></a>9.4.2.&nbsp;Setting the Database Connection String</h3></div></div></div><div class="para">
    The database connection string used by the identity service is defined in the <code class="filename">/etc/keystone/keystone.conf</code> file. It must be updated to point to a valid database server before starting the service.
  </div><div class="para">
    All commands in this procedure must be run while logged in as the <code class="systemitem">root</code> user on the server hosting the identity service.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> command to set the value of the <code class="literal">connection</code> configuration key.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/keystone/keystone.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">sql connection mysql://<em class="replaceable"><code>USER</code></em>:<em class="replaceable"><code>PASS</code></em>@<em class="replaceable"><code>IP</code></em>/<em class="replaceable"><code>DB</code></em></code></code></strong></pre><div class="para">
        Replace:
        <div class="itemizedlist"><ul><li class="listitem"><div class="para">
              <em class="replaceable"><code>USER</code></em> with the database user name the identity service is to use, usually <code class="literal">keystone</code>.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>PASS</code></em> with the password of the chosen database user.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>IP</code></em> with the IP address or host name of the database server.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>DB</code></em> with the name of the database that has been created for use by the identity service, usually <code class="literal">keystone</code>.
            </div></li></ul></div>

      </div></li></ul></div><div class="para">
    The database connection string has been set and will be used by the identity service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15984-541150+%5BLatest%5D&amp;cf_build_id=15984-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Database+Connection+String%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Configuring_the_Public_Key_Infrastructure"></a>9.4.3.&nbsp;Configuring the Public Key Infrastructure</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Public_Key_Infrastructure_Overview"></a>9.4.3.1.&nbsp;Public Key Infrastructure Overview</h4></div></div></div><div class="para">
    The identity service generates tokens which are cryptographically signed documents users and other services use for authentication. The tokens are signed using a private key while the public key is made available in an X509 certificate.
  </div><div class="para">
    The certificates and relevant configuration keys are automatically generated by the <code class="command">keystone-manage pki_setup</code> command. It is however possible to manually create and sign the required certificates using a third party certificate authority. If using third party certificates the identity service configuration must be manually updated to point to the certificates and supporting files.
  </div><div class="para">
    The configuration keys relevant to PKI setup appear in the <code class="literal">[signing]</code> section of the <code class="filename">/etc/keystone/keystone.conf</code> configuration file that are relevant to the PKI setup are:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_certs</span></dt><dd><div class="para">
          Specifies the location of the certificate for the authority that issued the certificate denoted by the <code class="literal">certfile</code> configuration key. The default value is <code class="filename">/etc/keystone/ssl/certs/ca.pem</code>.
        </div></dd><dt><span class="term">ca_key</span></dt><dd><div class="para">
          Specifies the key of the certificate authority that issued the certificate denoted by the <code class="literal">certfile</code> configuration key. The default value is <code class="filename">/etc/keystone/ssl/certs/cakey.pem</code>.
        </div></dd><dt><span class="term">ca_password</span></dt><dd><div class="para">
          Specifies the password, if applicable, required to open the certificate authority file. The default action if no value is specified is not to use a password.
        </div></dd><dt><span class="term">certfile</span></dt><dd><div class="para">
          Specifies the location of the certificate that must be used to verify tokens. The default value of <code class="filename">/etc/keystone/ssl/certs/signing_cert.pem</code> is used if no value is specified.
        </div></dd><dt><span class="term">keyfile</span></dt><dd><div class="para">
          Specifies the location of the private key that must be used when signing tokens. The default value of <code class="filename">/etc/keystone/ssl/private/signing_key.pem</code> is used if no value is specified.
        </div></dd><dt><span class="term">token_format</span></dt><dd><div class="para">
          Specifies the algorithm to use when generating tokens. Possible values are <code class="literal">UUID</code> and <code class="literal">PKI</code>. The default value is <code class="literal">PKI</code>.
        </div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16076-541150+%5BLatest%5D&amp;cf_build_id=16076-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Public+Key+Infrastructure+Overview%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Creating_the_Public_Key_Infrastructure_Files"></a>9.4.3.2.&nbsp;Creating the Public Key Infrastructure Files</h4></div></div></div><div class="para">
    This procedure documents the steps required to configure the PKI files for use by the identity service. All steps listed in this procedure must be performed while logged into the system hosting the identity service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Run the <code class="command">keystone-manage pki_setup</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone-manage pki_setup \</code></code></strong>
   <strong class="userinput"><code><code class="command">--keystone-user <em class="replaceable"><code>keystone</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">--keystone-group <em class="replaceable"><code>keystone</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Ensure that the <code class="literal">keystone</code> user owns the <code class="filename">/var/log/keystone/</code> and <code class="filename">/etc/keystone/ssl/</code> directories.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chown -R keystone:keystone /var/log/keystone \</code></code></strong>
   <strong class="userinput"><code><code class="command">/etc/keystone/ssl/</code></code></strong></pre></li></ol></div><div class="para">
    The identity service PKI infrastructure files have been created and will be used when generating and signing tokens.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16077-541150+%5BLatest%5D&amp;cf_build_id=16077-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Public+Key+Infrastructure+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_for_an_LDAP_Backend"></a>9.4.4.&nbsp;Configuring for an LDAP Backend</h3></div></div></div><div class="para">
    The default identity service deployment is backed by an SQL database. As an alternative the identity service is able to use an existing directory server.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      For the Identity service to access an LDAP backend, SELinux requires the <code class="systemitem">authlogin_nsswitch_use_ldap</code> Boolean enabled on any client machine accessing the LDAP backend. Run the following command on each client machine as the <code class="systemitem">root</code> user to enable the Boolean and make it persistent across reboots:
    </div><pre class="screen"># setsebool -P authlogin_nsswitch_use_ldap</pre></div></div><div class="para">
    This is an example directory server schema intended to support the identity service:
  </div><pre class="programlisting">dn: cn=example,cn=org
dc: openstack
objectClass: dcObject
objectClass: organizationalUnit
ou: openstack

dn: ou=Groups,cn=example,cn=org
objectClass: top
objectClass: organizationalUnit
ou: groups

dn: ou=Users,cn=example,cn=org
objectClass: top
objectClass: organizationalUnit
ou: users

dn: ou=Roles,cn=example,cn=org
objectClass: top
objectClass: organizationalUnit
ou: roles</pre><div class="para">
    The corresponding entries in the identity service configuration file, <code class="filename">/etc/keystone/keystone.conf</code> are:
  </div><pre class="programlisting">[ldap]
url = ldap://localhost
user = dc=Manager,dc=openstack,dc=org
password = badpassword
suffix = dc=openstack,dc=org
use_dumb_member = False
allow_subtree_delete = False

user_tree_dn = ou=Users,dc=openstack,dc=com
user_objectclass = inetOrgPerson

tenant_tree_dn = ou=Groups,dc=openstack,dc=com
tenant_objectclass = groupOfNames

role_tree_dn = ou=Roles,dc=example,dc=com
role_objectclass = organizationalRole</pre><div class="para">
    The default object classes and attributes defined in this example are intentionally simplistic. They reflect the common standard objects as described in the LDAP RFCs.
  </div><div class="para">
    These attributes are merely suggestions and can be overridden to support a preexisting, more complex schema. As an example within the user object, the <code class="literal">objectClass</code><code class="literal">posixAccount</code> described in RFC2307 is commonly found in directory server implementations.
  </div><div class="para">
    If this is the underlying <code class="literal">objectclass</code>, then the <code class="literal">uid</code> field is likely to be named <code class="literal">uidNumber</code> and the <code class="literal">username</code> field is likely to be named either <code class="literal">uid</code> or <code class="literal">cn</code>. To change these two fields, the corresponding entries in the identity service configuration file are:
  </div><pre class="programlisting">[ldap]
user_id_attribute = uidNumber
user_name_attribute = cn</pre><div class="para">
    There is also a set of allowed actions per object type that can be defined and modified depending on your specific deployment needs.
  </div><div class="para">
    For example, the users are managed by another tool and you have only read access, in such case the configuration is:
  </div><pre class="programlisting">[ldap]
user_allow_create = False
user_allow_update = False
user_allow_delete = False

tenant_allow_create = True
tenant_allow_update = True
tenant_allow_delete = True

role_allow_create = True
role_allow_update = True
role_allow_delete = True</pre><div class="para">
    There are also configuration options for filtering users, tenants and roles, if the backend is providing too much output. In such cases the configuration values that must be modified are:
  </div><pre class="programlisting">[ldap]
user_filter = (memberof=CN=openstack-users,OU=workgroups,DC=openstack,DC=com)
tenant_filter =
role_filter =</pre><div class="para">
    Some directory servers do not expose a boolean attribute indicating whether a user account is enabled or disabled. Where this is the case it is possible to configure the Identity service to extract an equivalent value from an integer attribute such as that used by Active Directory:
  </div><pre class="programlisting">[ldap]
user_enabled_attribute = userAccountControl
user_enabled_mask      = 2
user_enabled_default   = 512</pre><div class="para">
    In this example the attribute <code class="literal">userAccountControl</code> is an integer and the enabled attribute is listed in the first bit (bit 1). The values of the <code class="literal">user_enabled_mask</code> and the <code class="literal">user_enabled_attribute</code> are added together. If the resultant value matches the mask then the account is disabled.
  </div><div class="para">
    The Identity service also saves the value without mask to the user identity in the attribute <code class="literal">enabled_nomask</code>. This is required to allow the restoration of the value when enabling or disabling a user. This needs to be done because the value contains more than just the status of the user. Setting the value of the <code class="literal">user_enabled_mask</code> configuration key is required in order to create a default value on the integer attribute (512 = NORMAL ACCOUNT on Active Directory).
  </div><div class="para">
    In case of Active Directory the classes and attributes could not match the specified classes in the LDAP module so you can configure them like so:
  </div><pre class="programlisting">[ldap]
user_objectclass         = person
user_id_attribute        = cn
user_name_attribute      = cn
user_mail_attribute      = mail
user_enabled_attribute   = userAccountControl
user_enabled_mask        = 2
user_enabled_default     = 512
user_attribute_ignore    = tenant_id,tenants
tenant_objectclass       = groupOfNames
tenant_id_attribute      = cn
tenant_member_attribute  = member
tenant_name_attribute    = ou
tenant_desc_attribute    = description
tenant_enabled_attribute = extensionName
tenant_attribute_ignore  =
role_objectclass         = organizationalRole
role_id_attribute        = cn
role_name_attribute      = ou
role_member_attribute    = roleOccupant
role_attribute_ignore    =</pre><div class="para">
    If you are connecting the identity service to a directory server, it is strongly recommended that you secure the connection between the two. In addition to supporting LDAPS, the identity service also provides Transport Layer Security (TLS) support.
  </div><div class="para">
    Configuring TLS involves identifying the file or directory containing the certficates of the certificate authorities to recognize and trust when verifying the identity of the directory server. Additionally it is necessary to declare which checks the LDAP client must perform when verifying the directory server certificate. This functionality is configured as follows:
  </div><pre class="programlisting">[ldap]
use_tls = True
tls_cacertfile = /etc/keystone/ssl/certs/cacert.pem
tls_cacertdir = /etc/keystone/ssl/certs/
tls_req_cert = demand</pre><div class="para">
    If both <code class="literal">tls_cacertfile</code> and <code class="literal">tls_cacertdir</code> are set then <code class="literal">tls_cacertfile</code> will be used and <code class="literal">tls_cacertdir</code> is ignored. Furthermore, valid options for <code class="literal">tls_req_cert</code> are <code class="literal">demand</code>, <code class="literal">never</code>, and <code class="literal">allow</code>. These correspond to the standard options permitted by the <code class="literal">TLS_REQCERT</code> <code class="literal">TLS</code> option.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15914-541150+%5BLatest%5D&amp;cf_build_id=15914-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+for+an+LDAP+Backend%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Firewall7"></a>9.4.5.&nbsp;Configuring the Firewall</h3></div></div></div><div class="para">
    As the identity service is used by all of the components in the OpenStack environment for authentication it must be accessible by them.
  </div><div class="para">
    To allow this the firewall on the system hosting the identity service must be altered to allow network traffic on the required ports. All steps in this procedure must be run while logged in to the server hosting the identity service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
      </div></li><li class="step"><div class="para">
        Add an INPUT rule allowing TCP traffic on ports <code class="literal">5000</code> and <code class="literal">35357</code> to the file. The new rule must appear before any INPUT rules that REJECT traffic.
      </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 5000,35357 -j ACCEPT</pre></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
      </div></li><li class="step"><div class="para">
        Restart the <code class="command">iptables</code> service to ensure that the change takes effect.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">iptables</code> firewall is now configured to allow incoming connections to the identity service on ports <code class="literal">5000</code> and <code class="literal">35357</code>.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15918-541150+%5BLatest%5D&amp;cf_build_id=15918-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Populating_the_Identity_Service_Database"></a>9.4.6.&nbsp;Populating the Identity Service Database</h3></div></div></div><div class="para">
    This procedure describes the steps required to populate the identity service database. These steps must be performed while logged in to the system hosting the identity service. The database connection string must already be defined in the configuration of the service.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Use the <code class="command">su</code> command to switch to the <code class="literal">keystone</code> user and run the <code class="command">keystone-manage db_sync</code> command to initialize and populate the database identified in <code class="filename">/etc/keystone/keystone.conf</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">su keystone -s /bin/sh -c &quot;keystone-manage db_sync&quot;</code></code></strong></pre></li></ul></div><div class="para">
    The identity service database has been initialized and populated.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16012-541150+%5BLatest%5D&amp;cf_build_id=16012-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Populating+the+Identity+Service+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Starting_the_Identity_Service"></a>9.5.&nbsp;Starting the Identity Service</h2></div></div></div><div class="para">
    All steps in this procedure must be performed while logged in to the server hosting the identity service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">service</code> command to start the <code class="systemitem">openstack-keystone</code> service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-keystone start</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chkconfig</code> command to ensure that the <code class="systemitem">openstack-keystone</code> service will be started automatically in the future.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-keystone on</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">openstack-keystone</code> service has been started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15935-541150+%5BLatest%5D&amp;cf_build_id=15935-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+the+Identity+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_the_Permanent_Service_Endpoint"></a>9.6.&nbsp;Creating the Identity Service Endpoint</h2></div></div></div><div class="para">
    Once the identity service has been started its API endpoint must be defined. Some OpenStack services including the dashboard will not work unless this record is present.
  </div><div class="para">
    All steps listed in this procedure must be performed while logged in to the identity server as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Set the <code class="literal">SERVICE_TOKEN</code> Environment Variable</strong></p><div class="para">
        Set the <code class="literal">SERVICE_TOKEN</code> environment variable to the administration token. This is done by reading the token file created when setting the administration token.
      </div><pre class="screen"><code class="prompt">#</code> export SERVICE_TOKEN=`cat ~/ks_admin_token`</pre></li><li class="step"><p class="title"><strong>Set the <code class="literal">SERVICE_ENDPOINT</code> Environment Variable</strong></p><div class="para">
        Set the <code class="literal">SERVICE_ENDPOINT</code> environment variable to point to the server hosting the identity service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">export SERVICE_ENDPOINT=&quot;http://<em class="replaceable"><code>IP</code></em>:35357/v2.0&quot;</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of your identity server.
      </div></li><li class="step"><p class="title"><strong>Create a Service Entry</strong></p><div class="para">
        Create a service entry for the identity service using the <code class="command">keystone service-create</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone service-create --name=keystone --type=identity \</code></strong>
        <strong class="userinput"><code>--description=&quot;Keystone Identity Service&quot;</code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |     Keystone Identity Service    |
| id          | <span class="bold bold"><strong>a8bff1db381f4751bd8ac126464511ae</strong></span> |
| name        |             keystone             |
| type        |             identity             |
+-------------+----------------------------------+</pre><div class="para">
        Take note of the unique identifier assigned to the entry. This value will be required in subsequent steps.
      </div></li><li class="step"><p class="title"><strong>Create an Endpoint for the API</strong></p><div class="para">
        Create an endpoint entry for the v2.0 API identity service using the <code class="command">keystone endpoint-create</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone endpoint-create \</code></strong>
        <strong class="userinput"><code>--service_id <em class="replaceable"><code>ID</code></em> \</code></strong>
        <strong class="userinput"><code>--publicurl 'http://<em class="replaceable"><code>IP</code></em>:5000/v2.0' \</code></strong>
        <strong class="userinput"><code>--adminurl 'http://<em class="replaceable"><code>IP</code></em>:35357/v2.0' \</code></strong>
        <strong class="userinput"><code>--internalurl 'http://<em class="replaceable"><code>IP</code></em>:5000/v2.0'</code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| adminurl    |       http://<em class="replaceable"><code>IP</code></em>:35357/v2.0       |
| id          | 1295011fdc874a838f702518e95a0e13 |
| internalurl |       http://<em class="replaceable"><code>IP</code></em>:5000/v2.0        |
| publicurl   |       http://<em class="replaceable"><code>IP</code></em>:5000/v2.0        |
| region      |             regionOne            |
| service_id  |                 <em class="replaceable"><code>ID</code></em>               |
+-------------+----------------------------------+</pre><div class="para">
        Replace <em class="replaceable"><code>ID</code></em> with the service identifier returned in the previous step. Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the identity server.
      </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          Ensure that the <code class="literal">publicurl</code>, <code class="literal">adminurl</code>, and <code class="literal">internalurl</code> parameters include the correct IP address for your Keystone identity server.
        </div></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          By default, the endpoint is created in the default region, <code class="literal">regionOne</code>. If you need to specify a different region when creating an endpoint use the <em class="parameter"><code>--region</code></em> argument to provide it.
        </div></div></div></li></ol></div><div class="para">
    The identity service and endpoint entry has been created. The final step in identity service configuration is the creation of the default user accounts, roles, and tenants.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15928-541150+%5BLatest%5D&amp;cf_build_id=15928-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Identity+Service+Endpoint%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_Roles1"></a>9.7.&nbsp;Creating an Administrator Account</h2></div></div></div><div class="para">
    Executing the following procedure will result in the creation of an administrative user as well as an associated tenant and role.
  </div><div class="para">
    The steps listed in this procedure must be performed while logged in to the system hosting the Identity service as a user who has access to a file containing the administration token.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Set the <code class="literal">SERVICE_TOKEN</code> environment variable to the value of the administration token. This is done by reading the token file created when setting the administration token:
      </div><pre class="screen"><code class="prompt">#</code> SERVICE_TOKEN=`cat ~/ks_admin_token`</pre></li><li class="step"><div class="para">
        Set the <code class="literal">SERVICE_ENDPOINT</code> environment variable to point to the server hosting the identity service:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">export SERVICE_ENDPOINT=&quot;http://<em class="replaceable"><code>IP</code></em>:35357/v2.0&quot;</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of your identity server.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone user-create</code> command to create an <code class="literal">admin</code> user:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone user-create --name admin --pass <em class="replaceable"><code>PASSWORD</code></em></code></strong>
+----------+-----------------------------------+
| Property |              Value                |
+----------+-----------------------------------+
| email    |                                   |
| enabled  |              True                 |
| id       | <em class="replaceable"><code>94d659c3c9534095aba5f8475c87091a</code></em>  |
| name     |              admin                |
| tenantId |                                   |
+----------+-----------------------------------+</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password for the account. Take note of the created user's ID as it will be required in subsequent steps.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone role-create</code> command to create an <code class="literal">admin</code> role:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone role-create --name admin</code></code></strong>
+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
| id       | <em class="replaceable"><code>78035c5d3cd94e62812d6d37551ecd6a</code></em> |
| name     |              admin               |
+----------+----------------------------------+</pre><div class="para">
        Take note of the <code class="systemitem">admin</code> user's ID as it will be required in subsequent steps.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone tenant-create</code> command to create an <code class="literal">admin</code> tenant:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone tenant-create --name admin</code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |                                  |
| enabled     |              True                |
| id          | <em class="replaceable"><code>6f8e3e36c4194b86b9a9b55d4b722af3</code></em> |
| name        |              admin               |
+-------------+----------------------------------+</pre><div class="para">
        Take note of the <code class="systemitem">admin</code> tenant's ID as it will be required in the next step.
      </div></li><li class="step"><div class="para">
        Now that the user account, role, and tenant have been created, the relationship between them must be explicitly defined using the <code class="command">keystone user-role-add</code>:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone user-role-add --user-id <em class="replaceable"><code>USERID</code></em> --role-id <em class="replaceable"><code>ROLEID</code></em> --tenant-id <em class="replaceable"><code>TENANTID</code></em></code></strong></pre><div class="para">
        Replace the user, role, and tenant IDs with those obtained in the previous steps.
      </div></li><li class="step"><div class="para">
        The newly created <code class="literal">admin</code> account will be used for future management of the identity service. To facilitate authentication, create a <code class="filename">keystonerc_admin</code> file in a secure location such as the home directory of the <code class="systemitem">root</code> user.
      </div><div class="para">
        Add these lines to the file to set the environment variables that will be used for authentication:
      </div><pre class="programlisting">export OS_USERNAME=admin
export OS_TENANT_NAME=admin
export OS_PASSWORD=<em class="replaceable"><code>PASSWORD</code></em>
export OS_AUTH_URL=http://<em class="replaceable"><code>IP</code></em>:35357/v2.0/
export PS1='[\u@\h \W(keystone_admin)]\$ '</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with the password of the <code class="literal">admin</code> user and replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the identity server.
      </div></li><li class="step"><div class="para">
        Run the <code class="command">source</code> command on the file to load the environment variables used for authentication:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li></ol></div><div class="para">
    An administration user account, role, and tenant have been defined in the Identity server. The <code class="filename">keystonerc_admin</code> file has also been created for authenticating as the <code class="literal">admin</code> user.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15986-541150+%5BLatest%5D&amp;cf_build_id=15986-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+an+Administrator+Account%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_User_Accounts1"></a>9.8.&nbsp;Creating a Regular User Account</h2></div></div></div><div class="para">
    Executing the following procedure will result in the creation of an regular user as well as an associated tenant and role.
  </div><div class="para">
    The steps listed in this procedure must be performed while logged in to the system hosting the Identity service as a user that has access to a file containing the administration token.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Load identity credentials from the <code class="filename">~/keystonerc_admin</code> file that was generated when the administrative user was created:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">keystone user-create</code> to create a regular user:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone user-create --name <em class="replaceable"><code>USER</code></em> --pass <em class="replaceable"><code>PASSWORD</code></em></code></strong>
+----------+-----------------------------------+
| Property |              Value                |
+----------+-----------------------------------+
| email    |                                   |
| enabled  |              True                 |
| id       | <em class="replaceable"><code>b8275d7494dd4c9cb3f69967a11f9765</code></em>  |
| name     |              <em class="replaceable"><code>USER</code></em>                 |
| tenantId |                                   |
+----------+-----------------------------------+</pre><div class="para">
        Replace <em class="replaceable"><code>USER</code></em> with the user name that you would like to use for the account. Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password for the account. Take note of the created user's ID as it will be required in subsequent steps.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone role-create</code> command to create an <code class="literal">Member</code> role. The <code class="literal">Member</code> role is the default role required for access to the dashboard:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone role-create --name Member</code></code></strong>
+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
| id       | <em class="replaceable"><code>78035c5d3cd94e62812d6d37551ecd6a</code></em> |
| name     |             Member               |
+----------+----------------------------------+</pre><div class="para">
        Take note of the created role's ID as it will be required in subsequent steps.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone tenant-create</code> command to create a tenant:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone tenant-create --name <em class="replaceable"><code>TENANT</code></em></code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |                                  |
| enabled     |              True                |
| id          | <em class="replaceable"><code>6f8e3e36c4194b86b9a9b55d4b722af3</code></em> |
| name        |             <em class="replaceable"><code>TENANT</code></em>               |
+-------------+----------------------------------+</pre><div class="para">
        Replace <em class="replaceable"><code>TENANT</code></em> with the name that you wish to give to the tenant. Take note of the created tenant's ID as it will be required in the next step.
      </div></li><li class="step"><div class="para">
        Now that the user account, role, and tenant have been created, the relationship between them must be explicitly defined using the <code class="command">keystone user-role-add</code>:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone user-role-add --user-id <em class="replaceable"><code>USERID</code></em> --role-id <em class="replaceable"><code>ROLEID</code></em> --tenant-id <em class="replaceable"><code>TENANTID</code></em></code></strong></pre><div class="para">
        Replace the user, role, and tenant IDs with those obtained in the previous steps.
      </div></li><li class="step"><div class="para">
        To facilitate authentication create a <code class="filename">keystonerc_user</code> file in a secure location such as the home directory of the <code class="systemitem">root</code> user.
      </div><div class="para">
        Set these environment variables that will be used for authentication:
      </div><pre class="programlisting">export OS_USERNAME=<em class="replaceable"><code>USER</code></em>
export OS_TENANT_NAME=<em class="replaceable"><code>TENANT</code></em>
export OS_PASSWORD=<em class="replaceable"><code>PASSWORD</code></em>
export OS_AUTH_URL=http://<em class="replaceable"><code>IP</code></em>:5000/v2.0/
export PS1='[\u@\h \W(keystone_user)]\$ '</pre><div class="para">
        Replace <em class="replaceable"><code>USER</code></em> and <em class="replaceable"><code>TENANT</code></em> with the name of the new user and tenant respectively. Replace <em class="replaceable"><code>PASSWORD</code></em> with the password of the user and replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the identity server.
      </div></li></ol></div><div class="para">
    A regular user account, role, and tenant have been defined in the identity server. A <code class="filename">keystonerc_user</code> file has also been created for authenticating as the created user.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15985-541150+%5BLatest%5D&amp;cf_build_id=15985-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+a+Regular+User+Account%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_the_Services_Tenant"></a>9.9.&nbsp;Creating the Services Tenant</h2></div></div></div><div class="para">
    Tenants are used to aggregate service resources (tenants are also known as projects). Per tenant, quota controls can be used to limit the numbers of resources (refer to <em class="citetitle">Managing Quotas</em>).
  </div><div class="para">
    Each user is assigned to a tenant. For regular users, their tenant typically represents their group, project, or organisation. For service users (the entity accessing the Identity service on behalf of the service), the tenant represents a service's geographical region . This means that if your cloud's services are:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Distributed, typically one service tenant is created for each endpoint on which services are running (excepting the Identity and Dashboard services).
        </div></li><li class="listitem"><div class="para">
          Deployed on a single node, only one service tenant is required (but of course this is just one option; more can be created for administrative purposes).
        </div></li></ul></div>
     This guide's installation examples are based on all services being deployed on one node, therefore only one service tenant is required; all guide examples use the <code class="systemitem">services</code> tenant.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      Because administrators, regular users, and service users all need a tenant, at least three tenants are typically created, one for each group. To create administrative and regular users and tenants, refer to <em class="citetitle">Creating an Administrator Account</em> and <em class="citetitle">Creating a Regular User Account</em>.
    </div></div></div><div class="para">
    To create the <code class="systemitem">services</code> tenant:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Run the <code class="command">source</code> command on the file containing the environment variables used to identify the Identity service administrator.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Create the <code class="systemitem">services</code> tenant in the Identity service:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>keystone tenant-create --name services --description &quot;Services Tenant&quot;</code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |         Services Tenant          |
| enabled     |              True                |
| id          | <em class="replaceable"><code>7e193e36c4194b86b9a9b55d4b722af3</code></em> |
| name        |             services             |
+-------------+----------------------------------+</pre>

      </div></li></ol></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To obtain a list of all Identity service tenants and their IDs, execute:
<pre class="screen"># keystone tenant-list</pre>

    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+20073-541150+%5BLatest%5D&amp;cf_build_id=20073-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Services+Tenant%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Validating_the_Identity_Service_Installation"></a>9.10.&nbsp;Validating the Identity Service Installation</h2></div></div></div><div class="para">
    Follow the steps outlined in this procedure to verify that an identity service installation is functioning correctly. These steps must be performed while logged in to either the identity server or another system.
  </div><div class="para">
    The logged in user must have access to <code class="filename">keystonerc_admin</code> and <code class="filename">keystonerc_user</code> files containing the environment variables required to authenticate as the administrator user and a regular user respectively.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Run the <code class="command">source</code> command on the file containing the environment variables used to identify the identity service administrator.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Run the <code class="command">keystone user-list</code> command to authenticate with the identity service and list the users defined in the system.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-list</code></code></strong>
+----------------------------------+--------+---------+------------------+
|                id                |  name  | enabled |      email       |
+----------------------------------+--------+---------+------------------+
| <em class="replaceable"><code>94d659c3c9534095aba5f8475c87091a</code></em> | admin  |   True  |                  |
| <em class="replaceable"><code>b8275d7494dd4c9cb3f69967a11f9765</code></em> |  <em class="replaceable"><code>USER</code></em>  |   True  |                  |
+----------------------------------+--------+---------+------------------+</pre><div class="para">
        The list of users defined in the system is displayed. If the list is not displayed then there is an issue with the installation.
      </div><ol class="a"><li class="step"><div class="para">
            If the message returned indicates a permissions or authorization issue then check that the administrator user account, tenant, and role were created properly. Also ensure that the three objects are linked correctly.
          </div><pre class="screen">Unable to communicate with identity service: {&quot;error&quot;: {&quot;message&quot;: &quot;You are not authorized to perform the requested action: admin_required&quot;, &quot;code&quot;: 403, &quot;title&quot;: &quot;Not Authorized&quot;}}. (HTTP 403)</pre></li><li class="step"><div class="para">
            If the message returned indicates a connectivity issue then verify that the <code class="systemitem">openstack-keystone</code> service is running and that <code class="systemitem">iptables</code> is configured to allow connections on ports <code class="literal">5000</code> and <code class="literal">35357</code>.
          </div><pre class="screen">Authorization Failed: [Errno 111] Connection refused</pre></li></ol></li><li class="step"><div class="para">
        Run the <code class="command">source</code> command on the file containing the environment variables used to identify the regular identity service user.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_user</code></code></strong></pre></li><li class="step"><div class="para">
        Run the <code class="command">keystone user-list</code> command to authenticate with the identity service and list the users defined in the system.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-list</code></code></strong>
Unable to communicate with identity service: {&quot;error&quot;: {&quot;message&quot;: &quot;You are not authorized to perform the requested action: admin_required&quot;, &quot;code&quot;: 403, &quot;title&quot;: &quot;Not Authorized&quot;}}. (HTTP 403)</pre><div class="para">
        An error message is displayed indicating that the user is <code class="literal">Not Authorized</code> to run the command. If the error message is not displayed but instead the user list appears then the regular user account was incorrectly attached to the <code class="literal">admin</code> role.
      </div></li><li class="step"><div class="para">
        Run the <code class="command">keystone token-get</code> command to verify that the regular user account is able to run commands that it is authorized to access.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone token-get</code></code></strong>
+-----------+----------------------------------+
|  Property |              Value               |
+-----------+----------------------------------+
|  expires  |       2013-05-07T13:00:24Z       |
|     id    | 5f6e089b24d94b198c877c58229f2067 |
| tenant_id | f7e8628768f2437587651ab959fbe239 |
|  user_id  | 8109f0e3deaf46d5990674443dcf7db7 |
+-----------+----------------------------------+</pre></li></ol></div><div class="para">
    The identity service is installed and functioning correctly.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15919-541150+%5BLatest%5D&amp;cf_build_id=15919-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Validating+the+Identity+Service+Installation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_OpenStack_Object_Storage_Service"></a>Chapter&nbsp;10.&nbsp;Installing the OpenStack Object Storage Service</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Services_that_Make_Up_the_Object_Storage_Service">10.1. Services that Make Up the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Architecture_of_the_Object_Storage_Service">10.2. Architecture of the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_Service_Requirements">10.3. Object Storage Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Object_Storage_Service_Packages">10.4. Installing the Object Storage Service Packages</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Object_Storage_Service">10.5. Configuring the Object Storage Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuraing_Keystone_for_the_Object_Storage_Service">10.5.1. Configuring the Identity Service to work with the Object Storage Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_Object_Storage_Service_Storage_Nodes">10.5.2. Configuring the Object Storage Service Storage Nodes</a></span></dt><dt><span class="section"><a href="#Configuring_the_Object_Storage_Service_Proxy_Service">10.5.3. Configuring the Object Storage Service Proxy Service</a></span></dt><dt><span class="section"><a href="#Object_Storage_Service_Ring_Files">10.5.4. Object Storage Service Rings</a></span></dt><dt><span class="section"><a href="#Building_Object_Storage_Ring_Files">10.5.5. Building Object Storage Service Ring Files</a></span></dt></dl></dd><dt><span class="section"><a href="#Validating_the_Object_Storage_Service_Installation">10.6. Validating the Object Storage Service Installation</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Services_that_Make_Up_the_Object_Storage_Service"></a>10.1.&nbsp;Services that Make Up the Object Storage Service</h2></div></div></div><div class="para">
    The Object Storage Service is made up of 4 services that work together to manage the storage of data objects.
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Proxy Service</span></dt><dd><div class="para">
          The proxy service uses the object ring to decide where to direct newly uploaded objects. It updates the relevant container database to reflect the presence of a new object. If a newly uploaded object goes to a new container, the proxy service updates the relevant account database to reflect the new container.
        </div><div class="para">
          The proxy service also directs get requests to one of the nodes where a replica of the requested object is stored, either randomly, or based on response time from the node.
        </div></dd><dt><span class="term">Object Service</span></dt><dd><div class="para">
          The object service is responsible for storing data objects in partitions on disk devices. Each partition is a directory. Each object is held in a subdirectory of its partition directory. A MD5 hash of the path to the object is used to identify the object itself.
        </div></dd><dt><span class="term">Container Service</span></dt><dd><div class="para">
          The container service maintains databases of objects in containers. There is one database file for each container, and the database files are replicated across the cluster. Containers are defined when objects are put in them. Containers make finding objects faster by limiting object listings to specific container namespaces.
        </div></dd><dt><span class="term">Account Service</span></dt><dd><div class="para">
          The account service maintains databases of all of the containers accessible by any given account. There is one database file for each account, and the database files are replicated across the cluster. Any account has access to a particular group of containers. An account maps to a tenant in the Identity Service.
        </div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16765-541150+%5BLatest%5D&amp;cf_build_id=16765-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Services+that+Make+Up+the+Object+Storage+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Architecture_of_the_Object_Storage_Service"></a>10.2.&nbsp;Architecture of the Object Storage Service</h2></div></div></div><div class="para">
    The OpenStack Object Storage service is a modular group of services, including <span class="application"><strong>openstack-swift-proxy</strong></span>, <span class="application"><strong>openstack-swift-object</strong></span>, <span class="application"><strong>openstack-swift-container</strong></span>, and <span class="application"><strong>openstack-swift-account</strong></span>.
  </div><div class="para">
    All of the services can be installed on each node. Alternatively, services can be run on dedicated nodes.
  </div><div class="para">
    <div class="variablelist"><p class="title"><strong>Common Object Storage Service Deployment Configurations</strong></p><dl class="variablelist"><dt><span class="term">All services on all nodes.</span></dt><dd><div class="para">
            Simplest to set up.
          </div></dd><dt><span class="term">Dedicated proxy nodes, all other services combined on other nodes.</span></dt><dd><div class="para">
            The proxy service is CPU and I/O intensive. The other services are disk and I/O intensive. This configuration allows you to optimize your hardware usage.
          </div></dd><dt><span class="term">Dedicated proxy nodes, dedicated object service nodes, container and account services combined on other nodes.</span></dt><dd><div class="para">
            The proxy service is CPU and I/O intensive. The container and account services are more disk and I/O intensive than the object service. This configuration allows you to optimize your hardware usage even more.
          </div></dd></dl></div>

  </div><div class="para">
    The following diagram provides an overview of the third option, where the proxy and object nodes are split out from those containing the container and account nodes:
    <div class="figure"><a id="idm4587696"></a><div class="figure-contents"><div class="mediaobject" align="left"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2810.png" align="left" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;10.1.&nbsp;Service Architecture</strong></p></div><br class="figure-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16082-541150+%5BLatest%5D&amp;cf_build_id=16082-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Architecture+of+the+Object+Storage+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Object_Storage_Service_Requirements"></a>10.3.&nbsp;Object Storage Service Requirements</h2></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Supported Filesystems</span></dt><dd><div class="para">
          The Object Storage Service stores objects in filesystems. Currently, <code class="systemitem">XFS</code> and <code class="systemitem">ext4</code> are supported. The <code class="systemitem">ext4</code> filesystem is recommended.
        </div><div class="para">
          Your filesystem must be mounted with <code class="systemitem">xattr</code> enabled. For example, this is from <code class="systemitem">/etc/fstab</code>:
        </div><pre class="screen">
/dev/sdb1 /srv/node/d1  ext4  acl,user_xattr  0 0</pre></dd><dt><span class="term">Acceptable Mountpoints</span></dt><dd><div class="para">
          The Object Storage service expects devices to be mounted at <code class="literal">/srv/node/</code>.
        </div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15926-541150+%5BLatest%5D&amp;cf_build_id=15926-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Object+Storage+Service+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_the_Object_Storage_Service_Packages"></a>10.4.&nbsp;Installing the Object Storage Service Packages</h2></div></div></div><div class="para">
    The OpenStack Object Storage service is packaged in the following packages.
  </div><div class="para">
    <div class="variablelist"><p class="title"><strong>Primary OpenStack Object Storage packages</strong></p><dl class="variablelist"><dt><span class="term"><span class="package">openstack-swift-proxy</span></span></dt><dd><div class="para">
            Proxies requests for objects.
          </div></dd><dt><span class="term"><span class="package">openstack-swift-object</span></span></dt><dd><div class="para">
            Stores data objects of up to 5GB.
          </div></dd><dt><span class="term"><span class="package">openstack-swift-container</span></span></dt><dd><div class="para">
            Maintains a database that tracks all of the objects in each container.
          </div></dd><dt><span class="term"><span class="package">openstack-swift-account</span></span></dt><dd><div class="para">
            Maintains a database that tracks all of the containers in each account.
          </div></dd></dl></div>
     <div class="variablelist"><p class="title"><strong>OpenStack Object Storage dependencies</strong></p><dl class="variablelist"><dt><span class="term"><span class="package">openstack-swift</span></span></dt><dd><div class="para">
            Contains code common to the specific services.
          </div></dd><dt><span class="term"><span class="package">openstack-swift-plugin-swift3</span></span></dt><dd><div class="para">
            The swift3 plugin for OpenStack Object Storage.
          </div></dd><dt><span class="term"><span class="package">memcached</span></span></dt><dd><div class="para">
            Soft dependency of the proxy server, caches authenticated clients rather than making them reauthorize at every interaction.
          </div></dd><dt><span class="term"><span class="package">openstack-utils</span></span></dt><dd><div class="para">
            Provides utilities for configuring Openstack.
          </div></dd></dl></div>

  </div><div class="procedure"><a id="idp13271856"></a><p class="title"><strong>Procedure&nbsp;10.1.&nbsp;Installing the Object Storage Service Packages</strong></p><ul><li class="step"><div class="para">
        Install the required packages using the <code class="command">yum</code> command as the root user:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y openstack-swift-proxy \</code></code></strong>
        <strong class="userinput"><code><code class="command">openstack-swift-object \</code></code></strong>
        <strong class="userinput"><code><code class="command">openstack-swift-container \</code></code></strong>
        <strong class="userinput"><code><code class="command">openstack-swift-account \</code></code></strong>
        <strong class="userinput"><code><code class="command">openstack-utils \</code></code></strong>
        <strong class="userinput"><code><code class="command">memcached</code></code></strong></pre></li></ul></div><div class="para">
    The services that make up the OpenStack Object Storage service are installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16081-541150+%5BLatest%5D&amp;cf_build_id=16081-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Object+Storage+Service+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuring_the_Object_Storage_Service"></a>10.5.&nbsp;Configuring the Object Storage Service</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuraing_Keystone_for_the_Object_Storage_Service"></a>10.5.1.&nbsp;Configuring the Identity Service to work with the Object Storage Service</h3></div></div></div><div class="itemizedlist prereqs-list"><p class="title"><strong>Prerequisites:</strong></p><ul class="prereqs-list prereqs-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Creating_Roles1">Section&nbsp;9.7, “Creating an Administrator Account”</a>
      </div></li></ul></div><div class="para">
    In this procedure, you will:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Create the <code class="literal">swift</code> user, who has the <code class="systemitem">admin</code> role in the <code class="systemitem">services</code> tenant.
        </div></li><li class="listitem"><div class="para">
          Create the <code class="systemitem">swift</code> service entry and assign it an endpoint.
        </div></li></ol></div>

  </div><div class="para">
    This procedure can be performed from your Identity Service server or on any machine where you've copied the <code class="filename">keystonerc_admin</code> file (which contains administrator credentials) and the <span class="application"><strong>keystone</strong></span> command-line utility is installed.
  </div><div class="procedure"><a id="idp6180144"></a><p class="title"><strong>Procedure&nbsp;10.2.&nbsp;Configuring the Identity Service to work with the Object Storage Service</strong></p><ol class="1"><li class="step"><div class="para">
        Set up the shell to access Keystone as the admin user:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>source ~/keystonerc_admin</code></strong></pre></li><li class="step"><div class="para">
        Create the <code class="systemitem">swift</code> user and set its password by replacing <em class="replaceable"><code>PASSWORD</code></em> with your chosen password:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone user-create --name swift --pass <em class="replaceable"><code>PASSWORD</code></em></code></strong></pre><div class="para">
        Note the create user's ID as it will be used in subsequent steps.
      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="systemitem">admin</code> role:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone role-list | grep admin</code></strong></pre><div class="para">
        If no <code class="systemitem">admin</code> role exists, create one:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone role-create --name admin</code></strong></pre></li><li class="step"><div class="para">
        Get the ID of the <code class="systemitem">services</code> tenant:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-list | grep services</code></strong></pre><div class="para">
        If no <code class="systemitem">services</code> tenant exists, create one:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-create --name services --description &quot;Services Tenant&quot; </code></strong></pre><div class="para">
        This guide uses one tenant for all service users. For more information, refer to <em class="citetitle">Creating the Services Tenant</em>.
      </div></li><li class="step"><div class="para">
        Add the <code class="systemitem">swift</code> user to the <code class="systemitem">services</code> tenant with the <code class="systemitem">admin</code> role:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone user-role-add --role-id <em class="replaceable"><code>ROLEID</code></em> --tenant-id <em class="replaceable"><code>TENANTID</code></em> --user-id <em class="replaceable"><code>USERID</code></em></code></strong></pre><div class="para">
        Replace the user, role, and tenant IDs with those obtained in the previous steps.
      </div></li><li class="step"><div class="para">
        Create the <code class="systemitem">swift</code> Object Storage service entry:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone service-create --name swift --type object-store \</code></strong>
    <strong class="userinput"><code>--description &quot;Swift Storage Service&quot;</code></strong></pre><div class="para">
        Note the create service's ID as it will be used in the next step.
      </div></li><li class="step"><div class="para">
        Create the <code class="systemitem">swift</code> endpoint entry:
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>keystone endpoint-create --service_id <em class="replaceable"><code>SERVICEID</code></em> \</code></strong>
    <strong class="userinput"><code>--publicurl &quot;http://<em class="replaceable"><code>IP</code></em>:8080/v1/AUTH_\$(tenant_id)s&quot; \</code></strong>
    <strong class="userinput"><code>--adminurl &quot;http://<em class="replaceable"><code>IP</code></em>:8080/v1&quot; \</code></strong>
    <strong class="userinput"><code>--internalurl &quot;http://<em class="replaceable"><code>IP</code></em>:8080/v1/AUTH_\$(tenant_id)s&quot;</code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>SERVICEID</code></em> with the identifier returned by the <code class="systemitem">keystone service-create</code> command. Replace <em class="replaceable"><code>IP</code></em> with the IP address of fully qualified domain name of the system hosting the Object Storage Proxy service.
      </div></li></ol></div><div class="para">
    You have configured the Identity Service to work with the Object Storage Service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16782-541150+%5BLatest%5D&amp;cf_build_id=16782-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Identity+Service+to+work+with+the+Object+Storage+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Object_Storage_Service_Storage_Nodes"></a>10.5.2.&nbsp;Configuring the Object Storage Service Storage Nodes</h3></div></div></div><div class="para">
    The Object Storage Service stores objects on the filesystem, usually on a number of connected physical storage devices. All of the devices which will be used for object storage must be formatted <code class="systemitem">ext4</code> or <code class="systemitem">XFS</code>, and mounted under the <code class="systemitem">/srv/node/</code> directory. All of the services that will run on a given node must be enabled, and their ports opened.
  </div><div class="para">
    While you can run the proxy service alongside the other services, the proxy service is not covered in this procedure.
  </div><div class="procedure"><a id="idp10175792"></a><p class="title"><strong>Procedure&nbsp;10.3.&nbsp;Configuring the Object Storage Service Storage Nodes</strong></p><ol class="1"><li class="step"><div class="para">
        Format your devices using the <code class="systemitem">ext4</code> or <code class="systemitem">XFS</code> filesystem. Make sure that <code class="systemitem">xattr</code>s are enabled.
      </div></li><li class="step"><div class="para">
        Add your devices to the <code class="literal">/etc/fstab</code> file to ensure that they are mounted under <code class="literal">/srv/node/</code> at boot time.
      </div><div class="para">
        Use the <code class="command">blkid</code> command to find your device's unique ID, and mount the device using its unique ID.
      </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          If using <code class="systemitem">ext4</code>, ensure that extended attributes are enabled by mounting the filesystem with the <code class="systemitem">user_xattr</code> option. (In <code class="systemitem">XFS</code>, extended attributes are enabled by default.)
        </div></div></div></li><li class="step"><div class="para">
        Configure the firewall to open the TCP ports used by each service running on each node
      </div><div class="para">
        By default, the account service uses port 6002, the container service uses port 6001, and the object service uses port 6000.
      </div><ol class="a"><li class="step"><div class="para">
            Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
          </div></li><li class="step"><div class="para">
            Add an <code class="literal">INPUT</code> rule allowing TCP traffic on the ports used by the account, service, and object service. The new rule must appear before any <code class="literal">reject-with icmp-host-prohibited</code> rule.
          </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 6000,6001,6002,873 -j ACCEPT</pre></li><li class="step"><div class="para">
            Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
          </div></li><li class="step"><div class="para">
            Restart the <code class="systemitem">iptables</code> service for the firewall changes to take effect.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></li><li class="step"><div class="para">
        Change the owner of the contents of <code class="systemitem">/srv/node/</code> to <code class="literal">swift:swift</code> with the <code class="command">chown</code> command.
      </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>chown -R swift:swift /srv/node/</code></strong></pre></li><li class="step"><div class="para">
        Set the <code class="systemitem">SELinux</code> context correctly for all directories under <code class="systemitem">/srv/node/</code> with the <code class="command">restorcon</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">restorecon -R /srv</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> command to add a hash prefix (swift_hash_path_prefix) to your <code class="filename">/etc/swift.conf</code>:
      </div><pre class="screen">
# openstack-config --set /etc/swift/swift.conf swift-hash swift_hash_path_prefix \
              $(openssl rand -hex 10)
</pre></li><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> command to add a hash suffix (swift_hash_path_suffix) to your <code class="filename">/etc/swift.conf</code>:
      </div><pre class="screen">
# openstack-config --set /etc/swift/swift.conf swift-hash swift_hash_path_suffix \
              $(openssl rand -hex 10)
</pre><div class="para">
        These details are required for finding and placing data on all of your nodes. Back <code class="filename">/etc/swift.conf</code> up.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> command to set the IP address your storage services will listen on. Run these commands for every service on every node in your Object Storage cluster.
      </div><pre class="screen">
# openstack-config --set /etc/swift/object-server.conf DEFAULT bind_ip <em class="replaceable"><code>node_ip_address</code></em>
# openstack-config --set /etc/swift/account-server.conf DEFAULT bind_ip <em class="replaceable"><code>node_ip_address</code></em>
# openstack-config --set /etc/swift/container-server.conf DEFAULT bind_ip <em class="replaceable"><code>node_ip_address</code></em></pre><div class="para">
        The <code class="literal">DEFAULT</code> argument specifies the DEFAULT section of the service configuration file. Replace <em class="replaceable"><code>node_ip_address</code></em> with the IP address of the node you are configuring.
      </div></li><li class="step"><div class="para">
        Copy <code class="filename">/etc/swift.conf</code> from the node you are currently configuring, to all of your Object Storage Service nodes.
      </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          The <code class="filename">/etc/swift.conf</code> file must be identical on all of your Object Storage Service nodes.
        </div></div></div></li><li class="step"><div class="para">
        Start the services which will run on your node.
      </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>service openstack-swift-account start</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service openstack-swift-container start</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service openstack-swift-object start</code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chkconfig</code> command to make sure the services automatically start at boot time.
      </div><pre class="screen">

<code class="prompt">#</code> <strong class="userinput"><code>chkconfig openstack-swift-account on</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chkconfig openstack-swift-container on</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chkconfig openstack-swift-object on</code></strong></pre></li></ol></div><div class="para">
    All of the devices that your node will provide as object storage are formatted and mounted under <code class="literal">/srv/node/</code>. Any service running on the node has been enabled, and any ports used by services on the node have been opened.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16783-555732+%5BLatest%5D&amp;cf_build_id=16783-555732+14+Nov+2013+11%3A08+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Object+Storage+Service+Storage+Nodes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Object_Storage_Service_Proxy_Service"></a>10.5.3.&nbsp;Configuring the Object Storage Service Proxy Service</h3></div></div></div><div class="para">
    The Object Storage proxy service determines to which node <code class="systemitem">gets</code> and <code class="systemitem">puts</code> are directed.
  </div><div class="para">
    Although you can run the account, container, and object services alongside the proxy service, only the proxy service is covered in the following procedure.
  </div><div class="procedure"><a id="idp5940672"></a><p class="title"><strong>Procedure&nbsp;10.4.&nbsp;Configuring the Object Storage Service Proxy Service</strong></p><ol class="1"><li class="step"><div class="para">
        Update the configuration file for the proxy server with the correct authentication details for the appropriate service user:
      </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/swift/proxy-server.conf \</code></strong>
      <strong class="userinput"><code>filter:authtoken auth_host <em class="replaceable"><code>IP</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/swift/proxy-server.conf \</code></strong>
      <strong class="userinput"><code>filter:authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/swift/proxy-server.conf \</code></strong>
      <strong class="userinput"><code>filter:authtoken admin_user <em class="replaceable"><code>swift</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/swift/proxy-server.conf \</code></strong>
      <strong class="userinput"><code>filter:authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></strong></pre><div class="para">
        Where:
        <div class="itemizedlist"><ul><li class="listitem"><div class="para">
              <em class="replaceable"><code>IP</code></em> - The IP address or host name of the Identity server.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>services</code></em> - The name of the tenant that was created for the use of the Object Storage service (previous examples set this to <code class="systemitem">services</code>).
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>swift</code></em> - The name of the service user that was created for the Object Storage service (previous examples set this to <code class="systemitem">swift</code>).
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>PASSWORD</code></em> - The password associated with the service user.
            </div></li></ul></div>

      </div></li><li class="step"><div class="para">
        Start the <code class="systemitem">memcached</code> and <code class="systemitem">openstack-swift-proxy</code> services using the <code class="command">service</code> command:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service memcached start</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service openstack-swift-proxy start</code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chown</code> command to change the ownership of the keystone signing directory:
      </div><pre class="screen"># chown swift:swift /tmp/keystone-signing-swift</pre></li><li class="step"><div class="para">
        Enable the <code class="systemitem">memcached</code> and <code class="systemitem">openstack-swift-proxy</code> services permanently using the <code class="command">chkconfig</code> command:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chkconfig memcached on</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chkconfig openstack-swift-proxy on</code></strong></pre></li><li class="step"><div class="para">
        Allow incoming connections to the Swift proxy server by adding this firewall rule to the <code class="filename">/etc/sysconfig/iptables</code> configuration file:
      </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 8080 -j ACCEPT</pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          This rule allows communication from all remote hosts to the system hosting the Swift proxy on port <code class="literal">8080</code>. For information regarding the creation of more restrictive firewall rules refer to the Red Hat Enterprise Linux&nbsp;6 <em class="citetitle">Security Guide</em>.
        </div></div></div></li><li class="step"><div class="para">
        Use the <code class="command">service</code> command to restart the <code class="systemitem">iptables</code> service for the new rule to take effect:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables save</code></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    The Object Storage Service proxy service is now listening for HTTP put and get requests on port 8080, and directing them to the appropriate nodes.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16781-541150+%5BLatest%5D&amp;cf_build_id=16781-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Object+Storage+Service+Proxy+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Object_Storage_Service_Ring_Files"></a>10.5.4.&nbsp;Object Storage Service Rings</h3></div></div></div><div class="para">
    Rings determine where data is stored in a cluster of storage nodes. Ring files are generated using the <span class="application"><strong>swift-ring-builder</strong></span> tool. Three ring files are required, one each for the <span class="application"><strong>object</strong></span>, <span class="application"><strong>container</strong></span>, and <span class="application"><strong>account</strong></span> services.
  </div><div class="para">
    Each storage device in a cluster is divided into partitions, with a recommended minimum of 100 partitions per device. Each partition is physically a directory on disk.
  </div><div class="para">
    A configurable number of bits from the MD5 hash of the filesystem path to the partition directory, known as the <span class="emphasis"><em>partition power</em></span>, is used as a partition index for the device. The <span class="emphasis"><em>partition count</em></span> of a cluster that has 1000 devices, where each device has 100 partitions on it, is 100 000.
  </div><div class="para">
    The partition count is used to calculate the partition power, where 2 to the partition power is the partition count. When the partition power is a fraction, it is rounded up. If the partition count is 100 000, the part power is 17 (16.610 rounded up).
  </div><div class="para">
    Expressed mathematically: 2 ^ partition power = partition count.
  </div><div class="para">
    Ring files are generated using 3 parameters: partition power, replica count, and the amount of time that must pass between partition reassignments.
  </div><div class="para">
    A fourth parameter, zone, is used when adding devices to rings. Zones are a flexible abstraction, where each zone should be as separated from other zones as possible in your specific. You can use a zone to represent sites, cabinets, nodes, or even devices.
  </div><div class="table"><a id="idp46452368"></a><p class="title"><strong>Table&nbsp;10.1.&nbsp;Parameters used when building ring files</strong></p><div class="table-contents"><table summary="Parameters used when building ring files"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            Ring File Parameter
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              Partition power
            </div>

          </td><td class="">
            <div class="para">
              2 ^ partition power = partition count.
            </div>
             <div class="para">
              The partition is rounded up after calculation.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              Replica count
            </div>

          </td><td class="">
            <div class="para">
              The number of times that your data will be replicated in the cluster.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              min_part_hours
            </div>

          </td><td class="">
            <div class="para">
              Minimum number of hours before a partition can be moved. This parameter increases availability of data by not moving more than one copy of a given data item within that min_part_hours amount of time.
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16080-541150+%5BLatest%5D&amp;cf_build_id=16080-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Object+Storage+Service+Rings%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Building_Object_Storage_Ring_Files"></a>10.5.5.&nbsp;Building Object Storage Service Ring Files</h3></div></div></div><div class="para">
    Three ring files need to be created: one to track the objects stored by the Object Storage Service, one to track the containers that objects are placed in, and one to track which accounts can access which containers. The ring files are used to deduce where a particular piece of data is stored.
  </div><div class="procedure"><a id="idp5023256"></a><p class="title"><strong>Procedure&nbsp;10.5.&nbsp;Building Object Storage Service Ring Files</strong></p><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">swift-ring-builder</code> command to build one ring for each service. Provide a builder file, a <em class="replaceable"><code>partition power</code></em>, a <em class="replaceable"><code>replica count</code></em>, and the <em class="replaceable"><code>minimum hours between partition re-assignment</code></em>:
      </div><div class="para">

<pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/object.builder create <em class="replaceable"><code>part_power</code></em> <em class="replaceable"><code>replica_count</code></em> <em class="replaceable"><code>min_part_hours</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/container.builder create <em class="replaceable"><code>part_power</code></em> <em class="replaceable"><code>replica_count</code></em> <em class="replaceable"><code>min_part_hours</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/account.builder create <em class="replaceable"><code>part_power</code></em> <em class="replaceable"><code>replica_count</code></em> <em class="replaceable"><code>min_part_hours</code></em></code></strong></pre>

      </div></li><li class="step"><div class="para">
        When the rings are created, add storage devices to each ring:
      </div><ol class="a"><li class="step"><div class="para">
            Add devices to the accounts ring. Repeat for each device on each node in the cluster that you want added to the ring.
          </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/account.builder add z<em class="replaceable"><code>X</code></em>-127.0.0.1:6002/<em class="replaceable"><code>device_mountpoint</code></em> <em class="replaceable"><code>partition_count</code></em></code></strong></pre><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                Specify a zone with <span class="emphasis"><em>z<em class="replaceable"><code>X</code></em></em></span>, where <em class="replaceable"><code>X</code></em> is an integer (for example, <span class="emphasis"><em>z1</em></span> for zone one).
              </div></li><li class="listitem"><div class="para">
                By default, all three services (account, container, and object) listen on the 127.0.0.1 address, and the above command matches this default.
              </div><div class="para">
                However, the service's machine IP address can also be used (for example, to handle distributed services). If you do use a real IP, remember to change the service's bind address to the same IP address or to '0.0.0.0' (configured in the <code class="systemitem">/etc/swift/<em class="replaceable"><code>service</code></em>-server.conf</code> file).
              </div></li><li class="listitem"><div class="para">
                TCP port 6002 is the default port that the account server uses.
              </div></li><li class="listitem"><div class="para">
                The <em class="replaceable"><code>device_mountpoint</code></em> is the directory under <code class="literal">/srv/node/</code> that your device is mounted at.
              </div></li><li class="listitem"><div class="para">
                The recommended minimum number for <em class="replaceable"><code>partition_count</code></em> is 100, use the partition count you used to calculate your partition power.
              </div></li></ul></div></li><li class="step"><div class="para">
            Add devices to the containers ring. Repeat for each device on each node in the cluster that you want added to the ring.
          </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/container.builder add z<em class="replaceable"><code>X</code></em>-127.0.0.1:6001/<em class="replaceable"><code>device_mountpoint</code></em> <em class="replaceable"><code>partition_count</code></em></code></strong></pre><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                TCP port 6001 is the default port that the container server uses.
              </div></li></ul></div></li><li class="step"><div class="para">
            Add devices to the objects ring. Repeat for each device on each node in the cluster that you want added to the ring.
          </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/object.builder add z<em class="replaceable"><code>X</code></em>-127.0.0.1:6000/<em class="replaceable"><code>device_mountpoint</code></em> <em class="replaceable"><code>partition_count</code></em></code></strong></pre><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                TCP port 6000 is the default port that the object server uses.
              </div></li></ul></div></li></ol></li><li class="step"><div class="para">
        Distribute the partitions across the devices in the ring using the <code class="command">swift-ring-builder</code> command's <code class="command">rebalance</code> argument.
      </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/account.builder rebalance</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/container.builder rebalance</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>swift-ring-builder /etc/swift/object.builder rebalance</code></strong></pre></li><li class="step"><div class="para">
        Check to see that you now have 3 ring files in the directory <code class="filename">/etc/swift</code>. The command:
      </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>ls /etc/swift/*gz </code></strong></pre><div class="para">
        should reveal:
      </div><pre class="screen">/etc/swift/account.ring.gz  /etc/swift/container.ring.gz  /etc/swift/object.ring.gz
</pre></li><li class="step"><div class="para">
        Ensure that all files in the <code class="filename">/etc/swift/</code> directory including those that you have just created are owned by the <code class="systemitem">root</code> user and <code class="systemitem">swift</code> group.
        <div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
            All mount points must be owned by <code class="systemitem">root</code>; all roots of mounted file systems must be owned by <code class="systemitem">swift</code>. Before running the following command, ensure that all devices are already mounted and owned by <code class="systemitem">root</code>.
          </div></div></div>

      </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>chown -R root:swift /etc/swift</code></strong></pre></li><li class="step"><div class="para">
        Copy each ring builder file to each node in the cluster, storing them under <code class="literal">/etc/swift/</code>.
      </div><pre class="screen">
# scp /etc/swift/*.gz <em class="replaceable"><code>node_ip_address</code></em>:/etc/swift</pre></li></ol></div><div class="para">
    You have created rings for each of the services that require them. You have used the builder files to distribute partitions across the nodes in your cluster, and have copied the ring builder files themselves to each node in the cluster.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16079-541150+%5BLatest%5D&amp;cf_build_id=16079-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Building+Object+Storage+Service+Ring+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Validating_the_Object_Storage_Service_Installation"></a>10.6.&nbsp;Validating the Object Storage Service Installation</h2></div></div></div><div class="formalpara"><div class="title">Summary</div>
      You've finished installing and configuring the Openstack Object Service. You want to make sure it is working.
    </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        On your proxy server node, use the <code class="command">openstack-config</code> command to turn on debug level logging:
      </div><pre class="screen">
# openstack-config --set /etc/swift/proxy-server.conf DEFAULT log_level debug</pre></li><li class="step"><div class="para">
        Set up the shell to access Keystone as a user that has the admin role. The admin user is shown in this example:
      </div><div class="para">
        Use the <code class="command">swift</code> list to make sure you can connect to your proxy server:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>swift list</code></strong>
      Message from syslogd@thildred-swift-01 at Jun 14 02:46:00 ...
 �135 proxy-server Server reports support for api versions: v3.0, v2.0
</pre></li><li class="step"><div class="para">
        Use the <code class="command">swift</code> command to upload some files to your Object Storage Service nodes
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>head -c 1024 /dev/urandom &gt; data1.file ; swift upload c1 data1.file</code></strong>
<code class="prompt">$</code> <strong class="userinput"><code>head -c 1024 /dev/urandom &gt; data2.file ; swift upload c1 data2.file</code></strong>
<code class="prompt">$</code> <strong class="userinput"><code>head -c 1024 /dev/urandom &gt; data3.file ; swift upload c1 data3.file</code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">swift</code> command to take a listing of the objects held in your Object Storage Service cluster.
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>swift list</code></strong>
<code class="prompt">$</code> <strong class="userinput"><code>swift list c1</code></strong>
data1.file
data2.file
data3.file
</pre></li></ol></div><div class="formalpara"><div class="title">Result</div>
      You have now uploaded 3 files into 1 container. If you look in the various storage devices you see more <code class="filename">.data</code> files, based on your replica count.
    </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>find /srv/node/ -type f -name &quot;*data&quot;</code></strong></pre><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15879-541150+%5BLatest%5D&amp;cf_build_id=15879-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Validating+the+Object+Storage+Service+Installation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_OpenStack_Image_Service"></a>Chapter&nbsp;11.&nbsp;Installing the OpenStack Image Service</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Image_Storage_Service_Requirements">11.1. Image Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Image_Storage_Service_Packages">11.2. Installing the Image Service Packages</a></span></dt><dt><span class="section"><a href="#Creating_the_Image_Storage_Database">11.3. Creating the Image Service Database</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Image_Service">11.4. Configuring the Image Service</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_the_Backing_Storage">11.4.1. Configuration Overview</a></span></dt><dt><span class="section"><a href="#Creating_the_Image_Storage_Service_Endpoint">11.4.2. Creating the Image Identity Records</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String5">11.4.3. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String2">11.4.4. Configuring the Use of the Identity Service</a></span></dt><dt><span class="section"><a href="#Using_the_Object_Storage_Service_for_Image_Storage">11.4.5. Using the Object Storage Service for Image Storage</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall">11.4.6. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Image_Storage_Database">11.4.7. Populating the Image Service Database</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Image_Storage_Services">11.5. Starting the Image API and Registry Services</a></span></dt><dt><span class="section"><a href="#sect-Validating_the_Image_Service_Installation">11.6. Validating the Image Service Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#Obtaining_a_Disk_Image_from_Red_Hat_Network">11.6.1. Obtaining a Test Disk Image</a></span></dt><dt><span class="section"><a href="#Building_a_Custom_Disk_Image">11.6.2. Building a Custom Virtual Machine Image</a></span></dt><dt><span class="section"><a href="#Uploading_a_Disk_Image1">11.6.3. Uploading a Disk Image</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Image_Storage_Service_Requirements"></a>11.1.&nbsp;Image Service Requirements</h2></div></div></div><div class="para">
    To install the Image service, you must have access to:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          MySQL database server root credentials and IP address
        </div></li><li class="listitem"><div class="para">
          Identity service administrator credentials and endpoint URL
        </div></li></ul></div>

  </div><div class="para">
    If using the OpenStack Object storage service as the storage backend, you will also need to know the service's endpoint public URL.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      For software and hardware requirements, refer to the <em class="citetitle">Prerequisites</em> chapter.
    </div></div></div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Prerequisites">Chapter&nbsp;2, <em>Prerequisites</em></a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15894-541150+%5BLatest%5D&amp;cf_build_id=15894-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Image+Service+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_the_Image_Storage_Service_Packages"></a>11.2.&nbsp;Installing the Image Service Packages</h2></div></div></div><div class="para">
    The OpenStack Image service requires the following packages:
  </div><div class="para">
    <div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">openstack-glance</span></span></dt><dd><div class="para">
            Provides the OpenStack Image service.
          </div></dd><dt><span class="term"><span class="package">openstack-utils</span></span></dt><dd><div class="para">
            Provides supporting utilities to assist with a number of tasks including the editing of configuration files.
          </div></dd><dt><span class="term"><span class="package">openstack-selinux</span></span></dt><dd><div class="para">
            Provides OpenStack specific SELinux policy modules.
          </div></dd></dl></div>

  </div><div class="para">
    To install all of the above packages, execute the following command while logged in as the <code class="systemitem">root</code> user.
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y openstack-glance openstack-utils openstack-selinux</code></code></strong></pre>

  </div><div class="para">
    The OpenStack Image service is now installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15849-541150+%5BLatest%5D&amp;cf_build_id=15849-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Image+Service+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_the_Image_Storage_Database"></a>11.3.&nbsp;Creating the Image Service Database</h2></div></div></div><div class="para">
    In this procedure, the database and database user that will be used by the Image service will be created. These steps must be performed while logged in to the database server as the <code class="systemitem">root</code> user (or as a user with suitable access: <code class="systemitem">create db</code>, <code class="systemitem">create user</code>, <code class="systemitem">grant permissions</code>).
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Connect to the database service using the <code class="command">mysql</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">mysql -u root -p</code></code></strong></pre></li><li class="step"><div class="para">
        Create the <code class="literal">glance</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> CREATE DATABASE glance;</pre></li><li class="step"><div class="para">
        Create a <code class="literal">glance</code> database user and grant it access to the <code class="literal">glance</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON glance.* TO 'glance'@'%' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';
<code class="prompt">mysql&gt;</code> GRANT ALL ON glance.* TO 'glance'@'localhost' IDENTIFIED BY 'PASSWORD';</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used to authenticate with the database server as this user.
      </div></li><li class="step"><div class="para">
        Flush the database privileges to ensure that they take effect immediately.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> FLUSH PRIVILEGES;</pre></li><li class="step"><div class="para">
        Exit the <code class="command">mysql</code> client.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> quit</pre></li></ol></div><div class="para">
    The Image Storage database has been created. The database will be populated during service configuration.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15852-541150+%5BLatest%5D&amp;cf_build_id=15852-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Image+Service+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuring_the_Image_Service"></a>11.4.&nbsp;Configuring the Image Service</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Backing_Storage"></a>11.4.1.&nbsp;Configuration Overview</h3></div></div></div><div class="para">
    To configure the Image service, the following must be completed:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Configure TLS/SSL.
        </div></li><li class="listitem"><div class="para">
          Configure the Identity service for Image service authentication (create database entries, set connection strings, and update configuration files).
        </div></li><li class="listitem"><div class="para">
          Configure the disk-image storage backend (this guide uses the Object Storage service).
        </div></li><li class="listitem"><div class="para">
          Configure the firewall for Image service access.
        </div></li><li class="listitem"><div class="para">
          Populate the Image service database.
        </div></li></ul></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15886-541150+%5BLatest%5D&amp;cf_build_id=15886-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuration+Overview%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_the_Image_Storage_Service_Endpoint"></a>11.4.2.&nbsp;Creating the Image Identity Records</h3></div></div></div><div class="para">
    The steps outlined in this procedure cover the creation of these identity records to support the Image service:
  </div><div class="orderedlist"><ol><li class="listitem"><div class="para">
        Create the <code class="systemitem">glance</code>, who has the <code class="systemitem">admin</code> role in the <code class="systemitem">services</code> tenant.
      </div></li><li class="listitem"><div class="para">
        Create the <code class="systemitem">glance</code> service entry and assign it an endpoint.
      </div></li></ol></div><div class="para">
    These entries assist other OpenStack services attempting to locate and access the volume functionality provided by the Image service.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Authenticate as the administrator of the identity service by running the <code class="command">source</code> command on the <code class="filename">keystonerc_admin</code> file containing the required credentials:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Create a user named <code class="literal">glance</code> for the Image service to use:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-create --name glance --pass <em class="replaceable"><code>PASSWORD</code></em></code></code></strong>
+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|  email   |                                  |
| enabled  |               True               |
|    id    | <em class="replaceable"><code>8091eaf121b641bf84ce73c49269d2d1</code></em> |
|   name   |              glance              |
| tenantId |                                  |
+----------+----------------------------------+
</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used by the image storage service when authenticating with the identity service. Take note of the returned user ID (used in subsequent steps).
      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="literal">admin</code> role:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone role-get admin</code></code></strong></pre><div class="para">
        If no <code class="systemitem">admin</code> role exists, create one:
<pre class="screen">$ keystone role-create --name admin</pre>

      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="systemitem">services</code> tenant:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-list | grep services</code></strong></pre><div class="para">
        If no <code class="systemitem">services</code> tenant exists, create one:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-create --name services --description &quot;Services Tenant&quot; </code></strong></pre><div class="para">
        This guide uses one tenant for all service users. For more information, refer to <em class="citetitle">Creating the Services Tenant</em>.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone user-role-add</code> command to link the <code class="literal">glance</code> user and the <code class="literal">admin</code> role together within the context of the <code class="literal">services</code> tenant:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-role-add --user-id <em class="replaceable"><code>USERID</code></em> --role-id <em class="replaceable"><code>ROLEID</code></em> --tenant-id <em class="replaceable"><code>TENANTID</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Create the <code class="literal">glance</code> service entry:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone service-create --name glance \</code></code></strong>
        <strong class="userinput"><code><code class="command">--type image \</code></code></strong>
        <strong class="userinput"><code><code class="command">--description &quot;Glance Image Service&quot;</code></code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |       Glance Image Service       |
|      id     | <em class="replaceable"><code>7461b83f96bd497d852fb1b85d7037be</code></em> |
|     name    |              glance              |
|     type    |               image              |
+-------------+----------------------------------+</pre><div class="para">
        Take note of the service's returned ID (used in the next step).
      </div></li><li class="step"><div class="para">
        Create the <code class="literal">glance</code> endpoint entry:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone endpoint-create --service-id <em class="replaceable"><code>SERVICEID</code></em> \</code></code></strong>
        <strong class="userinput"><code><code class="command">--publicurl &quot;http://<em class="parameter"><code>IP</code></em>:9292&quot; \</code></code></strong>
        <strong class="userinput"><code><code class="command">--adminurl &quot;http://<em class="parameter"><code>IP</code></em>:9292&quot; \</code></code></strong>
        <strong class="userinput"><code><code class="command">--internalurl &quot;http://<em class="parameter"><code>IP</code></em>:9292&quot;</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>SERVICEID</code></em> with the identifier returned by the <code class="command">keystone service-create</code> command. Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the system hosting the Image service.
      </div></li></ol></div><div class="para">
    All supporting identity service entries required by the Image service have been created.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15910-541150+%5BLatest%5D&amp;cf_build_id=15910-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Image+Identity+Records%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Setting_the_Database_Connection_String5"></a>11.4.3.&nbsp;Setting the Database Connection String</h3></div></div></div><div class="para">
    The database connection string used by the Image service is defined in the <code class="filename">/etc/glance/glance-api.conf</code> and <code class="filename">/etc/glance/glance-registry.conf</code> files. It must be updated to point to a valid database server before starting the service.
  </div><div class="para">
    All commands in this procedure must be run while logged in as the <code class="systemitem">root</code> user on the server hosting the Image service.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> command to set the value of the <code class="literal">sql_connection</code> configuration key in the <code class="filename">/etc/glance/glance.conf</code> file.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/glance/glance-api.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT sql_connection mysql://<em class="replaceable"><code>USER</code></em>:<em class="replaceable"><code>PASS</code></em>@<em class="replaceable"><code>IP</code></em>/<em class="replaceable"><code>DB</code></em></code></code></strong></pre><div class="para">
        Replace:
        <div class="itemizedlist"><ul><li class="listitem"><div class="para">
              <em class="replaceable"><code>USER</code></em> with the database user name the Image service is to use, usually <code class="literal">glance</code>.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>PASS</code></em> with the password of the chosen database user.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>IP</code></em> with the IP address or host name of the database server.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>DB</code></em> with the name of the database that has been created for use by the identity service, usually <code class="literal">glance</code>.
            </div></li></ul></div>

      </div></li><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> command to set the value of the <code class="literal">sql_connection</code> configuration key in the <code class="filename">/etc/glance/glance-registry.conf</code> file.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/glance/glance-registry.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT sql_connection mysql://<em class="replaceable"><code>USER</code></em>:<em class="replaceable"><code>PASS</code></em>@<em class="replaceable"><code>IP</code></em>/<em class="replaceable"><code>DB</code></em></code></code></strong></pre><div class="para">
        Replace the placeholder values <em class="replaceable"><code>USER</code></em>, <em class="replaceable"><code>PASS</code></em>, <em class="replaceable"><code>IP</code></em>, and <em class="replaceable"><code>DB</code></em> with the same values used in the previous step.
      </div></li></ol></div><div class="para">
    The database connection string has been set and will be used by the Image service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16049-541150+%5BLatest%5D&amp;cf_build_id=16049-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Database+Connection+String%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Setting_the_Database_Connection_String2"></a>11.4.4.&nbsp;Configuring the Use of the Identity Service</h3></div></div></div><div class="para">
    To update the Image configuration files for Identity usage, execute the following commands as the <code class="systemitem">root</code> user on each node hosting the Image service:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Configure the <code class="systemitem">glance-api</code> service:
      </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \</code></strong>
   <strong class="userinput"><code>paste_deploy flavor keystone</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken auth_host <em class="replaceable"><code>IP</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken auth_port 35357</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken auth_protocol http</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken admin_user <em class="replaceable"><code>glance</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></strong></pre></li><li class="step"><div class="para">
        Configure the <code class="systemitem">glance-registry</code> service:
      </div><pre class="screen">
    <code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-registry.conf \</code></strong>
   <strong class="userinput"><code>paste_deploy flavor keystone</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-registry.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken auth_host <em class="replaceable"><code>IP</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-registry.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken auth_port 35357</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-registry.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken auth_protocol http</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-registry.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-registry.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken admin_user <em class="replaceable"><code>glance</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-registry.conf \</code></strong>
   <strong class="userinput"><code>keystone_authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></strong></pre></li></ol></div><div class="para">
    where:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          <em class="replaceable"><code>IP</code></em> - The IP address or host name of the Identity server.
        </div></li><li class="listitem"><div class="para">
          <em class="replaceable"><code>services</code></em> - The name of the tenant that was created for the use of the Image service (previous examples set this to <code class="systemitem">services</code>).
        </div></li><li class="listitem"><div class="para">
          <em class="replaceable"><code>glance</code></em> - The name of the service user that was created for the Image service (previous examples set this to <code class="systemitem">glance</code>).
        </div></li><li class="listitem"><div class="para">
          <em class="replaceable"><code>PASSWORD</code></em> - The password associated with the service user.
        </div></li></ul></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16014-541150+%5BLatest%5D&amp;cf_build_id=16014-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Use+of+the+Identity+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Using_the_Object_Storage_Service_for_Image_Storage"></a>11.4.5.&nbsp;Using the Object Storage Service for Image Storage</h3></div></div></div><div class="para">
    By default, the Image service uses the local file system (<code class="literal">file</code>) for its storage backend. However, either of the following storage backends can be used to store uploaded disk images:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          <code class="systemitem">file</code> - Local file system of the Image server (<code class="filename">/var/lib/glance/images/</code> directory)
        </div></li><li class="listitem"><div class="para">
          <code class="systemitem">swift</code> - OpenStack Object Storage service
        </div></li></ul></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      The configuration procedure below uses the <code class="systemitem">openstack-config</code> command. However, the <code class="systemitem">/etc/glance/glance-api.conf</code> file can also be manually updated. If manually updating the file:
      <div class="orderedlist"><ol><li class="listitem"><div class="para">
            Ensure that the <code class="systemitem">default_store</code> parameter is set to the correct backend (for example, '<code class="systemitem">default_store=rbd</code>').
          </div></li><li class="listitem"><div class="para">
            Update the parameters in that backend's section (for example, under '<code class="systemitem">RBD Store Options</code>').
          </div></li></ol></div>

    </div></div></div><div class="para">
    To change the configuration to use the Object Storage service, execute the following steps as the <code class="systemitem">root</code> user:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Set the <code class="literal">default_store</code> configuration key to <code class="literal">swift</code>:
        </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/glance/glance-api.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT default_store swift</code></code></strong></pre></li><li class="listitem"><div class="para">
          Set the <code class="literal">swift_store_auth_address</code> configuration key to the public endpoint for the Identity service:
        </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/glance/glance-api.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT swift_store_auth_address http://<em class="replaceable"><code>IP</code></em>:5000/v2.0/</code></code></strong></pre></li><li class="listitem"><div class="para">
          Add the container for storing images in the Object Storage Service:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/glance/glance-api.conf \ DEFAULT swift_store_create_container_on_put True</code></strong></pre>

        </div></li><li class="listitem"><div class="para">
          Set the <code class="literal">swift_store_user</code> configuration key to contain the tenant and user to use for authentication in the format <em class="replaceable"><code>TENANT</code></em>:<em class="replaceable"><code>USER</code></em>:
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                If you followed the instructions in this guide to deploy Object Storage, these values must be replaced with the <code class="literal">services</code> tenant and the <code class="literal">swift</code> user respectively.
              </div></li><li class="listitem"><div class="para">
                If you did not follow the instructions in this guide to deploy Object Storage, these values must be replaced with the appropriate Object Storage tenant and user for your environment.
              </div></li></ul></div>

        </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/glance/glance-api.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT swift_store_user <em class="replaceable"><code>services:swift</code></em></code></code></strong></pre></li><li class="listitem"><div class="para">
          Set the <code class="literal">swift_store_key</code> configuration key to the password of the user to be used for authentication (that is, the password that was set for the <code class="literal">swift</code> user when deploying the Object Storage service.
        </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/glance/glance-api.conf \</code></code></strong>
        <strong class="userinput"><code><code class="command">DEFAULT swift_store_key <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15934-541150+%5BLatest%5D&amp;cf_build_id=15934-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Using+the+Object+Storage+Service+for+Image+Storage%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Firewall"></a>11.4.6.&nbsp;Configuring the Firewall</h3></div></div></div><div class="para">
    Systems attempting to use the functionality provided by the image storage service access it over the network using port <code class="literal">9292</code>.
  </div><div class="para">
    To allow this, the Image service is configured to recognize the 9292 port, and the firewall on the system hosting the image storage service is altered to allow network traffic on the port. All steps in this procedure must be run while logged in to the server hosting the image storage service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/glance/glance-api.conf</code> file in a text editor, and remove any comment characters from in front of the following parameters:
<pre class="screen">bind_host = 0.0.0.0
bind_port = 9292</pre>

      </div></li><li class="step"><div class="para">
        Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
      </div></li><li class="step"><div class="para">
        Add an INPUT rule allowing TCP traffic on port <code class="literal">9292</code> to the file. The new rule must appear before any INPUT rules that REJECT traffic.
      </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 9292 -j ACCEPT</pre></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
      </div></li><li class="step"><div class="para">
        Restart the <code class="command">iptables</code> service to ensure that the change takes effect.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">iptables</code> firewall is now configured to allow incoming connections to the image storage service on port <code class="literal">9292</code>.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15845-541150+%5BLatest%5D&amp;cf_build_id=15845-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Populating_the_Image_Storage_Database"></a>11.4.7.&nbsp;Populating the Image Service Database</h3></div></div></div><div class="para">
    This procedure describes the steps required to populate the Image service database. These steps must be performed while logged in to the system hosting the Image service. Log in as the <code class="systemitem">root</code> user initially. The database connection string must already be defined in the configuration of the service.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">su</code> command to switch to the <code class="literal">glance</code> user.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">su glance -s /bin/sh</code></code></strong></pre></li><li class="step"><div class="para">
        Run the <code class="command">glance-manage db_sync</code> command to initialize and populate the database identified in <code class="filename">/etc/glance/glance-api.conf</code> and <code class="filename">/etc/glance/glance-registry.conf</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">glance-manage db_sync</code></code></strong></pre></li></ol></div><div class="para">
    The Image service database has been initialized and populated.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16006-541150+%5BLatest%5D&amp;cf_build_id=16006-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Populating+the+Image+Service+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Starting_the_Image_Storage_Services"></a>11.5.&nbsp;Starting the Image API and Registry Services</h2></div></div></div><div class="para">
    Now that Glance has been configured, start the <code class="literal">glance-api</code> and <code class="literal">glance-registry</code> services as the <code class="systemitem">root</code> user:
  </div><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>service openstack-glance-registry start</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service openstack-glance-api start</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chkconfig openstack-glance-registry on</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>chkconfig openstack-glance-api on</code></strong></pre><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15930-541150+%5BLatest%5D&amp;cf_build_id=15930-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+the+Image+API+and+Registry+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Validating_the_Image_Service_Installation"></a>11.6.&nbsp;Validating the Image Service Installation</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Obtaining_a_Disk_Image_from_Red_Hat_Network"></a>11.6.1.&nbsp;Obtaining a Test Disk Image</h3></div></div></div><div class="para">
    A disk image can be downloaded from Red Hat, which can be used as a test in the import of images into the Image service (refer to Uploading an Image).
  </div><div class="para">
    A new image is provided with each minor RHEL 6 release, and is available in the Download section of the RHEL 6 Server channel:
  </div><div class="para">
    <a href="https://rhn.redhat.com/rhn/software/channel/downloads/Download.do?cid=16952">https://rhn.redhat.com/rhn/software/channel/downloads/Download.do?cid=16952</a>
  </div><div class="para">
    The <code class="command">wget</code> command below uses an example URL.
  </div><div class="para">

<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">mkdir /tmp/images</code></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code><code class="command">cd /tmp/images</code></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code><code class="command">wget -c -O rhel-6-server-x86_64-disc1.iso &quot;https://content-web.rhn.redhat.com/rhn/isos/xxxx/rhel-6-server-x86_64-disc1.isoxxxxxxxx&quot;</code></code></strong></pre>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15942-541150+%5BLatest%5D&amp;cf_build_id=15942-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Obtaining+a+Test+Disk+Image%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Building_a_Custom_Disk_Image"></a>11.6.2.&nbsp;Building a Custom Virtual Machine Image</h3></div></div></div><div class="para">
    Red Hat Enterprise Linux OpenStack Platform includes Oz, a set of libraries and utilities for performing automated operating system installations with limited input from the user. Oz is also useful for building virtual machine images that can be uploaded to the Image service and used to launch virtual machine instances.
  </div><div class="para">
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Template Description Language (TDL) Files - Oz accepts input in the form of XML-based TDL files, which describe the operating system being installed, the installation media's source, and any additional packages or customization changes that must be applied to the image.
        </div></li><li class="listitem"><div class="para">
          <code class="systemitem">virt-sysprep</code> - It is also recommended that the <code class="command">virt-sysprep</code> command is run on Linux-based virtual machine images prior to uploading them to to the Image service. The <code class="command">virt-sysprep</code> command re-initializes a disk image in preparation for use in a virtual environment. Default operations include the removal of SSH keys, removal of persistent MAC addresses, and removal of user accounts.
        </div><div class="para">
          The <code class="command">virt-sysprep</code> command is provided by the <span class="package">libguestfs-tools</span> package.
        </div></li></ul></div>

  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      Oz makes use of the <code class="literal">default</code> Libvirt network. It is recommended that you do not build images using Oz on a system that is running either the <code class="systemitem">nova-network</code> service or any of the OpenStack Networking components.
    </div></div></div><div class="procedure"><a id="proc-Building_Images_using_Oz"></a><p class="title"><strong>Procedure&nbsp;11.1.&nbsp;Building Images using Oz</strong></p><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">yum</code> command to install the <span class="package">oz</span> and <span class="package">libguestfs-tools</span> packages.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y oz libguestfs-tools</code></code></strong></pre></li><li class="step"><div class="para">
        Download the Red Hat Enterprise Linux 6 Server installation DVD ISO file.
      </div><div class="para">
        Although Oz supports the use of network-based installation media, in this procedure a Red Hat Enterprise Linux 6 DVD ISO will be used.
      </div></li><li class="step"><div class="para">
        Use a text editor to create a TDL file for use with Oz. The following example displays the syntax for a basic TDL file.
      </div><div class="example"><a id="idp14695928"></a><p class="title"><strong>Example&nbsp;11.1.&nbsp;TDL File</strong></p><div class="example-contents"><div class="para">
          The template below can be used to create a Red Hat Enterprise Linux&nbsp;6 disk image. In particular, note the use of the <code class="literal">rootpw</code> element to set the password for the <code class="systemitem">root</code> user and the <code class="literal">iso</code> element to set the path to the DVD ISO.
        </div><pre class="programlisting"><span class="perl_Keyword">&lt;template&gt;</span>
 <span class="perl_Keyword">&lt;name&gt;</span>rhel65_x86_64<span class="perl_Keyword">&lt;/name&gt;</span>
 <span class="perl_Keyword">&lt;description&gt;</span>Red Hat 6.5 x86_64 template<span class="perl_Keyword">&lt;/description&gt;</span>
 <span class="perl_Keyword">&lt;os&gt;</span>
  <span class="perl_Keyword">&lt;name&gt;</span>RHEL-6<span class="perl_Keyword">&lt;/name&gt;</span>
  <span class="perl_Keyword">&lt;version&gt;</span>4<span class="perl_Keyword">&lt;/version&gt;</span>
  <span class="perl_Keyword">&lt;arch&gt;</span>x86_64<span class="perl_Keyword">&lt;/arch&gt;</span>
  <span class="perl_Keyword">&lt;rootpw&gt;</span>PASSWORD<span class="perl_Keyword">&lt;/rootpw&gt;</span>
  <span class="perl_Keyword">&lt;install</span><span class="perl_Others"> type=</span><span class="perl_String">'iso'</span><span class="perl_Keyword">&gt;</span>
    <span class="perl_Keyword">&lt;iso&gt;</span>file:///home/user/rhel-server-6.5-x86_64-dvd.iso<span class="perl_Keyword">&lt;/iso&gt;</span>
  <span class="perl_Keyword">&lt;/install&gt;</span>
 <span class="perl_Keyword">&lt;/os&gt;</span>
 <span class="perl_Keyword">&lt;commands&gt;</span>
   <span class="perl_Keyword">&lt;command</span><span class="perl_Others"> name=</span><span class="perl_String">'console'</span><span class="perl_Keyword">&gt;</span>
sed -i 's/ rhgb//g' /boot/grub/grub.conf
sed -i 's/ quiet//g' /boot/grub/grub.conf
sed -i 's/ console=tty0 / serial=tty0 console=ttyS0,115200n8 /g' /boot/grub/grub.conf
   <span class="perl_Keyword">&lt;/command&gt;</span>
 <span class="perl_Keyword">&lt;/commands&gt;</span>
<span class="perl_Keyword">&lt;/template&gt;</span></pre></div></div><br class="example-break" /></li><li class="step"><div class="para">
        Run the <code class="command">oz-install</code> command to build an image:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">oz-install -u -d3 <em class="replaceable"><code>TDL_FILE</code></em></code></code></strong></pre><div class="para">
        Syntax:
        <div class="itemizedlist"><ul><li class="listitem"><div class="para">
              <code class="literal">-u</code> ensures any required customization changes to the image are applied after guest operating installation.
            </div></li><li class="listitem"><div class="para">
              <code class="literal">-d3</code> enables the display of errors, warnings, and informational messages.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>TDL_FILE</code></em> provides the path to your TDL file.
            </div></li></ul></div>

      </div><div class="para">
        By default, Oz stores the resultant image in the <code class="filename">/var/lib/libvirt/images/</code> directory. This location is configurable by editing the <code class="filename">/etc/oz/oz.cfg</code> configuration file.
      </div></li><li class="step"><div class="para">
        Run the <code class="command">virt-sysprep</code> command on the image to re-initialize it in preparation for upload to the Image service. Replace <em class="replaceable"><code>FILE</code></em> with the path to the disk image.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">virt-sysprep --add <em class="replaceable"><code>FILE</code></em></code></code></strong></pre><div class="para">
        Refer to the <code class="command">virt-sysprep</code> manual page by running the <code class="command">man virt-sysprep</code> command for information on enabling and disabling specific operations.
      </div></li></ol></div><div class="para">
    You have successfully created a Red Hat Enterprise Linux based image that is ready to be added to the Image service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15850-553125+%5BLatest%5D&amp;cf_build_id=15850-553125+12+Nov+2013+10%3A56+en-US+%5BLatest%5D&amp;comment=Title%3A+Building+a+Custom+Virtual+Machine+Image%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Uploading_a_Disk_Image1"></a>11.6.3.&nbsp;Uploading a Disk Image</h3></div></div></div><div class="para">
    To launch instances based on images stored in the Image service, you must first upload one or more images into the Image service.
  </div><div class="para">
    To carry out this procedure, you must already have created or downloaded images suitable for use in the OpenStack environment (refer to the <em class="citetitle">Obtaining an Image</em> and <em class="citetitle">Building an Image</em> sections).
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      It is recommended that the <code class="command">virt-sysprep</code> command be run on all Linux-based virtual machine images prior to uploading them to the Image service. The <code class="command">virt-sysprep</code> command re-initializes a disk image in preparation for use in a virtual environment. Default operations include the removal of SSH keys, removal of persistent MAC addresses, and removal of user accounts.
    </div><div class="para">
      The <code class="command">virt-sysprep</code> command is provided by the RHEL <span class="package">libguestfs-tools</span> package. As the <code class="systemitem">root</code> user, execute:
    </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y libguestfs-tools</code></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code><code class="command">virt-sysprep --add <em class="replaceable"><code>FILE</code></em></code></code></strong></pre><div class="para">
      For information on enabling and disabling specific operations, refer to the command's manual page by executing:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">man virt-sysprep</code></code></strong></pre>

    </div></div></div><div class="para">
    To upload an image to the Image service:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Set the environment variables used for authenticating with the Identity service by loading them from the <code class="filename">keystonerc</code> file associated with your user (an administrative account is not required):
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source</code> <em class="replaceable"><code>~/keystonerc_userName</code></em></code></strong></pre>

        </div></li><li class="listitem"><div class="para">
          Use the <code class="command">glance image-create</code> command to import your disk image:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">glance image-create --name &quot;<em class="replaceable"><code>NAME</code></em>&quot; \</code></code></strong>
        <strong class="userinput"><code><code class="command">--is-public <em class="replaceable"><code>IS_PUBLIC</code></em> \</code></code></strong>
        <strong class="userinput"><code><code class="command">--disk-format <em class="replaceable"><code>DISK_FORMAT</code></em> \</code></code></strong>
        <strong class="userinput"><code><code class="command">--container-format <em class="replaceable"><code>CONTAINER_FORMAT</code></em> \</code></code></strong>
        <strong class="userinput"><code><code class="command">--file <em class="replaceable"><code>IMAGE</code></em></code></code></strong></pre>

        </div><div class="para">
          Where:
        </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
              <em class="replaceable"><code>NAME</code></em> = The name by which users will refer to the disk image.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>IS_PUBLIC</code></em> = Either <code class="literal">true</code> or <code class="literal">false</code>:
            </div><div class="para">
              <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    <code class="literal">true</code> - All users will be able to view and use the image.
                  </div></li><li class="listitem"><div class="para">
                    <code class="literal">false</code> - Only administrators will be able to view and use the image.
                  </div></li></ul></div>

            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>DISK_FORMAT</code></em> = The disk image's format. Valid values include: <code class="literal">aki</code>, <code class="literal">ami</code>, <code class="literal">ari</code>, <code class="literal">iso</code>, <code class="literal">qcow2</code>, <code class="literal">raw</code>, <code class="literal">vdi</code>, <code class="literal">vhd</code>, and <code class="literal">vmdk</code>.
            </div><div class="para">
              If the format of the virtual machine disk image is unknown, use the <code class="command">qemu-img info</code> command to try and identify it.
            </div><div class="example"><a id="idm5245328"></a><p class="title"><strong>Example&nbsp;11.2.&nbsp;Using <code class="command">qemu-img info</code></strong></p><div class="example-contents"><div class="para">
                In the following example, the <code class="command">qemu-img info</code> is used to determine the format of a disk image stored in the file <code class="filename">./RHEL65.img</code>.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">qemu-img info ./RHEL65.img</code></code></strong>
image: ./RHEL65.img
file format: <span class="bold bold"><strong>qcow2</strong></span>
virtual size: 5.0G (5368709120 bytes)
disk size: 136K
cluster_size: 65536</pre></div></div><br class="example-break" /></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>CONTAINER_FORMAT</code></em> = The container format of the image. The container format is <code class="literal">bare</code> unless the image is packaged in a file format such as <code class="literal">ovf</code> or <code class="literal">ami</code> that includes additional metadata related to the image.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>IMAGE</code></em> = The local path to the image file (for uploading).
            </div></li></ul></div><div class="para">
          For more information about the <code class="command">glance image-create</code> syntax, execute:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">glance help image-create</code></code></strong></pre>

        </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
            If the image being uploaded is not locally accessible but is available using a remote URL, provide the URL using the <code class="literal">--location</code> parameter instead of using the <code class="literal">--file</code> parameter.
          </div><div class="para">
            However, unless you also specify the <code class="literal">--copy-from</code> argument, the Image service will not copy the image into the object store. Instead, the image will be accessed remotely each time it is required.
          </div></div></div><div class="para">
          <div class="example"><a id="exam-Uploading_an_Image_to_Glance"></a><p class="title"><strong>Example&nbsp;11.3.&nbsp;Uploading an Image to the Image service</strong></p><div class="example-contents"><div class="para">
              In this example the <code class="literal">qcow2</code> format image in the file named <code class="filename">rhel-65.qcow2</code> is uploaded to the Image service. It is created in the service as a publicly accessible image named <code class="literal">RHEL 6.5</code>.
            </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">glance image-create --name &quot;RHEL 6.5&quot; --is-public true --disk-format qcow2 \</code></code></strong>
          <strong class="userinput"><code><code class="command">--container-format bare \</code></code></strong>
          <strong class="userinput"><code><code class="command">--file rhel-65.qcow2</code></code></strong>
+------------------+--------------------------------------+
| Property         | Value                                |
+------------------+--------------------------------------+
| checksum         | <em class="replaceable"><code>2f81976cae15c16ef0010c51e3a6c163</code></em>     |
| container_format | <em class="replaceable"><code>bare</code></em>                                 |
| created_at       | <em class="replaceable"><code>2013-01-25T14:45:48</code></em>                  |
| deleted          | <em class="replaceable"><code>False</code></em>                                |
| deleted_at       | <em class="replaceable"><code>None</code></em>                                 |
| disk_format      | <em class="replaceable"><code>qcow2</code></em>                                |
| id               | <em class="replaceable"><code>0ce782c6-0d3e-41df-8fd5-39cd80b31cd9</code></em> |
| is_public        | <em class="replaceable"><code>True</code></em>                                 |
| min_disk         | <em class="replaceable"><code>0</code></em>                                    |
| min_ram          | <em class="replaceable"><code>0</code></em>                                    |
| name             | <em class="replaceable"><code>RHEL 6.5</code></em>                             |
| owner            | <em class="replaceable"><code>b1414433c021436f97e9e1e4c214a710</code></em>     |
| protected        | <em class="replaceable"><code>False</code></em>                                |
| size             | <em class="replaceable"><code>25165824</code></em>                             |
| status           | <em class="replaceable"><code>active</code></em>                               |
| updated_at       | <em class="replaceable"><code>2013-01-25T14:45:50</code></em>                  |
+------------------+--------------------------------------+</pre></div></div><br class="example-break" />

        </div></li><li class="listitem"><div class="para">
          To verify that your image was successfully uploaded, use the <code class="command">glance image-list</code> command:
<pre class="screen"> <code class="prompt">#</code> <strong class="userinput"><code>glance image-list</code></strong>
+--------------+----------+-------------+------------------+----------+--------+
| ID           | Name     | Disk Format | Container Format |Size      | Status |
+--------------+----------+-------------+------------------+----------+--------+
|<em class="replaceable"><code> 0ce782c6-...</code></em> | <em class="replaceable"><code>RHEL 6.5</code></em> | <em class="replaceable"><code>qcow2</code></em>       | <em class="replaceable"><code>bare</code></em>             |<em class="replaceable"><code>213581824</code></em> | <em class="replaceable"><code>active</code></em> |
+--------------+----------+-------------+------------------+----------+--------+</pre>

        </div><div class="para">
          To view detailed information about an uploaded image, execute the <code class="command">glance image-show</code> command using the image's identifier:
        </div><div class="para">

<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>glance image-show <em class="replaceable"><code>0ce782c6-0d3e-41df-8fd5-39cd80b31cd9</code></em></code></strong>
+------------------+--------------------------------------+
| Property         | Value                                |
+------------------+--------------------------------------+
| checksum         | <em class="replaceable"><code>2f81976cae15c16ef0010c51e3a6c163</code></em>     |
| container_format | <em class="replaceable"><code>bare</code></em>                                 |
| created_at       | <em class="replaceable"><code>2013-01-25T14:45:48</code></em>                  |
| deleted          | <em class="replaceable"><code>False</code></em>                                |
| disk_format      | <em class="replaceable"><code>qcow2</code></em>                                |
| id               | <em class="replaceable"><code>0ce782c6-0d3e-41df-8fd5-39cd80b31cd9</code></em> |
| is_public        | <em class="replaceable"><code>True</code></em>                                 |
| min_disk         | <em class="replaceable"><code>0</code></em>                                    |
| min_ram          | <em class="replaceable"><code>0</code></em>                                    |
| name             | <em class="replaceable"><code>RHEL 6.</code></em>                             |
| owner            | <em class="replaceable"><code>b1414433c021436f97e9e1e4c214a710</code></em>     |
| protected        | <em class="replaceable"><code>False</code></em>                                |
| size             | <em class="replaceable"><code>25165824</code></em>                             |
| status           | <em class="replaceable"><code>active</code></em>                               |
| updated_at       | <em class="replaceable"><code>2013-01-25T14:45:50</code></em>                  |
+------------------+--------------------------------------+</pre>

        </div></li></ol></div>

  </div><div class="para">
    You have successfully uploaded a disk image to the Image service. This disk image can now be used as the basis for launching virtual machine instances in your OpenStack environment.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Obtaining_a_Disk_Image_from_Red_Hat_Network">Section&nbsp;11.6.1, “Obtaining a Test Disk Image”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Building_a_Custom_Disk_Image">Section&nbsp;11.6.2, “Building a Custom Virtual Machine Image”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15916-546970+%5BLatest%5D&amp;cf_build_id=15916-546970+17+Oct+2013+11%3A44+en-US+%5BLatest%5D&amp;comment=Title%3A+Uploading+a+Disk+Image%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_OpenStack_Block_Storage"></a>Chapter&nbsp;12.&nbsp;Installing OpenStack Block Storage</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Block_Storage_Installation_Overview">12.1. Block Storage Installation Overview</a></span></dt><dt><span class="section"><a href="#sect-Block_Storage_Prerequisite_Configuration">12.2. Block Storage Prerequisite Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Block_Storage_Database">12.2.1. Creating the Block Storage Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Block_Storage_Service_Endpoint">12.2.2. Creating the Block Storage Identity Records</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Common_Block_Storage_Configuration">12.3. Common Block Storage Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Block_Storage_Service_Packages">12.3.1. Installing the Block Storage Service Packages</a></span></dt><dt><span class="section"><a href="#Configuring_Authentication3">12.3.2. Configuring Authentication</a></span></dt><dt><span class="section"><a href="#Setting_the_Message_Broker">12.3.3. Setting the Message Broker</a></span></dt><dt><span class="section"><a href="#Setting_the_Database_Connection_String3">12.3.4. Setting the Database Connection String</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall6">12.3.5. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Populating_the_Block_Storag_Database">12.3.6. Populating the Block Storage Database</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Volume_Service_Specific_Configuration">12.4. Volume Service Specific Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Block_Storage_Service_Requirements">12.4.1. Block Storage Driver Support</a></span></dt><dt><span class="section"><a href="#Configuring_for_LVM_Storage_Default">12.4.2. Configuring for LVM Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_NFS_Storage">12.4.3. Configuring for NFS Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_Red_Hat_Storage_Backend">12.4.4. Configuring for Red Hat Storage Backend</a></span></dt><dt><span class="section"><a href="#Configuring_for_Multiple_Storage_Backends">12.4.5. Configuring for Multiple Storage Backends</a></span></dt><dt><span class="section"><a href="#Configuring_tgtd">12.4.6. Configuring tgtd</a></span></dt></dl></dd><dt><span class="section"><a href="#Starting_the_Block_Storage_Service">12.5. Starting the Block Storage Services</a></span></dt><dt><span class="section"><a href="#Validating_the_Block_Storage_Service_Installation">12.6. Validating the Block Storage Service Installation</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Block_Storage_Installation_Overview"></a>12.1.&nbsp;Block Storage Installation Overview</h2></div></div></div><div class="para">
    Block storage functionality is provided in OpenStack by three separate services collectively referred to as the block storage service or <code class="literal">cinder</code>. The three services are:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">The API service (<code class="systemitem">openstack-cinder-api</code>)</span></dt><dd><div class="para">
          The API service provides a HTTP endpoint for block storage requests. When an incoming request is received the API verifies identity requirements are met and translates the request into a message denoting the required block storage actions. The message is then sent to the message broker for processing by the other block storage services.
        </div></dd><dt><span class="term">The scheduler service (<code class="systemitem">openstack-cinder-scheduler</code>)</span></dt><dd><div class="para">
          The scheduler service reads requests from the message queue and determines on which block storage host the request must be actioned. The scheduler then communicates with the volume service on the selected host to process the request.
        </div></dd><dt><span class="term">The volume service (<code class="systemitem">openstack-cinder-volume</code>)</span></dt><dd><div class="para">
          The volume service manages the interaction with the block storage devices. As requests come in from the scheduler, the volume service creates, modifies, and removes volumes as required.
        </div></dd></dl></div><div class="para">
    Although the three services can be co-located in a production environment, it is more common to deploy many instances of the volume service with one or more instances of the API and scheduler services managing them.
  </div><div class="figure"><a id="idm3488936"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2638.png" align="middle" alt="Block storage architecture diagram illustrating the relationship between the API, scheduler, and volume services and other OpenStack components." /></div></div><p class="title"><strong>Figure&nbsp;12.1.&nbsp;Block Storage Architecture</strong></p></div><br class="figure-break" /><div class="para">
    To aid in the creation of such deployments the installation of the block storage service has been broken down into:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Preparing for Block Storage Installation</span></dt><dd><div class="para">
          Steps that must be performed before installing any of the block storage services. These procedures include the creation of identity records, the database, and a database user.
        </div></dd><dt><span class="term">Common Block Storage Configuration</span></dt><dd><div class="para">
          Steps that are common to all of the block storage services and as such must be performed on all block storage nodes in the environment. These procedures include configuring the services to refer to the correct database and message broker. Additionally they include the initialization and population of the database which must only be performed once but can be performed from any of the block storage systems.
        </div></dd><dt><span class="term">Volume Service Specific Configuration</span></dt><dd><div class="para">
          Steps that are specific to systems that will be hosting the volume service and as such require direct access to block storage devices.
        </div></dd></dl></div><div class="para">
    As well as these configuration tasks, steps to start the services and validate the resulting deployment are also provided.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Block_Storage_Prerequisite_Configuration">Section&nbsp;12.2, “Block Storage Prerequisite Configuration”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Block_Storage_Configuration">Section&nbsp;12.3, “Common Block Storage Configuration”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Volume_Service_Specific_Configuration">Section&nbsp;12.4, “Volume Service Specific Configuration”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Starting_the_Block_Storage_Service">Section&nbsp;12.5, “Starting the Block Storage Services”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16112-541150+%5BLatest%5D&amp;cf_build_id=16112-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Block+Storage+Installation+Overview%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Block_Storage_Prerequisite_Configuration"></a>12.2.&nbsp;Block Storage Prerequisite Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_the_Block_Storage_Database"></a>12.2.1.&nbsp;Creating the Block Storage Database</h3></div></div></div><div class="para">
    In this procedure the database and database user that will be used by the block storage services will be created. These steps must be performed while logged in to the database server as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Connect to the database service using the <code class="command">mysql</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">mysql -u root -p</code></code></strong></pre></li><li class="step"><div class="para">
        Create the <code class="literal">cinder</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> CREATE DATABASE cinder;</pre></li><li class="step"><div class="para">
        Create a <code class="literal">cinder</code> database user and grant it access to the <code class="literal">cinder</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON cinder.* TO 'cinder'@'%' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON cinder.* TO 'cinder'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used to authenticate with the database server as this user.
      </div></li><li class="step"><div class="para">
        Flush the database privileges to ensure that they take effect immediately.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> FLUSH PRIVILEGES;</pre></li><li class="step"><div class="para">
        Exit the <code class="command">mysql</code> client command.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> quit</pre></li></ol></div><div class="para">
    The block storage database has been created. The database will be populated during service configuration.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15948-541150+%5BLatest%5D&amp;cf_build_id=15948-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Block+Storage+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_the_Block_Storage_Service_Endpoint"></a>12.2.2.&nbsp;Creating the Block Storage Identity Records</h3></div></div></div><div class="para">
    The steps outlined in this procedure cover the creation of identity records to support the Block Storage service:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Create the <code class="systemitem">cinder</code> user, who has the <code class="systemitem">admin</code> role in the <code class="systemitem">services</code> tenant.
        </div></li><li class="listitem"><div class="para">
          Create the <code class="systemitem">cinder</code> service entry and assign it an endpoint.
        </div></li></ol></div>

  </div><div class="para">
    These entries provided authentication for the block storage services and guide other OpenStack services attempting to locate and access the volume functionality it provides.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Authenticate as the administrator of the identity service by running the <code class="command">source</code> command on the <code class="filename">keystonerc_admin</code> file containing the required credentials.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Create a user named <code class="literal">cinder</code> for the block storage service to use.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-create --name cinder --pass <em class="replaceable"><code>PASSWORD</code></em></code></code></strong>
+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|  email   |                                  |
| enabled  |               True               |
|    id    | <em class="replaceable"><code>e1765f70da1b4432b54ced060139b46a</code></em> |
|   name   |              cinder              |
| tenantId |                                  |
+----------+----------------------------------+
</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used by the block storage service when authenticating with the identity service. Take note of the created user's returned ID as it will be used in subsequent steps.
      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="literal">admin</code> role:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone role-get admin</code></code></strong></pre><div class="para">
        If no <code class="systemitem">admin</code> role exists, create one:
<pre class="screen">$ keystone role-create --name admin</pre>

      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="systemitem">services</code> tenant:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-list | grep services</code></strong></pre><div class="para">
        If no <code class="systemitem">services</code> tenant exists, create one:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-create --name services --description &quot;Services Tenant&quot; </code></strong></pre><div class="para">
        This guide uses one tenant for all service users. For more information, refer to <em class="citetitle">Creating the Services Tenant</em>.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone user-role-add</code> command to link the <code class="literal">cinder</code> user, <code class="literal">admin</code> role, and <code class="literal">services</code> tenant together:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-role-add --user-id <em class="replaceable"><code>USERID</code></em> --role-id <em class="replaceable"><code>ROLEID</code></em> --tenant-id <em class="replaceable"><code>TENANTID</code></em></code></code></strong></pre><div class="para">
        Replace the user, role, and tenant IDs with those obtained in the previous steps.
      </div></li><li class="step"><div class="para">
        Create the <code class="literal">cinder</code> service entry:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone service-create --name cinder \</code></code></strong>
        <strong class="userinput"><code><code class="command">--type volume \</code></code></strong>
        <strong class="userinput"><code><code class="command">--description &quot;Cinder Volume Service&quot;</code></code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |      Cinder Volume Service       |
|      id     | <em class="replaceable"><code>dfde7878671e484c9e581a3eb9b63e66</code></em> |
|     name    |              cinder              |
|     type    |              volume              |
+-------------+----------------------------------+</pre><div class="para">
        Take note of the created service's returned ID as it will be used in the next step.
      </div></li><li class="step"><div class="para">
        Create the <code class="literal">cinder</code> endpoint entry.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone endpoint-create --service-id <em class="replaceable"><code>SERVICEID</code></em> \</code></code></strong>
        <strong class="userinput"><code><code class="command">--publicurl &quot;http://<em class="replaceable"><code>IP</code></em>:8776/v1/\$(tenant_id)s&quot; \</code></code></strong>
        <strong class="userinput"><code><code class="command">--adminurl &quot;http://<em class="replaceable"><code>IP</code></em>:8776/v1/\$(tenant_id)s&quot; \</code></code></strong>
        <strong class="userinput"><code><code class="command">--internalurl &quot;http://<em class="replaceable"><code>IP</code></em>:8776/v1/\$(tenant_id)s&quot;</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>SERVICEID</code></em> with the identifier returned by the <code class="command">keystone service-create</code> command. Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the system that will be hosting the block storage service API (<code class="systemitem">openstack-cinder-api</code>).
      </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          If you intend to install and run multiple instances of the API service then you must repeat this step for the IP address or host name of each instance.
        </div></div></div></li></ol></div><div class="para">
    All supporting identity service entries required by the block storage services have been created.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15924-541150+%5BLatest%5D&amp;cf_build_id=15924-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Block+Storage+Identity+Records%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Common_Block_Storage_Configuration"></a>12.3.&nbsp;Common Block Storage Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Installing_the_Block_Storage_Service_Packages"></a>12.3.1.&nbsp;Installing the Block Storage Service Packages</h3></div></div></div><div class="para">
    The OpenStack Block Storage service requires the following packages:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">openstack-cinder</span></span></dt><dd><div class="para">
          Provides the block storage services and associated configuration files.
        </div></dd><dt><span class="term"><span class="package">openstack-utils</span></span></dt><dd><div class="para">
          Provides supporting utilities to assist with a number of tasks including the editing of configuration files.
        </div></dd><dt><span class="term"><span class="package">openstack-selinux</span></span></dt><dd><div class="para">
          Provides OpenStack specific SELinux policy modules.
        </div></dd></dl></div><div class="para">
    To install all of the above packages, execute the following command while logged in as the <code class="systemitem">root</code> user:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y openstack-cinder openstack-utils openstack-selinux</code></code></strong></pre>

  </div><div class="para">
    The Block Storage services are now installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15953-541150+%5BLatest%5D&amp;cf_build_id=15953-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Block+Storage+Service+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_Authentication3"></a>12.3.2.&nbsp;Configuring Authentication</h3></div></div></div><div class="para">
    The block storage service must be explicitly configured to use the identity service for authentication. Follow the steps listed in this procedure to configure this.
  </div><div class="para">
    All steps listed in this procedure must be performed on each system hosting block storage services while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Set the authentication strategy (<code class="literal">auth_strategy</code>) configuration key to <code class="literal">keystone</code> using the <code class="command">openstack-config</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT auth_strategy keystone</code></code></strong></pre></li><li class="step"><div class="para">
        Set the authentication host (<code class="literal">auth_host</code>) configuration key to the IP address or host name of the identity server.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken auth_host <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the identity server.
      </div></li><li class="step"><div class="para">
        Set the administration tenant name (<code class="literal">admin_tenant_name</code>) configuration key to the name of the tenant that was created for the use of the block storage service. In this guide, examples use <em class="replaceable"><code>services</code></em>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Set the administration user name (<code class="literal">admin_user</code>) configuration key to the name of the user that was created for the use of the block storage service. In this guide, examples use <em class="replaceable"><code>cinder</code></em>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_user <em class="replaceable"><code>cinder</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Set the administration password (<code class="literal">admin_password</code>) configuration key to the password that is associated with the user specified in the previous step.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre></li></ol></div><div class="para">
    The authentication keys used by the block storage services have been set and will be used when the services are started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16048-541150+%5BLatest%5D&amp;cf_build_id=16048-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Authentication%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Setting_the_Message_Broker"></a>12.3.3.&nbsp;Setting the Message Broker</h3></div></div></div><div class="para">
    The block storage services must be explicitly configured with the type, location, and authentication details of the message broker.
  </div><div class="para">
    All steps in this procedure must be run on each system that will be hosting block storage services while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>General Settings</strong></p><div class="para">
        Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">rpc_backend</code> configuration key to Qpid.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT rpc_backend cinder.openstack.common.rpc.impl_qpid</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_hostname</code> configuration key to the host name of the Qpid server.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_hostname <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the message broker.
      </div></li><li class="step"><p class="title"><strong>Authentication Settings</strong></p><div class="para">
        If you have configured Qpid to authenticate incoming connections then you must provide the details of a valid Qpid user in the block storage configuration.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_username</code> configuration key to the username of the Qpid user that the block storage services must use when communicating with the message broker.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_username <em class="replaceable"><code>USERNAME</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>USERNAME</code></em> with the required Qpid user name.
          </div></li><li class="step"><div class="para">
            Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_password</code> configuration key to the password of the Qpid user that the block storage services must use when communicating with the message broker.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>PASSWORD</code></em> with the password of the Qpid user.
          </div></li></ol></li><li class="step"><p class="title"><strong>Encryption Settings</strong></p><div class="para">
        If you configured Qpid to use SSL then you must inform the block storage services of this choice. Use <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_protocol</code> configuration key to <code class="literal">ssl</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_protocol ssl</code></code></strong></pre><div class="para">
        The value of the <code class="literal">qpid_port</code> configuration key must be set to <code class="literal">5671</code> as Qpid listens on this different port when SSL is in use.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_port 5671</code></code></strong></pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          To communicate with a Qpid message broker that uses SSL the node must also have:
        </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
              The <span class="package">nss</span> package installed.
            </div></li><li class="listitem"><div class="para">
              The certificate of the relevant certificate authority installed in the system NSS database (<code class="filename">/etc/pki/nssdb/</code>).
            </div></li></ul></div><div class="para">
          The <code class="command">certtool</code> command is able to import certificates into the NSS database. See the <code class="command">certtool</code> manual page for more information (<code class="command">man certtool</code>).
        </div></div></div></li></ol></div><div class="para">
    The block storage services have been configured to use the message broker and any authentication schemes that it presents.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16015-541150+%5BLatest%5D&amp;cf_build_id=16015-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Message+Broker%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Setting_the_Database_Connection_String3"></a>12.3.4.&nbsp;Setting the Database Connection String</h3></div></div></div><div class="para">
    The database connection string used by the block storage services (the value of the <code class="literal">sql_connection</code> configuration key) is defined in the <code class="filename">/etc/cinder/cinder.conf</code> file. The string must be updated to point to a valid database server before starting the service.
  </div><div class="para">
    The following command must be executed as the <code class="systemitem">root</code> user on each system hosting block storage services:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT sql_connection mysql://<em class="replaceable"><code>USER</code></em>:<em class="replaceable"><code>PASS</code></em>@<em class="replaceable"><code>IP</code></em>/<em class="replaceable"><code>DB</code></em></code></code></strong></pre>

  </div><div class="para">
    Replace:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          <em class="replaceable"><code>USER</code></em> with the database user name the block storage services are to use, usually <code class="literal">cinder</code>.
        </div></li><li class="listitem"><div class="para">
          <em class="replaceable"><code>PASS</code></em> with the password of the chosen database user.
        </div></li><li class="listitem"><div class="para">
          <em class="replaceable"><code>IP</code></em> with the IP address or host name of the database server.
        </div></li><li class="listitem"><div class="para">
          <em class="replaceable"><code>DB</code></em> with the name of the database that has been created for use by the block storage services, usually <code class="literal">cinder</code>.
        </div></li></ul></div>

  </div><div class="para">
    The database connection string has been set and will be used by the block storage services.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16010-541150+%5BLatest%5D&amp;cf_build_id=16010-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Database+Connection+String%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Firewall6"></a>12.3.5.&nbsp;Configuring the Firewall</h3></div></div></div><div class="para">
    Systems attempting to use the functionality provided by the block storage services access it over the network using ports <code class="literal">3260</code> and <code class="literal">8776</code>.
  </div><div class="para">
    To allow this the firewall on the system hosting the block storage service must be altered to allow network traffic on these ports. All steps in this procedure must be run on each system hosting block storage services while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
      </div></li><li class="step"><div class="para">
        Add an INPUT rule allowing TCP traffic on ports <code class="literal">3260</code> and <code class="literal">8776</code> to the file. The new rule must appear before any INPUT rules that REJECT traffic.
      </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 3260,8776 -j ACCEPT</pre></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
      </div></li><li class="step"><div class="para">
        Restart the <code class="command">iptables</code> service to ensure that the change takes effect.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">iptables</code> firewall is now configured to allow incoming connections to the block storage service on ports <code class="literal">3260</code> and <code class="literal">8776</code>.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15921-541150+%5BLatest%5D&amp;cf_build_id=15921-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Populating_the_Block_Storag_Database"></a>12.3.6.&nbsp;Populating the Block Storage Database</h3></div></div></div><div class="para">
    This procedure describes the steps required to populate the block storage service database. These steps must be performed while logged in to a system hosting one of the block storage services. The database connection string must already be defined in the configuration of the service.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      This procedure only needs to be followed once to initialize and populate the database. You do not need to perform these steps again when adding additional systems hosting block storage services.
    </div></div></div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">su</code> command to switch to the <code class="literal">cinder</code> user.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">su cinder -s /bin/sh</code></code></strong></pre></li><li class="step"><div class="para">
        Run the <code class="command">cinder-manage db sync</code> command to initialize and populate the database identified in <code class="filename">/etc/cinder/cinder.conf</code>.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">cinder-manage db sync</code></code></strong></pre></li></ol></div><div class="para">
    The block storage service database has been initialized and populated.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16011-541150+%5BLatest%5D&amp;cf_build_id=16011-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Populating+the+Block+Storage+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Volume_Service_Specific_Configuration"></a>12.4.&nbsp;Volume Service Specific Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Block_Storage_Service_Requirements"></a>12.4.1.&nbsp;Block Storage Driver Support</h3></div></div></div><div class="para">
    The volume service (<code class="systemitem">openstack-cinder-volume</code>) requires access to suitable block storage. The service includes volume drivers for a number of block storage providers. Supported drivers for LVM, NFS, and Red Hat Storage are included.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15811-541150+%5BLatest%5D&amp;cf_build_id=15811-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Block+Storage+Driver+Support%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_for_LVM_Storage_Default"></a>12.4.2.&nbsp;Configuring for LVM Storage Backend</h3></div></div></div><div class="para">
    The volume service is able to make use of a volume group attached directly to the server on which the service runs. This volume group must be created exclusively for use by the block storage service and the configuration updated to point to the name of the volume group.
  </div><div class="para">
    The following steps must be performed while logged into the system hosting the volume service as the <code class="systemitem">root</code> user:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">pvcreate</code> command to create a physical volume.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">pvcreate <em class="replaceable"><code>DEVICE</code></em></code></code></strong>
  Physical volume &quot;<em class="replaceable"><code>DEVICE</code></em>&quot; successfully created</pre><div class="para">
        Replace <em class="replaceable"><code>DEVICE</code></em> with the path to a valid, unused, device. For example:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">pvcreate /dev/sdX</code></code></strong></pre>

      </div></li><li class="step"><div class="para">
        Use the <code class="command">vgcreate</code> command to create a volume group.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">vgcreate <em class="replaceable"><code>cinder-volumes</code></em> <em class="replaceable"><code>DEVICE</code></em></code></code></strong>
  Volume group &quot;<em class="replaceable"><code>cinder-volumes</code></em>&quot; successfully created</pre><div class="para">
        Replace <em class="replaceable"><code>DEVICE</code></em> with the path to the device used when creating the physical volume. Optionally replace <em class="replaceable"><code>cinder-volumes</code></em> with an alternative name for the new volume group.
      </div></li><li class="step"><div class="para">
        Set the <code class="literal">volume_group</code> configuration key to the name of the newly created volume group.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
<strong class="userinput"><code><code class="command">DEFAULT volume_group <em class="replaceable"><code>cinder-volumes</code></em></code></code></strong></pre><div class="para">
        The name provided must match the name of the volume group created in the previous step.
      </div></li><li class="step"><div class="para">
        Ensure that the correct volume driver for accessing LVM storage is in use by setting the <code class="literal">volume_driver</code> configuration key to <code class="literal">cinder.volume.drivers.lvm.LVMISCSIDriver</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
<strong class="userinput"><code><code class="command">DEFAULT volume_driver cinder.volume.drivers.lvm.LVMISCSIDriver</code></code></strong></pre></li></ol></div><div class="para">
    The volume service has been configured to use LVM storage.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16051-541150+%5BLatest%5D&amp;cf_build_id=16051-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+for+LVM+Storage+Backend%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_for_NFS_Storage"></a>12.4.3.&nbsp;Configuring for NFS Storage Backend</h3></div></div></div><div class="para">
    This procedure documents the steps involved in configuring the volume service to use NFS storage. The NFS shares to be used must already exist and be accessible from the server hosting the volume service.
  </div><div class="para">
    All steps listed in this procedure must be performed while logged into the system hosting the volume service as the <code class="systemitem">root</code> user.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      To access instance volumes on NFS shares, SELinux requires the <code class="systemitem">virt_use_nfs</code> Boolean enabled on any client machine accessing the instance volumes. This includes all compute nodes. Run the following command on each client machine as the <code class="systemitem">root</code> user to enable the Boolean and make it persistent across reboots:
    </div><pre class="screen"># setsebool -P virt_use_nfs on</pre></div></div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Create a text file in the <code class="filename">/etc/cinder/</code> directory containing a list of the NFS shares that the volume service is to use for backing storage.
      </div><pre class="programlisting"><em class="replaceable"><code>nfs1.example.com</code></em>:<em class="replaceable"><code>/export</code></em>
<em class="replaceable"><code>nfs2.example.com</code></em>:<em class="replaceable"><code>/export</code></em></pre><div class="para">
        Each line must contain an NFS share in the format <em class="replaceable"><code>HOST</code></em>:/<em class="replaceable"><code>SHARE</code></em> where <em class="replaceable"><code>HOST</code></em> is replaced by the IP address or host name of the NFS server and <em class="replaceable"><code>SHARE</code></em> is replaced with the particular NFS share to be used.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">chown</code> command to set the file to be owned by the <code class="systemitem">root</code> user and the <code class="systemitem">cinder</code> group.
      </div><pre class="screen"><code class="prompt">#</code> chown root:cinder <em class="replaceable"><code>FILE</code></em></pre><div class="para">
        Replace <em class="replaceable"><code>FILE</code></em> with the path to the file containing the list of NFS shares.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">chmod</code> command to set the file permissions such that it can be read by members of the <code class="systemitem">cinder</code> group.
      </div><pre class="screen"><code class="prompt">#</code> chmod 0640 <em class="replaceable"><code>FILE</code></em></pre><div class="para">
        Replace <em class="replaceable"><code>FILE</code></em> with the path to the file containing the list of NFS shares.
      </div></li><li class="step"><div class="para">
        Set the value of the <code class="literal">nfs_shares_config</code> configuration key to the path of the file containing the list of NFS shares.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT nfs_shares_config <em class="replaceable"><code>FILE</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>FILE</code></em> with the path to the file containing the list of NFS shares.
      </div></li><li class="step"><div class="para">
        The <code class="literal">nfs_sparsed_volumes</code> configuration key determines whether volumes are created as sparse files and grown as needed or fully allocated up front. The default and recommended value is <code class="literal">true</code>, which ensures volumes are initially created as sparse files.
      </div><div class="para">
        Setting the <code class="literal">nfs_sparsed_volumes</code> configuration key to <code class="literal">false</code> will result in volumes being fully allocated at the time of creation. This leads to increased delays in volume creation.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT nfs_sparsed_volumes <em class="replaceable"><code>true</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Optionally, provide any additional NFS mount options required in your environment in the <code class="literal">nfs_mount_options</code> configuration key. If your NFS shares do not require any additional mount options or you are unsure then skip this step.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT nfs_mount_options <em class="replaceable"><code>OPTIONS</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>OPTIONS</code></em> with the mount options to be used when accessing NFS shares. See the manual page for NFS for more information on available mount options (<code class="command">man nfs</code>).
      </div></li><li class="step"><div class="para">
        Ensure that the correct volume driver for accessing NFS storage is in use by setting the <code class="literal">volume_driver</code> configuration key to <code class="literal">cinder.volume.drivers.nfs.NfsDriver</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
<strong class="userinput"><code><code class="command">DEFAULT volume_driver cinder.volume.drivers.nfs.NfsDriver</code></code></strong></pre></li></ol></div><div class="para">
    The volume service has been configured to use NFS storage.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16052-541150+%5BLatest%5D&amp;cf_build_id=16052-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+for+NFS+Storage+Backend%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_for_Red_Hat_Storage_Backend"></a>12.4.4.&nbsp;Configuring for Red Hat Storage Backend</h3></div></div></div><div class="para">
    This procedure documents the steps involved in configuring the volume service to use Red Hat Storage. The Red Hat Storage shares to be used must already exist and be accessible from the server hosting the volume service.
  </div><div class="para">
    All steps listed in this procedure must be performed while logged into the system hosting the volume service as the <code class="systemitem">root</code> user.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      Mounting of Red Hat Storage volumes requires utilities and libraries from the <span class="package">glusterfs-fuse</span> package. For information on enabling the necessary Red Hat Network channels and installing the <span class="package">glusterfs-fuse</span> package refer to the Red Hat Storage <em class="citetitle">Administration Guide</em>. This package must be installed on all systems that will access volumes backed by Red Hat Storage.
    </div></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      To access instance Red Hat Storage volume, SELinux requires that the <code class="systemitem">virt_use_fusefs</code> Boolean is enabled on any client machine accessing the instance volumes. This includes all compute nodes. Run the following command on each client machine as the <code class="systemitem">root</code> user to enable the Boolean and make it persistent across reboots:
    </div><pre class="screen"># setsebool -P virt_use_fusefs on</pre></div></div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Create a text file in the <code class="filename">/etc/cinder/</code> directory containing a list of the Red Hat Storage shares that the volume service is to use for backing storage.
      </div><pre class="screen"><em class="replaceable"><code>HOST</code></em>:/<em class="replaceable"><code>VOLUME</code></em></pre><div class="para">
        Each line must contain a Red Hat Storage share in the format <em class="replaceable"><code>HOST</code></em>:<em class="replaceable"><code>VOLUME</code></em> where <em class="replaceable"><code>HOST</code></em> is replaced by the IP address or host name of the Red Hat Storage server and <em class="replaceable"><code>VOLUME</code></em> is replaced with the name of a particular volume that exists on that host.
      </div><div class="para">
        If required additional mount options must also be added in the same way that they would be provided to the <code class="command">mount</code> command line tool:
      </div><pre class="screen"><em class="replaceable"><code>HOST</code></em>:/<em class="replaceable"><code>VOLUME</code></em> -o <em class="replaceable"><code>OPTIONS</code></em></pre><div class="para">
        Replace <em class="replaceable"><code>OPTIONS</code></em> with a comma separated list of mount options.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">chown</code> command to set the file to be owned by the <code class="systemitem">root</code> user and the <code class="systemitem">cinder</code> group.
      </div><pre class="screen"><code class="prompt">#</code> chown root:cinder <em class="replaceable"><code>FILE</code></em></pre><div class="para">
        Replace <em class="replaceable"><code>FILE</code></em> with the path to the file containing the list of Red Hat Storage shares.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">chmod</code> command to set the file permissions such that it can be read by members of the <code class="systemitem">cinder</code> group.
      </div><pre class="screen"><code class="prompt">#</code> chmod 0640 <em class="replaceable"><code>FILE</code></em></pre><div class="para">
        Replace <em class="replaceable"><code>FILE</code></em> with the path to the file containing the list of Red Hat Storage shares.
      </div></li><li class="step"><div class="para">
        Set the value of the <code class="literal">glusterfs_shares_config</code> configuration key to the path of the file containing the list of Red Hat Storage shares.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT glusterfs_shares_config <em class="replaceable"><code>FILE</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>FILE</code></em> with the path to the file containing the list of Red Hat Storage shares.
      </div></li><li class="step"><div class="para">
        The <code class="literal">glusterfs_sparsed_volumes</code> configuration key determines whether volumes are created as sparse files and grown as needed or fully allocated up front. The default and recommended value is <code class="literal">true</code>, which ensures volumes are initially created as sparse files.
      </div><div class="para">
        Setting the <code class="literal">glusterfs_sparsed_volumes</code> configuration key to <code class="literal">false</code> will result in volumes being fully allocated at the time of creation. This leads to increased delays in volume creation.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT glusterfs_sparsed_volumes <em class="replaceable"><code>true</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Ensure that the correct volume driver for accessing Red Hat Storage is in use by setting the <code class="literal">volume_driver</code> configuration key to <code class="literal">cinder.volume.drivers.glusterfs</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/cinder/cinder.conf \</code></code></strong>
<strong class="userinput"><code><code class="command">DEFAULT volume_driver cinder.volume.drivers.glusterfs.GlusterfsDriver</code></code></strong></pre></li></ol></div><div class="para">
    The volume service has been configured to use Red Hat Storage.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17080-541150+%5BLatest%5D&amp;cf_build_id=17080-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+for+Red+Hat+Storage+Backend%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_for_Multiple_Storage_Backends"></a>12.4.5.&nbsp;Configuring for Multiple Storage Backends</h3></div></div></div><div class="para">
    In previous OpenStack releases each system hosting an instance of the volume service was only able to access a single storage backend or volume. In Red Hat Enterprise Linux OpenStack Platform&nbsp;3 and later this restriction no longer applies and the volume service can optionally be configured to access multiple storage backends. The scheduler then ensures that a unique instance of the volume service is launched to cater for each backend. These instances are able to run in parallel on the same system.
  </div><div class="para">
    Follow the steps outlined in this procedure on a system hosting the volume service while logged in as the <code class="systemitem">root</code> user. Each system that needs to be able to access multiple storage drivers or volumes must be configured in this way.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/cinder/cinder.conf</code> configuration file in a text editor.
      </div></li><li class="step"><div class="para">
        Add a configuration block for each storage driver or volume. This configuration block must have a unique name (avoid spaces or special characters) and contain values for at least these configuration keys:
      </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">volume_group</code></span></dt><dd><div class="para">
              A volume group name. This is the name of the volume group that will be accessed by the driver.
            </div></dd><dt><span class="term">v<code class="literal">olume_driver</code></span></dt><dd><div class="para">
              A volume driver. This is the name of the driver that will be used when accessing the volume group.
            </div></dd><dt><span class="term"><code class="literal">volume_backend_name</code></span></dt><dd><div class="para">
              A backend name. This is an administrator-defined name for the backend, which groups the drivers so that user requests for storage served from the given backend can be serviced by any driver in the group. It is not related to the name of the configuration group which must be unique.
            </div></dd></dl></div><div class="para">
        Any additional driver specific configuration must also be included in the configuration block.
      </div><pre class="programlisting">[<em class="replaceable"><code>NAME</code></em>]
volume_group=<em class="replaceable"><code>GROUP</code></em>
volume_driver=<em class="replaceable"><code>DRIVER</code></em>
volume_backend_name=<em class="replaceable"><code>BACKEND</code></em></pre><div class="para">
        Replace <em class="replaceable"><code>NAME</code></em> with a unique name for the backend and replace <em class="replaceable"><code>GROUP</code></em> with the unique name of the applicable volume group. Replace <em class="replaceable"><code>DRIVER</code></em> with the driver to use when accessing this storage backend, valid values include:
      </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
            <code class="systemitem">cinder.volume.drivers.lvm.LVMISCSIDriver</code> for LVM and iSCSI storage.
          </div></li><li class="listitem"><div class="para">
            <code class="systemitem">cinder.volume.drivers.nfs.NfsDriver</code> for NFS storage.
          </div></li><li class="listitem"><div class="para">
            <code class="systemitem">cinder.volume.drivers.glusterfs.GlusterfsDriver</code> for Red Hat Storage.
          </div></li></ul></div><div class="para">
        Finally replace <em class="replaceable"><code>BACKEND</code></em> with a name for the storage backend.
      </div></li><li class="step"><div class="para">
        Update the value of the <code class="literal">enabled_backends</code> configuration key in the <code class="literal">DEFAULT</code> configuration block. This configuration key must contain a comma separated list containing the names of the configuration blocks for each storage driver.
      </div><div class="example"><a id="idp4895240"></a><p class="title"><strong>Example&nbsp;12.1.&nbsp;Multiple Backend Configuration</strong></p><div class="example-contents"><div class="para">
          In this example two logical volume groups, <code class="literal">cinder-volumes-1</code> and <code class="literal">cinder-volumes-2</code>, are grouped into the storage backend named <code class="literal">LVM</code>. An additional volume, backed by a list of NFS shares, is grouped into a storage backend named <code class="literal">NFS</code>.
        </div><pre class="programlisting">[DEFAULT]
<em class="replaceable"><code>...</code></em>
enabled_backends=cinder-volumes-1-driver,cinder-volumes-2-driver,cinder-volumes-3-driver
<em class="replaceable"><code>...</code></em>
[cinder-volumes-1-driver]
volume_group=cinder-volumes-1
volume_driver=cinder.volume.drivers.lvm.LVMISCSIDriver
volume_backend_name=LVM
[cinder-volumes-2-driver]
volume_group=cinder-volumes-2
volume_driver=cinder.volume.drivers.lvm.LVMISCSIDriver
volume_backend_name=LVM
[cinder-volumes-3-driver]
nfs_shares_config=/etc/cinder/shares.txt
volume_driver=cinder.volume.drivers.nfs.NfsDriver
volume_backend_name=NFS
</pre></div></div><br class="example-break" /><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          The default block storage scheduler driver in Red Hat Enterprise Linux OpenStack Platform&nbsp;3 is the filter scheduler. If you have changed the value of the <code class="literal">scheduler_driver</code> configuration key on any of your block storage nodes then you must update the value to <code class="literal">cinder.scheduler.filter_scheduler.FilterScheduler</code> for the multiple storage backends feature to function correctly.
        </div></div></div></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/cinder/cinder.conf</code> file.
      </div></li></ol></div><div class="para">
    The volume service is now configured to use multiple storage backends when started. Note that if the <code class="systemitem">openstack-cinder-volume</code> service has already been started then you must restart it for the changes to take effect.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To allow users to specify which backend their volumes are created on rather than relying on the scheduler a volume type must be defined in the database. Once the services are operational this can be done using these commands:
    </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code><code class="command">cinder type-create <em class="replaceable"><code>TYPE</code></em></code></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code><code class="command">cinder type-key <em class="replaceable"><code>TYPE</code></em> set volume_backend_name=<em class="replaceable"><code>BACKEND</code></em></code></code></strong></pre><div class="para">
      Replace <em class="replaceable"><code>TYPE</code></em> with the name that users must provide to select this specific storage backend and replace a <em class="replaceable"><code>BACKEND</code></em> with the relevant <code class="literal">volume_backend_name</code> as set in the <code class="filename">/etc/cinder/cinder.conf</code> configuration file.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17079-541150+%5BLatest%5D&amp;cf_build_id=17079-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+for+Multiple+Storage+Backends%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_tgtd"></a>12.4.6.&nbsp;Configuring tgtd</h3></div></div></div><div class="para">
    The volume storage service makes use of the SCSI target daemon, <code class="command">tgtd</code>, when mounting storage. To support this the <code class="command">tgtd</code> service must be configured to read additional configuration files.
  </div><div class="para">
    The steps listed in this procedure must be performed on each system hosting an instance of the volume service while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/tgt/targets.conf</code> file.
      </div></li><li class="step"><div class="para">
        Add this line to the file:
      </div><pre class="programlisting">include /etc/cinder/volumes/*</pre></li><li class="step"><div class="para">
        Save the changes to the file.
      </div></li></ol></div><div class="para">
    When the <code class="command">tgtd</code> service is started it will be configured to support the volume service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16120-541150+%5BLatest%5D&amp;cf_build_id=16120-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+tgtd%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Starting_the_Block_Storage_Service"></a>12.5.&nbsp;Starting the Block Storage Services</h2></div></div></div><div class="para">
    To bring up the block storage functionality at least one instance of each of the three services must be started:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        The API service (<code class="systemitem">openstack-cinder-api</code>).
      </div></li><li class="listitem"><div class="para">
        The scheduler service (<code class="systemitem">openstack-cinder-scheduler</code>).
      </div></li><li class="listitem"><div class="para">
        The volume service (<code class="systemitem">openstack-cinder-volume</code>).
      </div></li></ul></div><div class="para">
    The services do not need to be located on the same system, but must be configured to communicate using the same message broker and database instance. Once the services are running, the API will accept incoming volume requests, the scheduler will assign them as appropriate, and the volume service will action them.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Starting the API Service</strong></p><div class="para">
        Log in to each server that you intend to run the API on as the <code class="systemitem">root</code> user and start the API service.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the API service (<code class="systemitem">openstack-cinder-api</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-cinder-api start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the API service permanently (<code class="systemitem">openstack-cinder-api</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-cinder-api on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the Scheduler Service</strong></p><div class="para">
        Log in to each server that you intend to run the scheduler on as the <code class="systemitem">root</code> user and start the scheduler service.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the scheduler (<code class="systemitem">openstack-cinder-scheduler</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-cinder-scheduler start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the scheduler permanently (<code class="systemitem">openstack-cinder-scheduler</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-cinder-scheduler on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the Volume Service</strong></p><div class="para">
        Log in to each server that block storage has been attached to as the <code class="systemitem">root</code> user and start the volume service.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the volume service (<code class="systemitem">openstack-cinder-volume</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-cinder-volume start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the The SCSI target daemon (<code class="systemitem">tgtd</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service tgtd start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the volume service permanently (<code class="systemitem">openstack-cinder-volume</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-cinder-volume on</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the SCSI target daemon permanently (<code class="systemitem">tgtd</code>).
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig tgtd on</code></code></strong></pre></li></ol></li></ol></div><div class="para">
    The volume service is running and ready to begin allocating volumes as they are requested.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15917-541150+%5BLatest%5D&amp;cf_build_id=15917-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+the+Block+Storage+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Validating_the_Block_Storage_Service_Installation"></a>12.6.&nbsp;Validating the Block Storage Service Installation</h2></div></div></div><div class="para">
    This procedure lists steps for validating that the block storage installation is complete and ready for use.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Testing Locally</strong></p><div class="para">
        The steps outlined in this section of the procedure must be performed while logged in to the server hosting the block storage API service as the <code class="systemitem">root</code> user or a user with access to a <code class="filename">keystonerc_admin</code> file containing the credentials of the OpenStack administrator. Transfer the <code class="filename">keystonerc_admin</code> file to the system before proceeding.
      </div><ol class="a"><li class="step"><div class="para">
            Run the <code class="command">source</code> command on the <code class="filename">keystonerc_admin</code> file to populate the environment variables used for identifying and authenticating the user.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
            Run the <code class="command">cinder list</code> command and verify that no errors are returned.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">cinder list</code></code></strong></pre></li><li class="step"><div class="para">
            Run the <code class="command">cinder create</code> command to create a volume.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">cinder create <em class="replaceable"><code>SIZE</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>SIZE</code></em> with the size of the volume to create in Gigabytes (GB).
          </div></li><li class="step"><div class="para">
            Run the <code class="command">cinder delete</code> command to remove the volume.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">cinder delete <em class="replaceable"><code>ID</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>ID</code></em> with the identifier returned when the volume was created.
          </div></li></ol></li><li class="step"><p class="title"><strong>Testing Remotely</strong></p><div class="para">
        The steps outlined in this section of the procedure must be performed while logged in to a system other than the server hosting the block storage API service. Transfer the <code class="filename">keystonerc_admin</code> file to the system before proceeding.
      </div><ol class="a"><li class="step"><div class="para">
            Install the <span class="package">python-cinderclient</span> package using the <code class="command">yum</code> command. You will need to authenticate as the <code class="systemitem">root</code> user for this step.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y python-cinderclient</code></code></strong></pre></li><li class="step"><div class="para">
            Run the <code class="command">source</code> command on the <code class="filename">keystonerc_admin</code> file to populate the environment variables used for identifying and authenticating the user.
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
            Run the <code class="command">cinder list</code> command and verify that no errors are returned.
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">cinder list</code></code></strong></pre></li><li class="step"><div class="para">
            Run the <code class="command">cinder create</code> command to create a volume.
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">cinder create <em class="replaceable"><code>SIZE</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>SIZE</code></em> with the size of the volume to create in Gigabytes (GB).
          </div></li><li class="step"><div class="para">
            Run the <code class="command">cinder delete</code> command to remove the volume.
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">cinder delete <em class="replaceable"><code>ID</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>ID</code></em> with the identifier returned when the volume was created.
          </div></li></ol></li></ol></div><div class="para">
    Basic validation of the block storage service installation has been performed.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15872-541150+%5BLatest%5D&amp;cf_build_id=15872-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Validating+the+Block+Storage+Service+Installation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_OpenStack_Networking_Service"></a>Chapter&nbsp;13.&nbsp;Installing the OpenStack Networking Service</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#sect-OpenStack_Networking_Installation_Overview">13.1. OpenStack Networking Installation Overview</a></span></dt><dd><dl><dt><span class="section"><a href="#OpenStack_Netorking_Architecture">13.1.1. OpenStack Networking Architecture</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_API">13.1.2. OpenStack Networking API</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_API_Extensions">13.1.3. OpenStack Networking API Extensions</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_Plug-ins">13.1.4. OpenStack Networking Plug-ins</a></span></dt><dt><span class="section"><a href="#OpenStack_Networking_Agents">13.1.5. OpenStack Networking Agents</a></span></dt><dt><span class="section"><a href="#Networking_Service_Requirements">13.1.6. Recommended Networking Deployment</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Networking_Prerequisite_Configuration">13.2. Networking Prerequisite Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Database">13.2.1. Creating the OpenStack Networking Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Service_Endpoint">13.2.2. Creating the OpenStack Networking Identity Records</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Common_Networking_Configuration">13.3. Common Networking Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="#Upgrading_the_Kernel">13.3.1. Upgrading the Kernel</a></span></dt><dt><span class="section"><a href="#Disabling_Network_Manager">13.3.2. Disabling Network Manager</a></span></dt><dt><span class="section"><a href="#Installing_the_Packages3">13.3.3. Installing the Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall4">13.3.4. Configuring the Firewall</a></span></dt></dl></dd><dt><span class="section"><a href="#Configuring_the_Networking_Service1">13.4. Configuring the Networking Service</a></span></dt><dt><span class="section"><a href="#Configuring_the_DHCP_Agent">13.5. Configuring the DHCP Agent</a></span></dt><dt><span class="section"><a href="#Configuring_a_Provider_Network1">13.6. Configuring a Provider Network</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Plug-in_Agent">13.7. Configuring the Plug-in Agent</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_the_Open_vSwitch_Plug-in">13.7.1. Configuring the Open vSwitch Plug-in Agent</a></span></dt><dt><span class="section"><a href="#Configuring_the_Linux_Bridge_Plug-in">13.7.2. Configuring the Linux Bridge Plug-in Agent</a></span></dt></dl></dd><dt><span class="section"><a href="#Configuring_the_L3_Agent">13.8. Configuring the L3 Agent</a></span></dt><dt><span class="section"><a href="#Validating_the_OpenStack_Networking_Installation1">13.9. Validating the OpenStack Networking Installation</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-OpenStack_Networking_Installation_Overview"></a>13.1.&nbsp;OpenStack Networking Installation Overview</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="OpenStack_Netorking_Architecture"></a>13.1.1.&nbsp;OpenStack Networking Architecture</h3></div></div></div><div class="para">
    OpenStack Networking provides cloud administrators with flexibility in deciding which individual services should run on which physical systems. All service daemons can be run on a single physical host for evaluation purposes. Alternatively each service can have its own physical host or even be replicated across multiple hosts for redundancy.
  </div><div class="para">
    This chapter focuses on an architecture that combines the role of cloud controller with that of the network host while allowing for multiple compute nodes on which virtual machine instances run. The networking services deployed on the cloud controller in this chapter may also be deployed on a separate network host entirely. This is recommended for environments where it is expected that significant amounts of network traffic will need to be routed from virtual machine instances to external networks.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16123-541150+%5BLatest%5D&amp;cf_build_id=16123-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+OpenStack+Networking+Architecture%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="OpenStack_Networking_API"></a>13.1.2.&nbsp;OpenStack Networking API</h3></div></div></div><div class="para">
    OpenStack Networking provides a powerful API to define the network connectivity and addressing used by devices from other services, such as OpenStack Compute.
  </div><div class="para">
    The OpenStack Compute API has a virtual server abstraction to describe compute resources. Similarly, the OpenStack Networking API has virtual network, subnet, and port abstractions to describe network resources. In more detail:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Network</span></dt><dd><div class="para">
          An isolated L2 segment, analogous to VLAN in the physical networking world.
        </div></dd><dt><span class="term">Subnet</span></dt><dd><div class="para">
          A block of v4 or v6 IP addresses and associated configuration state.
        </div></dd><dt><span class="term">Port</span></dt><dd><div class="para">
          A connection point for attaching a single device, such as the NIC of a virtual server, to a virtual network. Also describes the associated network configuration, such as the MAC and IP addresses to be used on that port.
        </div></dd></dl></div><div class="para">
    You can configure rich network topologies by creating and configuring networks and subnets, and then instructing other OpenStack services like OpenStack Compute to attach virtual devices to ports on these networks. In particular, OpenStack Networking supports each tenant having multiple private networks, and allows tenants to choose their own IP addressing scheme, even if those IP addresses overlap with those used by other tenants. This enables very advanced cloud networking use cases, such as building multi-tiered web applications and allowing applications to be migrated to the cloud without changing IP addresses.
  </div><div class="para">
    Even if a cloud administrator does not intend to expose the above capabilities to tenants directly, the OpenStack Networking API can be very useful for administrative purposes. The API provides significantly more flexibility for the cloud administrator when customizing network offerings.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16121-541150+%5BLatest%5D&amp;cf_build_id=16121-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+OpenStack+Networking+API%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="OpenStack_Networking_API_Extensions"></a>13.1.3.&nbsp;OpenStack Networking API Extensions</h3></div></div></div><div class="para">
    The OpenStack networking API allows plug-ins to provide extensions to enable additional networking functional not available in the core API itself.
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Provider Networks</span></dt><dd><div class="para">
          Provider networks allow the creation of virtual networks that map directly to networks in the physical data center. This allows the administrator to give tenants direct access to a public network such as the Internet or to integrate with existing VLANs in the physical networking environment that have a defined meaning or purpose.
        </div><div class="para">
          When the provider extension is enabled OpenStack networking users with administrative privileges are able to see additional provider attributes on all virtual networks. In addition such users have the ability to specify provider attributes when creating new provider networks.
        </div><div class="para">
          Both the Open vSwitch and Linux Bridge plug-ins support the provider networks extension.
        </div></dd><dt><span class="term">Layer 3 (L3) Routing and Network Address Translation (NAT)</span></dt><dd><div class="para">
          The L3 routing API extensions provides abstract L3 routers that API users are able to dynamically provision and configure. These routers are able to connect to one or more Layer 2 (L2) OpenStack networking controlled networks. Additionally the routers are able to provide a gateway that connects one or more private L2 networks to an common public or external network such as the Internet.
        </div><div class="para">
          The L3 router provides basic NAT capabilities on gateway ports that connect the router to external networks. The router supports floating IP addresses which give a static mapping between a public IP address on the external network and the private IP address on one of the L2 networks attached to the router.
        </div><div class="para">
          This allows the selective exposure of compute instances to systems on an external public network. Floating IP addresses are also able to be reallocated to different OpenStack networking ports as necessary.
        </div></dd><dt><span class="term">Security Groups</span></dt><dd><div class="para">
          Security groups and security group rules allow the specification of the specific type and direction of network traffic that is allowed to pass through a given network port. This provides an additional layer of security over and above any firewall rules that exist within a compute instance. The security group is a container object which can contain one or more security rules. A single security group can be shared by multiple compute instances.
        </div><div class="para">
          When a port is created using OpenStack networking it is associated with a security group. If a specific security group was not specified then the port is associated with the <code class="literal">default</code> security group. By default this group will drop all inbound traffic and allow all outbound traffic. Additional security rules can be added to the <code class="literal">default</code> security group to modify its behaviour or new security groups can be created as necessary.
        </div><div class="para">
          The Open vSwitch, Linux Bridge, Nicira NVP, NEC, and Ryu networking plug-ins currently support security groups.
        </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
            Unlike Compute security groups, OpenStack networking security groups are applied on a per port basis rather than on a per instance basis.
          </div></div></div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17686-541150+%5BLatest%5D&amp;cf_build_id=17686-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+OpenStack+Networking+API+Extensions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="OpenStack_Networking_Plug-ins"></a>13.1.4.&nbsp;OpenStack Networking Plug-ins</h3></div></div></div><div class="para">
    The original OpenStack Compute network implementation assumed a basic networking model where all network isolation was performed through the use of Linux VLANs and IP tables. OpenStack Networking introduces the concept of a <em class="firstterm">plug-in</em>, which is a pluggable back-end implementation of the OpenStack Networking API. A plug-in can use a variety of technologies to implement the logical API requests. &nbsp;Some OpenStack Networking plug-ins might use basic Linux VLANs and IP tables, while others might use more advanced technologies, such as L2-in-L3 tunneling or OpenFlow, to provide similar benefits.
  </div><div class="para">
    Plug-ins for these networking technologies are currently tested and supported for use with Red Hat Enterprise Linux OpenStack Platform:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Open vSwitch (<span class="package">openstack-neutron-openvswitch</span>)
        </div></li><li class="listitem"><div class="para">
          Linux Bridge (<span class="package">openstack-neutron-linuxbridge</span>)
        </div></li></ul></div>
     Other plug-ins that are also packaged and available include:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Cisco (<span class="package">openstack-neutron-cisco</span>)
        </div></li><li class="listitem"><div class="para">
          NEC OpenFlow (<span class="package">openstack-neutron-nec</span>)
        </div></li><li class="listitem"><div class="para">
          Nicira (<span class="package">openstack-neutron-nicira</span>)
        </div></li><li class="listitem"><div class="para">
          Ryu (<span class="package">openstack-neutron-ryu</span>)
        </div></li></ul></div>

  </div><div class="para">
    Plug-ins enable the cloud administrator to weigh different options and decide which networking technology is right for the deployment.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16122-550056+%5BLatest%5D&amp;cf_build_id=16122-550056+01+Nov+2013+09%3A48+en-US+%5BLatest%5D&amp;comment=Title%3A+OpenStack+Networking+Plug-ins%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="OpenStack_Networking_Agents"></a>13.1.5.&nbsp;OpenStack Networking Agents</h3></div></div></div><div class="para">
    As well as the OpenStack Networking service and the installed plug-in a number of components combine to provide networking functionality in the OpenStack environment.
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">L3 Agent</span></dt><dd><div class="para">
          The L3 agent is part of the <span class="package">openstack-neutron</span> package. It acts as an abstract L3 router that can connect to and provide gateway services for multiple L2 networks.
        </div><div class="para">
          The nodes on which the L3 agent is to be hosted must not have a manually configured IP address on a network interface that is connected to an external network. Instead there must be a range of IP addresses from the external network that are available for use by OpenStack Networking. These IP addresses will be assigned to the routers that provide the link between the internal and external networks.
        </div><div class="para">
          The range selected must be large enough to provide a unique IP address for each router in the deployment as well as each desired floating IP.
        </div></dd><dt><span class="term">DHCP Agent</span></dt><dd><div class="para">
          The OpenStack Networking DHCP agent is capable of allocating IP addresses to virtual machines running on the network. If the agent is enabled and running when a subnet is created then by default that subnet has DHCP enabled.
        </div></dd><dt><span class="term">Plug-in Agent</span></dt><dd><div class="para">
          Many of the OpenStack Networking plug-ins, including Open vSwitch and Linux Bridge, utilize their own agent. The plug-in specific agent runs on each node that manages data packets. This includes all compute nodes as well as nodes running the dedicated agents <code class="systemitem">neutron-dhcp-agent</code> and <code class="systemitem">neutron-l3-agent</code>.
        </div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16834-550057+%5BLatest%5D&amp;cf_build_id=16834-550057+01+Nov+2013+09%3A49+en-US+%5BLatest%5D&amp;comment=Title%3A+OpenStack+Networking+Agents%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Networking_Service_Requirements"></a>13.1.6.&nbsp;Recommended Networking Deployment</h3></div></div></div><div class="para">
    OpenStack Networking provides an extreme amount of flexibility when deploying networking in support of a compute environment. As a result, the exact layout of a deployment will depend on a combination of expected workloads, expected scale, and available hardware.
  </div><div class="figure"><a id="idm5779536"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2476.png" align="middle" alt="Reference networking architecture." /></div></div><p class="title"><strong>Figure&nbsp;13.1.&nbsp;Deployment Architecture</strong></p></div><br class="figure-break" /><div class="para">
    For demonstration purposes, this chapter concentrates on a networking deployment that consists of these types of nodes:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Service Node</span></dt><dd><div class="para">
          The service node exposes the networking API to clients and handles incoming requests before forwarding them to a message queue to be actioned by the other nodes. The service node hosts both the networking service itself and the active networking plug-in.
        </div><div class="para">
          In environments that use <em class="citetitle">controller nodes</em> to host the client-facing APIs and schedulers for all services, the controller node would also fulfil the role of service node as it is applied in this chapter.
        </div></dd><dt><span class="term">Network Node</span></dt><dd><div class="para">
          The network node handles the majority of the networking workload. It hosts the DHCP agent, the Layer 3 (L3) agent, the Layer 2 (L2) Agent, and the metadata proxy. In addition to plug-ins that require an agent, it runs an instance of the plug-in agent (as do all other systems that handle data packets in an environment where such plug-ins are in use). Both the Open vSwitch and Linux Bridge plug-ins include an agent.
        </div></dd><dt><span class="term">Compute Node</span></dt><dd><div class="para">
          The compute hosts the compute instances themselves. To connect compute instances to the networking services, compute nodes must also run the L2 agent. Like all other systems that handle data packets it must also run an instance of the plug-in agent.
        </div></dd></dl></div><div class="para">
    This deployment type and division of responsibilities is made only as a suggestion. Other divisions are equally valid, in particular in some environments the network and service nodes may be combined.
  </div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
      Environments that have been configured to use Compute networking, either using the <code class="command">packstack</code> utility or manually, can be reconfigured to use OpenStack Networking. This is however currently <span class="bold bold"><strong>not</strong></span> recommended for environments where Compute instances have already been created and configured to use Compute networking. If you wish to proceed with such a conversion. you must ensure that you stop the <code class="systemitem">openstack-nova-network</code> service on each Compute node using the <code class="command">service</code> command before proceeding.
    </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-nova-network stop</code></code></strong></pre><div class="para">
      You must also disable the <code class="systemitem">openstack-nova-network</code> service permanently on each node using the <code class="command">chkconfig</code> command.
    </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-nova-network off</code></code></strong></pre></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      When running 2 or more active controller nodes, do not run <code class="systemitem">nova-consoleauth</code> on more than one node. Running more than one instance of <code class="systemitem">nova-consoleauth</code> causes a conflict between nodes with regard to token requests which may cause errors.
    </div></div></div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Networking_Prerequisite_Configuration">Section&nbsp;13.2, “Networking Prerequisite Configuration”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Networking_Configuration">Section&nbsp;13.3, “Common Networking Configuration”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Configuring_the_Networking_Service1">Section&nbsp;13.4, “Configuring the Networking Service”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Configuring_the_DHCP_Agent">Section&nbsp;13.5, “Configuring the DHCP Agent”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Configuring_a_Provider_Network1">Section&nbsp;13.6, “Configuring a Provider Network”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Configuring_the_L3_Agent">Section&nbsp;13.8, “Configuring the L3 Agent”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Configuring_the_Plug-in_Agent">Section&nbsp;13.7, “Configuring the Plug-in Agent”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15884-541150+%5BLatest%5D&amp;cf_build_id=15884-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Recommended+Networking+Deployment%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Networking_Prerequisite_Configuration"></a>13.2.&nbsp;Networking Prerequisite Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_the_Database"></a>13.2.1.&nbsp;Creating the OpenStack Networking Database</h3></div></div></div><div class="para">
    In this procedure the database and database user that will be used by the networking service will be created. These steps must be performed while logged in to the database server as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Connect to the database service using the <code class="command">mysql</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">mysql -u root -p</code></code></strong></pre></li><li class="step"><div class="para">
        Create the database. If you intend to use the:
        <div class="itemizedlist"><ul><li class="listitem"><div class="para">
              Open vSwitch plug-in, the recommended database name is <code class="literal">ovs_neutron</code>.
            </div></li><li class="listitem"><div class="para">
              Linux Bridge plug-in, the recommended database name is <code class="literal">neutron_linux_bridge</code>.
            </div></li></ul></div>
         This example uses the database name of '<code class="systemitem">ovs_neutron</code>'.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> CREATE DATABASE ovs_neutron;</pre></li><li class="step"><div class="para">
        Create a <code class="literal">neutron</code> database user and grant it access to the <code class="literal">ovs_neutron</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON ovs_neutron.* TO 'neutron'@'%' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON ovs_neutron.* TO 'neutron'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used to authenticate with the database server as this user.
      </div></li><li class="step"><div class="para">
        Flush the database privileges to ensure that they take effect immediately.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> FLUSH PRIVILEGES;</pre></li><li class="step"><div class="para">
        Exit the <code class="command">mysql</code> client command.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> quit</pre></li></ol></div><div class="para">
    The OpenStack Networking database 'ovs_neutron' has been created. The database will be populated during service configuration.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15810-550059+%5BLatest%5D&amp;cf_build_id=15810-550059+01+Nov+2013+09%3A51+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+OpenStack+Networking+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_the_Service_Endpoint"></a>13.2.2.&nbsp;Creating the OpenStack Networking Identity Records</h3></div></div></div><div class="para">
    The steps outlined in this procedure cover the creation of these identity records to support the Image service:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Create the <code class="systemitem">neutron</code> user, who has the <code class="systemitem">admin</code> role in the <code class="systemitem">services</code> tenant.
        </div></li><li class="listitem"><div class="para">
          Create the <code class="systemitem">neutron</code> service entry and assign it an endpoint.
        </div></li></ol></div>

  </div><div class="para">
    These entries will assist other OpenStack services attempting to locate and access the networking functionality provided by the OpenStack Networking service:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Authenticate as the administrator of the identity service by running the <code class="command">source</code> command on the <code class="filename">keystonerc_admin</code> file containing the required credentials:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Create a user named <code class="literal">neutron</code> for the OpenStack networking service to use:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-create --name neutron --pass <em class="replaceable"><code>PASSWORD</code></em></code></code></strong>
+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|  email   |                                  |
| enabled  |               True               |
|    id    | <em class="replaceable"><code>1df18bcd14404fa9ad954f9d5eb163bc</code></em> |
|   name   |              neutron             |
| tenantId |                                  |
+----------+----------------------------------+
</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used by the OpenStack networking service when authenticating with the identity service. Take note of the created user's returned ID as it will be used in subsequent steps.
      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="literal">admin</code> role:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone role-get admin</code></code></strong></pre><div class="para">
        If no <code class="systemitem">admin</code> role exists, create one:
<pre class="screen">$ keystone role-create --name admin</pre>

      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="systemitem">services</code> tenant:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-list | grep services</code></strong></pre><div class="para">
        If no <code class="systemitem">services</code> tenant exists, create one:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-create --name services --description &quot;Services Tenant&quot; </code></strong></pre><div class="para">
        This guide uses one tenant for all service users. For more information, refer to <em class="citetitle">Creating the Services Tenant</em>.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone user-role-add</code> command to link the <code class="literal">neutron</code> user, <code class="literal">admin</code> role, and <code class="literal">services</code> tenant together:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-role-add --user-id <em class="replaceable"><code>USERID</code></em> --role-id <em class="replaceable"><code>ROLEID</code></em> --tenant-id <em class="replaceable"><code>TENANTID</code></em></code></code></strong></pre><div class="para">
        Replace the user, role, and tenant IDs with those obtained in the previous steps.
      </div></li><li class="step"><div class="para">
        Create the <code class="literal">neutron</code> service entry:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone service-create --name neutron \</code></code></strong>
        <strong class="userinput"><code><code class="command">--type network \</code></code></strong>
        <strong class="userinput"><code><code class="command">--description &quot;OpenStack Networking Service&quot;</code></code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |   OpenStack Networking Service   |
|      id     | <em class="replaceable"><code>134e815915f442f89c39d2769e278f9b</code></em> |
|     name    |              neutron             |
|     type    |              network             |
+-------------+----------------------------------+</pre><div class="para">
        Take note of the created service's returned ID as it will be used in the next step.
      </div></li><li class="step"><div class="para">
        Create the <code class="literal">network</code> endpoint entry:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone endpoint-create --service-id <em class="replaceable"><code>SERVICEID</code></em> \</code></code></strong>
        <strong class="userinput"><code><code class="command">--publicurl &quot;http://<em class="replaceable"><code>IP</code></em>:9696&quot; /</code></code></strong>
        <strong class="userinput"><code><code class="command">--adminurl &quot;http://<em class="replaceable"><code>IP</code></em>:9696&quot; /</code></code></strong>
        <strong class="userinput"><code><code class="command">--internalurl &quot;http://<em class="replaceable"><code>IP</code></em>:9696&quot;</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>SERVICEID</code></em> with the ID returned by the <code class="command">keystone service-create</code> command. Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the system that will be acting as the network node.
      </div></li></ol></div><div class="para">
    All supporting identity service entries required by the OpenStack networking service have been created.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15909-550060+%5BLatest%5D&amp;cf_build_id=15909-550060+01+Nov+2013+09%3A52+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+OpenStack+Networking+Identity+Records%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Common_Networking_Configuration"></a>13.3.&nbsp;Common Networking Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Upgrading_the_Kernel"></a>13.3.1.&nbsp;Upgrading the Kernel</h3></div></div></div><div class="para">
    Red Hat Enterprise Linux OpenStack Platform includes a custom Red Hat Enterprise Linux kernel that supports the use of network namespaces. This kernel <span class="bold bold"><strong>must</strong></span> be installed on nodes that will handle OpenStack networking traffic. Additionally the Open vSwitch plug-in will not work with kernels with versions lower than <code class="literal">2.6.32-<em class="replaceable"><code>343</code></em>.el6.x86_64</code>.
  </div><div class="para">
    Follow the steps listed in this procedure on each node in the environment that will handle OpenStack networking traffic. You must log in to each node as the <code class="systemitem">root</code> user to complete the procedure.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">uname</code> command to identify the kernel that is currently in use on the system.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">uname --kernel-release</code></code></strong></pre><ul class="stepalternatives">
        <li class="step"><div class="para">
            If the output includes the text <code class="literal">openstack</code> then the system already has a network namespaces enabled kernel.
          </div><pre class="screen">2.6.32-<em class="replaceable"><code>358</code></em>.6.2.<span class="bold bold"><strong>openstack</strong></span>.el6.x86_64</pre><div class="para">
            No further action is required to install a network namespaces enabled kernel on this system.
          </div></li>
         <li class="step"><div class="para">
            If the output does <span class="bold bold"><strong>not</strong></span> include the text <code class="literal">openstack</code> then the system does not currently have a network namespaces enabled kernel and further action must be taken.
          </div><pre class="screen">2.6.32-<em class="replaceable"><code>358</code></em>.el6.x86_64</pre><div class="para">
            Further action is required to install a network namespaces enabled kernel on this system. Follow the remaining steps outlined in this procedure to perform this task.
          </div></li>

      </ul><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          Note that the release field may contain a higher value than <em class="replaceable"><code>358</code></em>. As new kernel updates are released this value is increased.
        </div></div></div></li><li class="step"><div class="para">
        Install the updated kernel with network namespaces support using the <code class="command">yum</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install &quot;kernel-2.6.*.openstack.el6.x86_64&quot;</code></code></strong></pre><div class="para">
        The use of the wildcard character (<span class="keycap"><strong>*</strong></span>) ensures that the latest kernel release available will be installed.
      </div></li><li class="step"><div class="para">
        Reboot the system to ensure that the new kernel is running before proceeding with OpenStack networking installation.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">reboot</code></code></strong></pre></li><li class="step"><div class="para">
        Run the <code class="command">uname</code> command again once the system has rebooted to confirm that the newly installed kernel is running.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">uname --kernel-release</code></code></strong>
2.6.32-<em class="replaceable"><code>358</code></em>.6.2.<span class="bold bold"><strong>openstack</strong></span>.el6.x86_64</pre></li></ol></div><div class="para">
    The system is now running a kernel with network namespaces support, enabling advanced OpenStack networking configurations.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17916-541150+%5BLatest%5D&amp;cf_build_id=17916-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Upgrading+the+Kernel%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Disabling_Network_Manager"></a>13.3.2.&nbsp;Disabling Network Manager</h3></div></div></div><div class="para">
    OpenStack networking currently does not work on systems that have the Network Manager (<code class="systemitem">NetworkManager</code>) service enabled. The Network Manager service is currently enabled by default on Red Hat Enterprise Linux installations where one of these package groups was selected during installation:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Desktop
      </div></li><li class="listitem"><div class="para">
        Software Development Workstation
      </div></li></ul></div><div class="para">
    The Network Manager service is <span class="bold bold"><strong>not</strong></span> currently enabled by default on Red Hat Enterprise Linux installations where one of these package groups was selected during installation:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Basic Server
      </div></li><li class="listitem"><div class="para">
        Database Server
      </div></li><li class="listitem"><div class="para">
        Web Server
      </div></li><li class="listitem"><div class="para">
        Identity Management Server
      </div></li><li class="listitem"><div class="para">
        Virtualization Host
      </div></li><li class="listitem"><div class="para">
        Minimal Install
      </div></li></ul></div><div class="para">
    Follow the steps listed in this procedure while logged in as the <code class="systemitem">root</code> user on each system in the environment that will handle network traffic. This includes the system that will host the OpenStack Networking service, all network nodes, and all compute nodes.
  </div><div class="para">
    These steps ensure that the <code class="systemitem">NetworkManager</code> service is disabled and replaced by the standard network service for all interfaces that will be used by OpenStack Networking.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Verify Network Manager is currently enabled using the <code class="command">chkconfig</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig --list NetworkManager</code></code></strong></pre><div class="para">
        The output displayed by the <code class="command">chkconfig</code> command inicates whether or not the Network Manager service is enabled.
      </div><ul class="stepalternatives">
        <li class="step"><div class="para">
            The system displays an error if the Network Manager service is not currently installed:
          </div><pre class="screen">error reading information on service NetworkManager: No such file or directory</pre><div class="para">
            If this error is displayed then no further action is required to disable the Network Manager service.
          </div></li>
         <li class="step"><div class="para">
            The system displays a list of numerical run levels along with a value of <code class="literal">on</code> or <code class="literal">off</code> indicating whether the Network Manager service is enabled when the system is operating in the given run level.
          </div><pre class="screen">NetworkManager  0:off 1:off 2:off 3:off 4:off 5:off 6:off</pre><div class="para">
            If the value displayed for all run levels is <code class="literal">off</code> then the Network Manager service is disabled and no further action is required. If the value displayed for any of the run levels is <code class="literal">on</code> then the Network Manager service is enabled and further action is required.
          </div></li>

      </ul></li><li class="step"><div class="para">
        Ensure that the Network Manager service is stopped using the <code class="command">service</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service NetworkManager stop</code></code></strong></pre></li><li class="step"><div class="para">
        Ensure that the Network Manager service is disabled using the <code class="command">chkconfig</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig NetworkManager off</code></code></strong></pre></li><li class="step"><div class="para">
        Open each interface configuration file on the system in a text editor. Interface configuration files are found in the <code class="filename">/etc/sysconfig/network-scripts/</code> directory and have names of the form <code class="filename">ifcfg-<em class="replaceable"><code>X</code></em></code> where <em class="replaceable"><code>X</code></em> is replaced by the name of the interface. Valid interface names include <code class="literal">eth0</code>, <code class="literal">p1p5</code>, and <code class="literal">em1</code>.
      </div><div class="para">
        In each file ensure that the <code class="literal">NM_CONTROLLED</code> configuration key is set to <code class="literal">no</code> and the <code class="literal">ON_BOOT</code> configuration key is set to <code class="literal">yes</code>.
      </div><pre class="screen">NM_CONTROLLED=no
ONBOOT=yes</pre><div class="para">
        This action ensures that the standard network service will take control of the interfaces and automatically activate them on boot.
      </div></li><li class="step"><div class="para">
        Ensure that the network service is started using the <code class="command">service</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service network start</code></code></strong></pre></li><li class="step"><div class="para">
        Ensure that the network service is enabled using the <code class="command">chkconfig</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig network on</code></code></strong></pre></li></ol></div><div class="para">
    The Network Manager service has been disabled. The standard network service has been enabled and configured to control the required network interfaces.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17685-541150+%5BLatest%5D&amp;cf_build_id=17685-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Disabling+Network+Manager%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Installing_the_Packages3"></a>13.3.3.&nbsp;Installing the Packages</h3></div></div></div><div class="para">
    The OpenStack Networking service requires the following packages:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">openstack-neutron</span></span></dt><dd><div class="para">
          Provides the networking service and associated configuration files.
        </div></dd><dt><span class="term"><span class="package">openstack-neutron-<em class="replaceable"><code>PLUGIN</code></em></span></span></dt><dd><div class="para">
          Provides a networking plug-in. Replace <em class="replaceable"><code>PLUGIN</code></em> with one of the recommended plug-ins (<code class="literal">openvswitch</code> and <code class="literal">linuxbridge</code>).
        </div></dd><dt><span class="term"><span class="package">openstack-utils</span></span></dt><dd><div class="para">
          Provides supporting utilities to assist with a number of tasks including the editing of configuration files.
        </div></dd><dt><span class="term"><span class="package">openstack-selinux</span></span></dt><dd><div class="para">
          Provides OpenStack specific SELinux policy modules.
        </div></dd></dl></div><div class="para">
    The packages must be installed on all systems that will handle network traffic. This includes the OpenStack Networking service node, all network nodes, and all Compute nodes.
  </div><div class="para">
    To install all of the above packages, execute the following command while logged in as the <code class="systemitem">root</code> user:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y openstack-neutron \</code></code></strong>
   <strong class="userinput"><code><code class="command">openstack-neutron-<em class="replaceable"><code>PLUGIN</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">openstack-utils \</code></code></strong>
   <strong class="userinput"><code><code class="command">openstack-selinux</code></code></strong></pre>

  </div><div class="para">
    Replace <em class="replaceable"><code>PLUGIN</code></em> with <code class="literal">openvswitch</code> or <code class="literal">linuxbridge</code> (determines which plug-in is installed).
  </div><div class="para">
    The networking services are installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15885-550061+%5BLatest%5D&amp;cf_build_id=15885-550061+01+Nov+2013+09%3A53+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Firewall4"></a>13.3.4.&nbsp;Configuring the Firewall</h3></div></div></div><div class="para">
    Systems attempting to use the functionality provided by the networking service access it over the network using port <code class="literal">9696</code>.
  </div><div class="para">
    To allow this the firewall on the service node must be altered to allow network traffic on this port. All steps in this procedure must be run while logged in to the server hosting the image storage service as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
      </div></li><li class="step"><div class="para">
        Add an INPUT rule allowing TCP traffic on port <code class="literal">9696</code> to the file. The new rule must appear before any INPUT rules that REJECT traffic.
      </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 9696 -j ACCEPT</pre></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
      </div></li><li class="step"><div class="para">
        Restart the <code class="command">iptables</code> service to ensure that the change takes effect.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">iptables</code> firewall is now configured to allow incoming connections to the networking service on port <code class="literal">9696</code>.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15900-541150+%5BLatest%5D&amp;cf_build_id=15900-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_the_Networking_Service1"></a>13.4.&nbsp;Configuring the Networking Service</h2></div></div></div><div class="itemizedlist prereqs-list"><p class="title"><strong>Prerequisites:</strong></p><ul class="prereqs-list prereqs-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Networking_Configuration">Section&nbsp;13.3, “Common Networking Configuration”</a>
      </div></li></ul></div><div class="para">
    The configuration of the OpenStack Networking service is contained in the <code class="filename">/etc/neutron/neutron.conf</code> file.
  </div><div class="para">
    Repeat these configuration steps on each node that will host an instance of the OpenStack Networking service while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Setting the Identity Values</strong></p><div class="para">
        The Networking service must be explicitly configured to use the Identity service for authentication.
      </div><ol class="a"><li class="step"><div class="para">
            Set the authentication strategy (<code class="literal">auth_strategy</code>) configuration key to <code class="literal">keystone</code> using the <code class="command">openstack-config</code> command.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT auth_strategy keystone</code></code></strong></pre></li><li class="step"><div class="para">
            Set the authentication host (<code class="literal">auth_host</code> configuration key) to the IP address or host name of the Identity server.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken auth_host <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the Identity server.
          </div></li><li class="step"><div class="para">
            Set the administration tenant name (<code class="literal">admin_tenant_name</code>) configuration key to the name of the tenant that was created for the use of the Networking service. Examples in this guide use <em class="replaceable"><code>services</code></em>.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></code></strong></pre></li><li class="step"><div class="para">
            Set the administration user name (<code class="literal">admin_user</code>) configuration key to the name of the user that was created for the use of the networking services. Examples in this guide use <em class="replaceable"><code>neutron</code></em>.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_user <em class="replaceable"><code>neutron</code></em></code></code></strong></pre></li><li class="step"><div class="para">
            Set the administration password (<code class="literal">admin_password</code>) configuration key to the password that is associated with the user specified in the previous step.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre></li></ol><div class="para">
        The authentication keys used by the Networking service have been set and will be used when the services are started.
      </div></li><li class="step"><p class="title"><strong>Setting the Message Broker</strong></p><div class="para">
        The Networking service must be explicitly configured with the type, location, and authentication details of the message broker.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">rpc_backend</code> configuration key to Qpid.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT rpc_backend neutron.openstack.common.rpc.impl_qpid</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_hostname</code> configuration key to the host name of the Qpid server.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_hostname <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the message broker.
          </div></li><li class="step"><div class="para">
            If you have configured Qpid to authenticate incoming connections, you must provide the details of a valid Qpid user in the networking configuration.
          </div><ol class="i"><li class="step"><div class="para">
                Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_username</code> configuration key to the username of the Qpid user that the Networking service must use when communicating with the message broker.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_username <em class="replaceable"><code>USERNAME</code></em></code></code></strong></pre><div class="para">
                Replace <em class="replaceable"><code>USERNAME</code></em> with the required Qpid user name.
              </div></li><li class="step"><div class="para">
                Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_password</code> configuration key to the password of the Qpid user that the Networking service must use when communicating with the message broker.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre><div class="para">
                Replace <em class="replaceable"><code>PASSWORD</code></em> with the password of the Qpid user.
              </div></li></ol></li><li class="step"><div class="para">
            If you configured Qpid to use SSL, you must inform the Networking service of this choice. Use <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_protocol</code> configuration key to <code class="literal">ssl</code>.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_protocol ssl</code></code></strong></pre><div class="para">
            The value of the <code class="literal">qpid_port</code> configuration key must be set to <code class="literal">5671</code> as Qpid listens on this different port when SSL is in use.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_port 5671</code></code></strong></pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
              To communicate with a Qpid message broker that uses SSL the node must also have:
            </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
                  The <span class="package">nss</span> package installed.
                </div></li><li class="listitem"><div class="para">
                  The certificate of the relevant certificate authority installed in the system NSS database (<code class="filename">/etc/pki/nssdb/</code>).
                </div></li></ul></div><div class="para">
              The <code class="command">certtool</code> command is able to import certificates into the NSS database. See the <code class="command">certtool</code> manual page for more information (<code class="command">man certtool</code>).
            </div></div></div></li></ol><div class="para">
        The OpenStack Networking service has been configured to use the message broker and any authentication schemes that it presents.
      </div></li><li class="step"><p class="title"><strong>Setting the Plug-in</strong></p><div class="para">
        Additional configuration settings must be applied to enable the desired plug-in.
      </div><ul class="stepalternatives">
        <li class="step"><p class="title"><strong>Open vSwitch</strong></p><ol class="a"><li class="step"><div class="para">
                Create a symbolic link between the <code class="filename">/etc/neutron/plugin.ini</code> path referred to by the Networking service and the plug-in specific configuration file.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">ln -s /etc/neutron/plugins/openvswitch/ovs_neutron_plugin.ini \</code></code></strong>
         <strong class="userinput"><code><code class="command">/etc/neutron/plugin.ini</code></code></strong></pre></li><li class="step"><div class="para">
                Update the value of the <code class="literal">tenant_network_type</code> configuration key in the <code class="filename">/etc/neutron/plugin.ini</code> file to refer to the type of network that must be used for tenant networks. Supported values are <code class="literal">flat</code>, <code class="literal">vlan</code>, and <code class="literal">local</code>.
              </div><div class="para">
                The default is <code class="literal">local</code> but this is not recommended for real deployments.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/plugin.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">OVS tenant_network_type <em class="replaceable"><code>TYPE</code></em></code></code></strong></pre><div class="para">
                Replace <em class="replaceable"><code>TYPE</code></em> with the type chosen tenant network type.
              </div></li><li class="step"><div class="para">
                If <code class="literal">flat</code> or <code class="literal">vlan</code> networking was chosen, the value of the <code class="literal">network_vlan_ranges</code> configuration key must also be set. This configuration key maps physical networks to VLAN ranges.
              </div><div class="para">
                Mappings are of the form <em class="replaceable"><code>NAME</code></em>:<em class="replaceable"><code>START</code></em>:<em class="replaceable"><code>END</code></em> where <em class="replaceable"><code>NAME</code></em> is replaced by the name of the physical network, <em class="replaceable"><code>START</code></em> is replaced by the VLAN identifier that starts the range, and <em class="replaceable"><code>END</code></em> is replaced by the replaced by the VLAN identifier that ends the range.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/plugin.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">OVS network_vlan_ranges <em class="replaceable"><code>NAME</code></em>:<em class="replaceable"><code>START</code></em>:<em class="replaceable"><code>END</code></em></code></code></strong></pre><div class="para">
                Multiple ranges can be specified using a comma separated list, for example:
              </div><pre class="screen">physnet1:1000:2999,physnet2:3000:3999</pre></li><li class="step"><div class="para">
                Update the value of the <code class="literal">core_plugin</code> configuration key in the <code class="filename">/etc/neutron/neutron.conf</code> file to refer to the Open vSwitch plug-in.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT core_plugin \</code></code></strong>
   <strong class="userinput"><code><code class="command">neutron.plugins.openvswitch.ovs_neutron_plugin.OVSNeutronPluginV2</code></code></strong></pre></li></ol></li>
         <li class="step"><p class="title"><strong>Linux Bridge</strong></p><ol class="a"><li class="step"><div class="para">
                Create a symbolic link between the <code class="filename">/etc/neutron/plugin.ini</code> path referred to by the Networking service and the plug-in specific configuration file.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">ln -s /etc/neutron/plugins/linuxbridge/linuxbridge_conf.ini \</code></code></strong>
         <strong class="userinput"><code><code class="command">/etc/neutron/plugin.ini</code></code></strong></pre></li><li class="step"><div class="para">
                Update the value of the <code class="literal">tenant_network_type</code> configuration key in the <code class="filename">/etc/neutron/plugin.ini</code> file to refer to the type of network that must be used for tenant networks. Supported values are <code class="literal">flat</code>, <code class="literal">vlan</code>, and <code class="literal">local</code>.
              </div><div class="para">
                The default is <code class="literal">local</code> but this is not recommended for real deployments.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/plugin.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">VLAN tenant_network_type <em class="replaceable"><code>TYPE</code></em></code></code></strong></pre><div class="para">
                Replace <em class="replaceable"><code>TYPE</code></em> with the type chosen tenant network type.
              </div></li><li class="step"><div class="para">
                If <code class="literal">flat</code> or <code class="literal">vlan</code> networking was chosen, the value of the <code class="literal">network_vlan_ranges</code> configuration key must also be set. This configuration key maps physical networks to VLAN ranges.
              </div><div class="para">
                Mappings are of the form <em class="replaceable"><code>NAME</code></em>:<em class="replaceable"><code>START</code></em>:<em class="replaceable"><code>END</code></em> where <em class="replaceable"><code>NAME</code></em> is replaced by the name of the physical network, <em class="replaceable"><code>START</code></em> is replaced by the VLAN identifier that starts the range, and <em class="replaceable"><code>END</code></em> is replaced by the replaced by the VLAN identifier that ends the range.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/plugin.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">LINUX_BRIDGE network_vlan_ranges <em class="replaceable"><code>NAME</code></em>:<em class="replaceable"><code>START</code></em>:<em class="replaceable"><code>END</code></em></code></code></strong></pre><div class="para">
                Multiple ranges can be specified using a comma separated list, for example:
              </div><pre class="screen">physnet1:1000:2999,physnet2:3000:3999</pre></li><li class="step"><div class="para">
                Update the value of the <code class="literal">core_plugin</code> configuration key in the <code class="filename">/etc/neutron/neutron.conf</code> file to refer to the Linux Bridge plug-in.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/neutron.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT core_plugin \</code></code></strong>
   <strong class="userinput"><code><code class="command">neutron.plugins.linuxbridge.lb_neutron_plugin.LinuxBridgePluginV2</code></code></strong></pre></li></ol></li>

      </ul></li><li class="step"><p class="title"><strong>Setting the Database Connection String</strong></p><div class="para">
        The database connection string used by the networking service is defined in the <code class="filename">/etc/neutron/plugin.ini</code> file. It must be updated to point to a valid database server before starting the service.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">openstack-config</code> command to set the value of the <code class="literal">connection</code> configuration key.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/plugin.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DATABASE sql_connection mysql://<em class="replaceable"><code>USER</code></em>:<em class="replaceable"><code>PASS</code></em>@<em class="replaceable"><code>IP</code></em>/<em class="replaceable"><code>DB</code></em></code></code></strong></pre><div class="para">
            Replace:
            <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                  <em class="replaceable"><code>USER</code></em> with the database user name the networking service is to use, usually <code class="literal">neutron</code>.
                </div></li><li class="listitem"><div class="para">
                  <em class="replaceable"><code>PASS</code></em> with the password of the chosen database user.
                </div></li><li class="listitem"><div class="para">
                  <em class="replaceable"><code>IP</code></em> with the IP address or host name of the database server.
                </div></li><li class="listitem"><div class="para">
                  <em class="replaceable"><code>DB</code></em> with the name of the database that has been created for use by the networking service (<code class="systemitem">ovs_neutron</code> was used as the example in the previous <em class="citetitle">Creating the OpenStack Networking Database</em> section).
                </div></li></ul></div>

          </div></li></ol></li><li class="step"><p class="title"><strong>Start the Networking Service</strong></p><ol class="a"><li class="step"><div class="para">
            Start the OpenStack Networking service using the <code class="command">service</code> command.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service neutron-server start</code></code></strong></pre></li><li class="step"><div class="para">
            Enable the Networking service permanantly using the <code class="command">chkconfig</code> command.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig neutron-server on</code></code></strong></pre></li></ol></li></ol></div><div class="para">
    The OpenStack Networking service is configured and running. Further action is however required to configure and run the various networking agents that are also fundamental to providing networking functionality.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      By default, OpenStack Networking does not enforce Classless Inter-Domain Routing (CIDR) checking of IP addresses. This is to maintain backwards compatibility with previous releases. If you require such checks set the value of the <code class="literal">force_gateway_on_subnet</code> configuration key to <code class="literal">True</code> in the <code class="filename">/etc/neutron/neutron.conf</code> file.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16833-550062+%5BLatest%5D&amp;cf_build_id=16833-550062+01+Nov+2013+09%3A55+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Networking+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_the_DHCP_Agent"></a>13.5.&nbsp;Configuring the DHCP Agent</h2></div></div></div><div class="itemizedlist prereqs-list"><p class="title"><strong>Prerequisites:</strong></p><ul class="prereqs-list prereqs-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Networking_Configuration">Section&nbsp;13.3, “Common Networking Configuration”</a>
      </div></li></ul></div><div class="para">
    Follow the steps listed in this procedure to configure the DHCP Agent. All steps listed in this procedure must be performed on the network node while logged in as the <code class="systemitem">root</code> user on the system hosting the DHCP agent.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Configuring Authentication</strong></p><div class="para">
        The DHCP agent must be explicitly configured to use the identity service for authentication.
      </div><ol class="a"><li class="step"><div class="para">
            Set the authentication strategy (<code class="literal">auth_strategy</code>) configuration key to <code class="literal">keystone</code> using the <code class="command">openstack-config</code> command.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/dhcp_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT auth_strategy keystone</code></code></strong></pre></li><li class="step"><div class="para">
            Set the authentication host (<code class="literal">auth_host</code> configuration key) to the IP address or host name of the identity server.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/dhcp_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken auth_host <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the identity server.
          </div></li><li class="step"><div class="para">
            Set the administration tenant name (<code class="literal">admin_tenant_name</code>) configuration key to the name of the tenant that was created for the use of the networking services. Examples in this guide use <em class="replaceable"><code>services</code></em>.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/dhcp_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></code></strong></pre></li><li class="step"><div class="para">
            Set the administration user name (<code class="literal">admin_user</code>) configuration key to the name of the user that was created for the use of the networking services. Examples in this guide use <em class="replaceable"><code>neutron</code></em>.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/dhcp_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_user <em class="replaceable"><code>neutron</code></em></code></code></strong></pre></li><li class="step"><div class="para">
            Set the administration password (<code class="literal">admin_password</code>) configuration key to the password that is associated with the user specified in the previous step.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/dhcp_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Configuring the Interface Driver</strong></p><div class="para">
        Set the value of the <code class="literal">interface_driver</code> configuration key in the <code class="filename">/etc/neutron/dhcp_agent.ini</code> file based on the networking plug-in being used. Execute only the configuration step that applies to the plug-in used in your environment.
      </div><ul class="stepalternatives">
        <li class="step"><p class="title"><strong>Open vSwitch Interface Driver</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/dhcp_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT interface_driver neutron.agent.linux.interface.OVSInterfaceDriver</code></code></strong></pre></li>
         <li class="step"><p class="title"><strong>Linux Bridge Interface Driver</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/dhcp_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT interface_driver neutron.agent.linux.interface.BridgeInterfaceDriver</code></code></strong></pre></li>

      </ul></li><li class="step"><p class="title"><strong>Starting the DHCP Agent</strong></p><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">neutron-dhcp-agent</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service neutron-dhcp-agent start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to ensure that the <code class="systemitem">neutron-dhcp-agent</code> service will be started automatically in the future.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig neutron-dhcp-agent on</code></code></strong></pre></li></ol></li></ol></div><div class="para">
    The DHCP agent has been configured and started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16773-550063+%5BLatest%5D&amp;cf_build_id=16773-550063+01+Nov+2013+09%3A56+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+DHCP+Agent%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_a_Provider_Network1"></a>13.6.&nbsp;Configuring a Provider Network</h2></div></div></div><div class="itemizedlist prereqs-list"><p class="title"><strong>Prerequisites:</strong></p><ul class="prereqs-list prereqs-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Networking_Configuration">Section&nbsp;13.3, “Common Networking Configuration”</a>
      </div></li></ul></div><div class="para">
    OpenStack networking provides two mechanisms for connecting the Layer 3 (L3) agent to an external network. The first, attaching it to an external bridge (<code class="literal">br-ex</code>) directly, is only supported when the Open vSwitch plug-in is in use. The second method, which is supported by both the Open vSwitch plug-in and the Linux Bridge plug-in, is to use an external provider network.
  </div><div class="para">
    To use an external provider network it is first necessary to create one. Follow the steps outlined in this procedure while logged in to a system with the OpenStack networking client - provided by the <span class="package">python-neutronclient</span> package installed. You must also have access to a <code class="literal">keystonerc_admin</code> file containing the authentication details of the OpenStack administrative user.
  </div><div class="para">
    Take note of the unique identifiers generated by the steps listed in this procedure. These identifiers will be required when configuring the L3 agent.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">source</code> command to load the credentials of the administrative user.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">source <em class="replaceable"><code>~/keystonerc_admin</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">net-create</code> action of the <code class="command">neutron</code> command line client to create a new provider network.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">neutron net-create <em class="replaceable"><code>EXTERNAL_NAME</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">--router:external True \</code></code></strong>
   <strong class="userinput"><code><code class="command">--provider:network_type <em class="replaceable"><code>TYPE</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">--provider:physical_network <em class="replaceable"><code>PHYSICAL_NAME</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">--provider:segmentation_id <em class="replaceable"><code>VLAN_TAG</code></em></code></code></strong></pre><div class="para">
        Replace these strings with the appropriate values for your environment:
      </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>EXTERNAL_NAME</code></em> with a name for the new external network provider.
          </div></li><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>PHYSICAL_NAME</code></em> with a name for the physical network. This is not applicable if you intend to use a local network type.
          </div></li><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>TYPE</code></em> with the type of provider network you wish to use. Supported values are <code class="literal">flat</code> (for flat networks), <code class="literal">vlan</code> (for VLAN networks), and <code class="literal">local</code> (for local networks).
          </div></li><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>VLAN_TAG</code></em> with the VLAN tag that will be used to identify network traffic. The VLAN tag specified must have been defined by the network administrator.
          </div><div class="para">
            If the <code class="literal">network_type</code> was set to a value other than <code class="literal">vlan</code> then this parameter is not required.
          </div></li></ul></div><div class="para">
        Take note of the unique external network identifier returned, this will be required in subsequent steps.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">subnet-create</code> action of the command line client to create a new subnet for the new external provider network.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">neutron subnet-create --gateway <em class="replaceable"><code>GATEWAY</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">--allocation-pool start=<em class="replaceable"><code>IP_RANGE_START</code></em>,end=<em class="replaceable"><code>IP_RANGE_END</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">--disable-dhcp <em class="replaceable"><code>EXTERNAL_NAME</code></em> <em class="replaceable"><code>EXTERNAL_CIDR</code></em></code></code></strong></pre><div class="para">
        Replace these strings with the appropriate values for your environment:
      </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>GATEWAY</code></em> with the IP address or hostname of the system that is to act as the gateway for the new subnet.
          </div></li><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>IP_RANGE_START</code></em> with the IP address that denotes the start of the range of IP addresses within the new subnet that floating IP addresses will be allocated from.
          </div></li><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>IP_RANGE_END</code></em> with the IP address that denotes the end of the range of IP addresses within the new subnet that floating IP addresses will be allocated from.
          </div></li><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>EXTERNAL_NAME</code></em> with the name of the external network the subnet is to be associated with. This must match the name that was provided to the <code class="command">net-create</code> action in the previous step.
          </div></li><li class="listitem"><div class="para">
            Replace <em class="replaceable"><code>EXTERNAL_CIDR</code></em> with the Classless Inter-Domain Routing (CIDR) representation of the block of IP addresses the subnet represents. An example would be <code class="literal">192.168.100.0/24</code>.
          </div></li></ul></div><div class="para">
        Take note of the unique subnet identifier returned, this will be required in subsequent steps.
      </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          The IP address used to replace the string <em class="replaceable"><code>GATEWAY</code></em> <span class="bold bold"><strong>must</strong></span> be within the block of IP addresses specified in place of the <em class="replaceable"><code>EXTERNAL_CIDR</code></em> string but outside of the block of IP addresses specified by the range started by <em class="replaceable"><code>IP_RANGE_START</code></em> and ended by <em class="replaceable"><code>IP_RANGE_END</code></em>.
        </div><div class="para">
          The block of IP addresses specifed by the range started by <em class="replaceable"><code>IP_RANGE_START</code></em> and ended by <em class="replaceable"><code>IP_RANGE_END</code></em> <span class="bold bold"><strong>must</strong></span> also fall within the block of IP addresses specified by <em class="replaceable"><code>EXTERNAL_CIDR</code></em>.
        </div></div></div></li><li class="step"><div class="para">
        Use the <code class="command">router-create</code> action of the <code class="command">neutron</code> command line client to create a new router.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">neutron router-create <em class="replaceable"><code>NAME</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>NAME</code></em> with the name to give the new router. Take note of the unique router identifier returned, this will be required in subsequent steps.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">router-gateway-set</code> action of the <code class="command">neutron</code> command line client to link the newly created router to the external provider network.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">neutron router-gateway-set <em class="replaceable"><code>ROUTER</code></em> <em class="replaceable"><code>NETWORK</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>ROUTER</code></em> with the unique identifier of the router, replace <em class="replaceable"><code>NETWORK</code></em> with the unique identifier of the external provider network.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">router-interface-add</code> action of the <code class="command">neutron</code> command line client to link the newly created router to the subnet.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">neutron router-interface-add <em class="replaceable"><code>ROUTER</code></em> <em class="replaceable"><code>SUBNET</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>ROUTER</code></em> with the unique identifier of the router, replace <em class="replaceable"><code>SUBNET</code></em> with the unique identifier of the subnet.
      </div></li></ol></div><div class="para">
    An external provider network has been created. Use the unique identifier of the router when configuring the L3 agent.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17918-550064+%5BLatest%5D&amp;cf_build_id=17918-550064+01+Nov+2013+09%3A57+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+a+Provider+Network%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuring_the_Plug-in_Agent"></a>13.7.&nbsp;Configuring the Plug-in Agent</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Open_vSwitch_Plug-in"></a>13.7.1.&nbsp;Configuring the Open vSwitch Plug-in Agent</h3></div></div></div><div class="itemizedlist prereqs-list"><p class="title"><strong>Prerequisites:</strong></p><ul class="prereqs-list prereqs-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Networking_Configuration">Section&nbsp;13.3, “Common Networking Configuration”</a>
      </div></li></ul></div><div class="para">
    The Open vSwitch plug-in has a corresponding agent. When the Open vSwitch plug-in is in use all nodes in the environment that handle data packets must have the agent installed and configured.
  </div><div class="para">
    This includes all compute nodes and systems hosting the dedicated DHCP and L3 agents.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Confirm that the <span class="package">openvswitch</span> package is installed. This is normally installed as a dependency of the <span class="package">neutron-plugin-openvswitch</span> package.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">rpm -qa | grep openvswitch</code></code></strong>
openvswitch-<em class="replaceable"><code>1.10.0-1.</code></em>el6.x86_64
openstack-neutron-openvswitch-<em class="replaceable"><code>2013.1-3</code></em>.el6.noarc</pre></li><li class="step"><div class="para">
        Start the <code class="command">openvswitch</code> service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openvswitch start</code></code></strong></pre></li><li class="step"><div class="para">
        Enable the <code class="command">openvswitch</code> service permanently.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openvswitch on</code></code></strong></pre></li><li class="step"><div class="para">
        Each host running the Open vSwitch agent also requires an Open vSwitch bridge named <code class="literal">br-int</code>. This bridge is used for private network traffic. Use the <code class="command">ovs-vsctl</code> command to create this bridge before starting the agent.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>ovs-vsctl add-br br-int</code></strong></pre><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
          The <code class="literal">br-int</code> bridge is required for the agent to function correctly. Once created do not remove or otherwise modify the <code class="literal">br-int</code> bridge.
        </div></div></div></li><li class="step"><div class="para">
        Ensure that the <code class="literal">br-int</code> device persists on reboot by creating a <code class="filename">/etc/sysconfig/network-scripts/ifcfg-br-int</code> file with these contents:
      </div><pre class="programlisting">DEVICE=br-int
DEVICETYPE=ovs
TYPE=OVSBridge
ONBOOT=yes
BOOTPROTO=none</pre></li><li class="step"><div class="para">
        Set the value of the <code class="literal">bridge_mappings</code> configuration key. This configuration key must contain a list of physical networks and the network bridges associated with them.
      </div><div class="para">
        The format for each entry in the comma separated list is:
<pre class="screen"><em class="replaceable"><code>PHYSNET</code></em>:<em class="replaceable"><code>BRIDGE</code></em></pre>
         Where <em class="replaceable"><code>PHYSNET</code></em> is replaced with the name of a physical network, and <em class="replaceable"><code>BRIDGE</code></em> is replaced by by the name of the network bridge.
      </div><div class="para">
        The physical network must have been defined in the <code class="literal">network_vlan_ranges</code> configuration variable on the OpenStack Networking server.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/neutron/plugin.ini \</code></strong>
   <strong class="userinput"><code>OVS bridge_mappings <em class="replaceable"><code>MAPPINGS</code></em></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>MAPPINGS</code></em> with the physical network to bridge mappings.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">service</code> command to start the <code class="systemitem">neutron-openvswitch-agent</code> service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code> service neutron-openvswitch-agent start</code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chkconfig</code> command to ensure that the <code class="systemitem">neutron-openvswitch-agent</code> service is started automatically in the future.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chkconfig neutron-openvswitch-agent on</code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chkconfig</code> command to ensure that the <code class="systemitem">neutron-ovs-cleanup</code> service is started automatically on boot. When started at boot time this service ensures that the OpenStack Networking agents maintain full control over the creation and management of tap devices.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>chkconfig neutron-ovs-cleanup on</code></strong></pre></li></ol></div><div class="para">
    The networking configuration has been updated to use the Open vSwitch plug-in.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16753-550065+%5BLatest%5D&amp;cf_build_id=16753-550065+01+Nov+2013+09%3A58+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Open+vSwitch+Plug-in+Agent%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Linux_Bridge_Plug-in"></a>13.7.2.&nbsp;Configuring the Linux Bridge Plug-in Agent</h3></div></div></div><div class="itemizedlist prereqs-list"><p class="title"><strong>Prerequisites:</strong></p><ul class="prereqs-list prereqs-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Networking_Configuration">Section&nbsp;13.3, “Common Networking Configuration”</a>
      </div></li></ul></div><div class="para">
    The Linux Bridge plug-in has a corresponding agent. When the Linux Bridge plug-in is in use all nodes in the environment that handle data packets must have the agent installed and configured.
  </div><div class="para">
    This includes all compute nodes and systems hosting the dedicated DHCP and L3 agents.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Set the value of the <code class="literal">physical_interface_mappings</code> configuration key. This configuration key must contain a list of physical networks and the VLAN ranges associated with them that are available for allocation to tenant networks.
      </div><div class="para">
        The format for each entry in the comma separated list is:
<pre class="screen"><em class="replaceable"><code>PHYSNET</code></em>:<em class="replaceable"><code>VLAN_START</code></em>:<em class="replaceable"><code>VLAN_END</code></em></pre>
         Where <em class="replaceable"><code>PHYSNET</code></em> is replaced with the name of a physical network, <em class="replaceable"><code>VLAN_START</code></em> is replaced by an identifier indicating the start of the VLAN range, and <em class="replaceable"><code>VLAN_END</code></em> is replaced by an identifier indicating the end of the VLAN range.
      </div><div class="para">
        The physical networks must have been defined in the <code class="literal">network_vlan_ranges</code> configuration variable on the OpenStack Networking server.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>openstack-config --set /etc/neutron/plugin.ini \</code></strong>
   <strong class="userinput"><code>LINUX_BRIDGE physical_interface_mappings <em class="replaceable"><code>MAPPINGS</code></em></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>MAPPINGS</code></em> with the physical network to VLAN range mappings.
      </div></li><li class="step"><div class="para">
        Use the service command to start the <code class="systemitem">neutron-linuxbridge-agent</code> service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service neutron-linuxbridge-agent start</code></code></strong></pre></li><li class="step"><div class="para">
        Use the chkconfig command to ensure that the <code class="systemitem">neutron-linuxbridge-agent</code> service is started automatically in the future.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig neutron-linuxbridge-agent on</code></code></strong></pre></li></ol></div><div class="para">
    The networking configuration has been updated to use the Linux Bridge plug-in.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16752-550066+%5BLatest%5D&amp;cf_build_id=16752-550066+01+Nov+2013+09%3A59+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Linux+Bridge+Plug-in+Agent%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_the_L3_Agent"></a>13.8.&nbsp;Configuring the L3 Agent</h2></div></div></div><div class="itemizedlist prereqs-list"><p class="title"><strong>Prerequisites:</strong></p><ul class="prereqs-list prereqs-list"><li class="listitem"><div class="para">
        <a class="xref" href="#sect-Common_Networking_Configuration">Section&nbsp;13.3, “Common Networking Configuration”</a>
      </div></li></ul></div><div class="para">
    Follow the steps listed in this procedure to configure the L3 agent. All steps listed in this procedure must be performed on the network node while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Configuring Authentication</strong></p><ol class="a"><li class="step"><div class="para">
            Set the authentication strategy (<code class="literal">auth_strategy</code>) configuration key to <code class="literal">keystone</code> using the <code class="command">openstack-config</code> command.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/metadata_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT auth_strategy keystone</code></code></strong></pre></li><li class="step"><div class="para">
            Set the authentication host (<code class="literal">auth_host</code> configuration key to the IP address or host name of the identity server.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/metadata_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken auth_host <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the identity server.
          </div></li><li class="step"><div class="para">
            Set the administration tenant name (<code class="literal">admin_tenant_name</code>) configuration key to the name of the tenant that was created for the use of the networking services. Examples in this guide use <em class="replaceable"><code>services</code></em>.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/metadata_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></code></strong></pre></li><li class="step"><div class="para">
            Set the administration user name (<code class="literal">admin_user</code>) configuration key to the name of the user that was created for the use of the networking services. Examples in this guide use <em class="replaceable"><code>neutron</code></em>.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/metadata_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_user <em class="replaceable"><code>neutron</code></em></code></code></strong></pre></li><li class="step"><div class="para">
            Set the administration password (<code class="literal">admin_password</code>) configuration key to the password that is associated with the user specified in the previous step.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/metadata_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">keystone_authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Configuring the Interface Driver</strong></p><div class="para">
        Set the value of the <code class="literal">interface_driver</code> configuration key in the <code class="filename">/etc/neutron/l3_agent.ini</code> file based on the networking plug-in being used. Execute only the configuration step that applies to the plug-in used in your environment.
      </div><ul class="stepalternatives">
        <li class="step"><p class="title"><strong>Open vSwitch Interface Driver</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/l3_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT interface_driver neutron.agent.linux.interface.OVSInterfaceDriver</code></code></strong></pre></li>
         <li class="step"><p class="title"><strong>Linux Bridge Interface Driver</strong></p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/l3_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT interface_driver neutron.agent.linux.interface.BridgeInterfaceDriver</code></code></strong></pre></li>

      </ul></li><li class="step"><p class="title"><strong>Configuring External Network Access</strong></p><div class="para">
        The L3 agent connects to external networks using either an external bridge or an external provider network. When using the Open vSwitch plug-in either approach is supported. When using the Linux Bridge plug-in only the use of an external provider network is supported. Choose the approach that is most appropriate for the environment.
      </div><ul class="stepalternatives">
        <li class="step"><p class="title"><strong>Using an External Bridge</strong></p><div class="para">
            To use an external bridge you must create and configure it. Finally the OpenStack networking configuration must be updated to use it. This must be done on each system hosting an instance of the L3 agent.
          </div><ol class="a"><li class="step"><div class="para">
                Use the <code class="command">ovs-ctl</code> command to create the external bridge named <code class="literal">br-ex</code>.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">ovs-vsctl add-br br-ex</code></code></strong></pre></li><li class="step"><div class="para">
                Ensure that the <code class="literal">br-ex</code> device persists on reboot by creating a <code class="filename">/etc/sysconfig/network-scripts/ifcfg-br-ex</code> file with these contents:
              </div><pre class="programlisting">DEVICE=br-ex
DEVICETYPE=ovs
TYPE=OVSBridge
ONBOOT=yes
BOOTPROTO=none</pre></li><li class="step"><div class="para">
                Ensure that the value of the <code class="literal">external_network_bridge</code> configuration key in the <code class="filename">/etc/neutron/l3_agent.ini</code> file is <code class="literal">br-ex</code>. This ensures that the L3 agent will use the external bridge.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/l3_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT external_network_bridge br-ex</code></code></strong></pre></li></ol></li>
         <li class="step"><p class="title"><strong>Using a Provider Network</strong></p><div class="para">
            To connect the L3 agent to external networks using a provider network you must first have created the provider network. You must also have created a subnet and router to associate with it. The unique identifier of the router will be required to complete these steps.
          </div><ol class="a"><li class="step"><div class="para">
                Ensure that the value of the <code class="literal">external_network_bridge</code> configuration key in the <code class="filename">/etc/neutron/l3_agent.ini</code> file is blank. This ensures that the L3 agent does not attempt to use an external bridge.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/l3_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT external_network_bridge &quot;&quot;</code></code></strong></pre></li><li class="step"><div class="para">
                Set the value of the <code class="literal">router_id</code> configuration key in the <code class="filename">/etc/neutron/l3_agent.ini</code> file to the identifier of the external router that must be used by the L3 agent when accessing the external provider network.
              </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/neutron/l3_agent.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT router_id <em class="replaceable"><code>ROUTER</code></em></code></code></strong></pre><div class="para">
                Replace <em class="replaceable"><code>ROUTER</code></em> with the unique identifier of the router that has been defined for use when accessing the external provider network.
              </div></li></ol></li>

      </ul></li><li class="step"><p class="title"><strong>Starting the L3 Agent</strong></p><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">neutron-l3-agent</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service neutron-l3-agent start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to ensure that the <code class="systemitem">neutron-l3-agent</code> service will be started automatically in the future.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig neutron-l3-agent on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the Metadata Agent</strong></p><div class="para">
        The OpenStack networking metadata agent allows virtual machine instances to communicate with the compute metadata service. It runs on the same hosts as the Layer 3 (L3) agent.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">neutron-metadata-agent</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service neutron-metadata-agent start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to ensure that the <code class="systemitem">neutron-metadata-agent</code> service will be started automatically in the future.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig neutron-metadata-agent on</code></code></strong></pre></li></ol></li></ol></div><div class="para">
    The L3 agent has been configured and started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16774-550067+%5BLatest%5D&amp;cf_build_id=16774-550067+01+Nov+2013+10%3A00+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+L3+Agent%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Validating_the_OpenStack_Networking_Installation1"></a>13.9.&nbsp;Validating the OpenStack Networking Installation</h2></div></div></div><div class="para">
    To begin using OpenStack networking it is necessary to deploy networking components to compute nodes. Initial networks and routers must also be defined. It is however possible to perform basic santiy checking of the OpenStack networking deployment by following the steps outline in this procedure.
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>All Nodes</strong></p><ol class="a"><li class="step"><div class="para">
            Verify that the customized Red Hat Enterprise Linux kernel intended for use with Red Hat Enterprise Linux OpenStack Platform is running:
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">uname --kernel-release</code></code></strong>
<em class="replaceable"><code>2.6.32-358.6.2</code></em>.<span class="bold bold"><strong>openstack</strong></span>.el6.x86_64</pre><div class="para">
            If the kernel release value returned does not contain the string <code class="literal">openstack</code> then update the kernel and reboot the system.
          </div></li><li class="step"><div class="para">
            Ensure that the installed IP utilities support network namespaces:
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">ip netns</code></code></strong></pre><div class="para">
            If an error indicating that the argument is not recognised or supported is returned then update the system using <code class="command">yum</code>.
          </div></li></ol></li><li class="step"><p class="title"><strong>Service Nodes</strong></p><ol class="a"><li class="step"><div class="para">
            Ensure that the <code class="systemitem">neutron-server</code> service is running:
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">service neutron-server status</code></code></strong>
neutron-server (pid  <em class="replaceable"><code>3011</code></em>) is running...</pre></li></ol></li><li class="step"><p class="title"><strong>Network Nodes</strong></p><ol class="a"><li class="step"><div class="para">
            Ensure that the DHCP agent is running:
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">service neutron-dhcp-agent status</code></code></strong>
neutron-dhcp-agent (pid  <em class="replaceable"><code>3012</code></em>) is running...</pre></li><li class="step"><div class="para">
            Ensure that the L3 agent is running:
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">service neutron-l3-agent status</code></code></strong>
neutron-l3-agent (pid  <em class="replaceable"><code>3013</code></em>) is running...</pre></li><li class="step"><div class="para">
            Ensure that the plug-in agent, if applicable, is running:
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">service neutron-<em class="replaceable"><code>PLUGIN</code></em>-agent status</code></code></strong>
neutron-<em class="replaceable"><code>PLUGIN</code></em>-agent (pid  <em class="replaceable"><code>3014</code></em>) is running...</pre><div class="para">
            Replace <em class="replaceable"><code>PLUGIN</code></em> with the appropriate plug-in for the environment. Valid values include <code class="literal">openvswitch</code> and <code class="literal">linuxbridge</code>.
          </div></li><li class="step"><div class="para">
            Ensure that the metadata agent is running:
          </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">service neutron-metadata-agent status</code></code></strong>
neutron-metadata-agent (pid  <em class="replaceable"><code>3015</code></em>) is running...</pre></li></ol></li></ol></div><div class="para">
    All required services on the service and network nodes are operational. Proceed to deploy some compute nodes, define networks, and define routers to begin using OpenStack networking.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+18118-550068+%5BLatest%5D&amp;cf_build_id=18118-550068+01+Nov+2013+10%3A07+en-US+%5BLatest%5D&amp;comment=Title%3A+Validating+the+OpenStack+Networking+Installation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_OpenStack_Compute_Service"></a>Chapter&nbsp;14.&nbsp;Installing the OpenStack Compute Service</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#sect-Compute_Service_Requirements">14.1. Compute Service Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#Checking_for_Hardware_Virtualization_Support">14.1.1. Checking for Hardware Virtualization Support</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Installing_a_Compute_VNC_Proxy">14.2. Installing a Compute VNC Proxy</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Compute_VNC_Proxy_Packages">14.2.1. Installing the Compute VNC Proxy Packages</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall2">14.2.2. Configuring the Firewall</a></span></dt><dt><span class="section"><a href="#Starting_the_VNC_Proxy_Server">14.2.3. Controlling the VNC Proxy service</a></span></dt><dt><span class="section"><a href="#Accessing_Instances_with_the_Compute_VNC_Proxy">14.2.4. Accessing Instances with the Compute VNC Proxy</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Installing_a_Compute_Node">14.3. Installing a Compute Node</a></span></dt><dd><dl><dt><span class="section"><a href="#Creating_the_Compute_Service_Database">14.3.1. Creating the Compute Service Database</a></span></dt><dt><span class="section"><a href="#Creating_the_Compute_Service_Endpoint">14.3.2. Creating the Compute Identity Records</a></span></dt><dt><span class="section"><a href="#Installing_the_Compute_Service_Packages">14.3.3. Installing the Compute Service</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Compute_Service">14.3.4. Configuring the Compute Service</a></span></dt><dt><span class="section"><a href="#Populating_the_Compute_Service_Database">14.3.5. Populating the Compute Service Database</a></span></dt><dt><span class="section"><a href="#Starting_the_Compute_Services">14.3.6. Starting the Compute Services</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Compute_Service_Requirements"></a>14.1.&nbsp;Compute Service Requirements</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Checking_for_Hardware_Virtualization_Support"></a>14.1.1.&nbsp;Checking for Hardware Virtualization Support</h3></div></div></div><div class="para">
    The OpenStack Compute Service requires hardware virtualization support and certain kernel modules. Follow this procedure to determine whether your system has hardware virtualization support and the correct kernel modules available.
  </div><div class="para">
    All steps listed must be performed while logged into the system as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">grep</code> command to check for the presence of the <code class="literal">svm</code> or <code class="literal">vmx</code> CPU extensions by inspecting the <code class="filename">/proc/cpuinfo</code> file generated by the kernel:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">grep -E 'svm|vmx' /proc/cpuinfo</code></code></strong></pre><div class="para">
        If any output is shown after running this command then the CPU is hardware virtualization capable and the functionality is enabled in the system BIOS.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">lsmod</code> command to list the loaded kernel modules and verify that the <code class="literal">kvm</code> modules are loaded:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">lsmod | grep kvm</code></code></strong></pre><div class="para">
        If the output includes <code class="systemitem">kvm_intel</code> or <code class="systemitem">kvm_amd</code> then the <code class="systemitem">kvm</code> hardware virtualization modules are loaded and your kernel meets the module requirements for the OpenStack Compute Service.
      </div></li></ol></div><div class="para">
    This completes the required checks to ensure hardware virtualization support is available and enabled, and that you have the correct kernel modules loaded.
  </div><div class="para">
    If the checks indicated that either hardware virtualization support or the required kernel modules are not available or not enabled then you must take action to either find a system that does have the required hardware virtualization support and modules, or enable it on the system that failed the checks.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15943-541150+%5BLatest%5D&amp;cf_build_id=15943-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Checking+for+Hardware+Virtualization+Support%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Installing_a_Compute_VNC_Proxy"></a>14.2.&nbsp;Installing a Compute VNC Proxy</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Installing_the_Compute_VNC_Proxy_Packages"></a>14.2.1.&nbsp;Installing the Compute VNC Proxy Packages</h3></div></div></div><div class="para">
    The VNC Proxy is available to users of the Compute service. Two types of VNC proxy server packages are available. The <span class="package">openstack-nova-novncproxy</span> package provides VNC support to instances through a web browser (using Websockets), while the <span class="package">openstack-nova-console</span> package provides access to instances through a traditional VNC client (via the <code class="systemitem">openstack-nova-xvpvncproxy</code> service).
  </div><div class="para">
    The console authentication service, also provided by the <span class="package">openstack-nova-console</span> package, is used to authenticate the VNC connections. Typically the console authentication service and the proxy utilities are installed on the same host as the Compute API service.
  </div><div class="para">
    The following steps must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Install the VNC proxy utilities and the console authentication service:
      </div><ul class="stepalternatives">
        <li class="step"><div class="para">
            Install the <span class="package">openstack-nova-novncproxy</span> package using the <code class="command">yum</code> command:
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y openstack-nova-novncproxy</code></code></strong></pre></li>
         <li class="step"><div class="para">
            Install the <span class="package">openstack-nova-console</span> package using the <code class="command">yum</code> command:
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install -y openstack-nova-console</code></code></strong></pre></li>

      </ul></li></ul></div><div class="para">
    The VNC Proxy packages and the console authentication service are now installed and ready for configuration.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15817-541150+%5BLatest%5D&amp;cf_build_id=15817-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Compute+VNC+Proxy+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Firewall2"></a>14.2.2.&nbsp;Configuring the Firewall</h3></div></div></div><div class="para">
    The node that hosts VNC access to instances must be configured to allow VNC traffic through its firewall. By default, the <code class="systemitem">openstack-nova-novncproxy</code> service listens on TCP port 6080 and the <code class="systemitem">openstack-nova-xvpvncproxy</code> service listens on TCP port 6081.
  </div><div class="para">
    The following procedure allows traffic on TCP port 6080 to traverse through the firewall for use by the <span class="package">openstack-nova-novncproxy</span> package:
  </div><div class="para">
    The following steps must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Edit the <code class="filename">/etc/sysconfig/iptables</code> file and add the following on a new line underneath the <span class="emphasis"><em>-A INPUT -i lo -j ACCEPT</em></span> line and before any <span class="emphasis"><em>-A INPUT -j REJECT</em></span> rules:
      </div><pre class="screen">-A INPUT -m state --state NEW -m tcp -p tcp --dport 6080 -j ACCEPT</pre></li><li class="step"><div class="para">
        Save the file and exit the editor.
      </div></li></ol></div><div class="procedure"><ul><li class="step"><div class="para">
        Similarly, when using the <code class="systemitem">openstack-nova-xvpvncproxy</code> service, enable traffic on TCP port 6081 with the following on a new line in the same location:
      </div><pre class="screen">-A INPUT -m state --state NEW -m tcp -p tcp --dport 6081 -j ACCEPT</pre></li></ul></div><div class="para">
    Once the file has been edited with the new firewall rule or rules, run the following commands as the <code class="systemitem">root</code> user to apply the changes:
  </div><pre class="screen"># service iptables restart</pre><pre class="screen"># iptables-save</pre><div class="para">
    The new firewall rules will be applied to the running system and take effect immediately. The rules will also remain available after rebooting the system. The firewall is now configured to allow VNC proxy traffic.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15808-541150+%5BLatest%5D&amp;cf_build_id=15808-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Starting_the_VNC_Proxy_Server"></a>14.2.3.&nbsp;Controlling the VNC Proxy service</h3></div></div></div><div class="para">
    VNC access to instances is available over a web browser or with a traditional VNC client. The <code class="filename">/etc/nova/nova.conf</code> file holds the following VNC options:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        <span class="emphasis"><em>vnc_enabled</em></span> - Default is true.
      </div></li><li class="listitem"><div class="para">
        <span class="emphasis"><em>vncserver_listen</em></span> - The IP address to which VNC services will bind.
      </div></li><li class="listitem"><div class="para">
        <span class="emphasis"><em>vncserver_proxyclient_address</em></span> - The IP address of the compute host used by proxies to connect to instances.
      </div></li><li class="listitem"><div class="para">
        <span class="emphasis"><em>novncproxy_base_url</em></span> - The browser address where clients connect to instance.
      </div></li><li class="listitem"><div class="para">
        <span class="emphasis"><em>novncproxy_port</em></span> - The port listening for browser VNC connections. Default is 6080.
      </div></li><li class="listitem"><div class="para">
        <span class="emphasis"><em>xvpvncproxy_port</em></span> - The port to bind for traditional VNC clients. Default is 6081.
      </div></li></ul></div><div class="para">
    As the <code class="systemitem">root</code> user, use the <code class="command">service</code> command to start the console authentication service:
  </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-nova-consoleauth start</code></code></strong></pre><div class="para">
    Use the <code class="command">chkconfig</code> command to permanently enable the service:
  </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-nova-consoleauth on</code></code></strong></pre><div class="para">
    As the <code class="systemitem">root</code> user, use the <code class="command">service</code> command on the nova node to start the browser-based service:
  </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-nova-novncproxy start</code></code></strong></pre><div class="para">
    Use the <code class="command">chkconfig</code> command to permanently enable the service:
  </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-nova-novncproxy on</code></code></strong></pre><div class="para">
    To control access to the VNC service that uses a traditional client (non browser-based), substitute <span class="emphasis"><em>openstack-nova-xvpvncproxy</em></span> into the previous commands.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15944-541150+%5BLatest%5D&amp;cf_build_id=15944-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Controlling+the+VNC+Proxy+service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Accessing_Instances_with_the_Compute_VNC_Proxy"></a>14.2.4.&nbsp;Accessing Instances with the Compute VNC Proxy</h3></div></div></div><div class="para">
    Browse to the <span class="emphasis"><em>novncproxy_base_url</em></span> URL provided in the <code class="filename">/etc/nova/nova.conf</code> file to access instance consoles.
  </div><div class="para">
    The following image shows VNC access to a Fedora Linux instance with a web browser. It is provided only as an example, and settings such as IP addresses will be different in your environment.
  </div><div class="figure"><a id="idp9746424"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2449.png" align="middle" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;14.1.&nbsp;VNC instance access</strong></p></div><br class="figure-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16117-541150+%5BLatest%5D&amp;cf_build_id=16117-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Accessing+Instances+with+the+Compute+VNC+Proxy%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Installing_a_Compute_Node"></a>14.3.&nbsp;Installing a Compute Node</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_the_Compute_Service_Database"></a>14.3.1.&nbsp;Creating the Compute Service Database</h3></div></div></div><div class="para">
    The following procedure creates the database and database user used by the Compute service. These steps must be performed while logged in to the database server as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Connect to the database service using the <code class="command">mysql</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">mysql -u root -p</code></code></strong></pre></li><li class="step"><div class="para">
        Create the <code class="literal">nova</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> CREATE DATABASE nova;</pre></li><li class="step"><div class="para">
        Create a <code class="literal">nova</code> database user and grant it access to the <code class="literal">nova</code> database.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON nova.* TO 'nova'@'%' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><pre class="screen"><code class="prompt">mysql&gt;</code> GRANT ALL ON nova.* TO 'nova'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used to authenticate with the database server as this user.
      </div></li><li class="step"><div class="para">
        Flush the database privileges to ensure that they take effect immediately.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> FLUSH PRIVILEGES;</pre></li><li class="step"><div class="para">
        Exit the <code class="command">mysql</code> client command.
      </div><pre class="screen"><code class="prompt">mysql&gt;</code> quit</pre></li></ol></div><div class="para">
    The Compute database has been created. The database will be populated during service configuration.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15873-541150+%5BLatest%5D&amp;cf_build_id=15873-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Compute+Service+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_the_Compute_Service_Endpoint"></a>14.3.2.&nbsp;Creating the Compute Identity Records</h3></div></div></div><div class="para">
    The steps outlined in this procedure cover the creation of these identity records to support the Image service:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Create the <code class="systemitem">compute</code> user, who has the <code class="systemitem">admin</code> role in the <code class="systemitem">services</code> tenant.
        </div></li><li class="listitem"><div class="para">
          Create the <code class="systemitem">compute</code> service entry and assign it an endpoint.
        </div></li></ol></div>

  </div><div class="para">
    These entries will assist other OpenStack services attempting to locate and access the functionality provided by the Compute service:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Authenticate as the administrator of the Identity service by running the <code class="command">source</code> command on the <code class="filename">keystonerc_admin</code> file containing the required credentials:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Create a user named <code class="literal">compute</code> for the OpenStack Compute service to use:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-create --name compute --pass <em class="replaceable"><code>PASSWORD</code></em></code></code></strong>
+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|  email   |                                  |
| enabled  |               True               |
|    id    | <em class="replaceable"><code>96cd855e5bfe471ce4066794bbafb615</code></em> |
|   name   |              compute             |
| tenantId |                                  |
+----------+----------------------------------+
</pre><div class="para">
        Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password that will be used by the Compute service when authenticating against the Identity service. Take note of the created user's returned ID as it will be used in subsequent steps.
      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="literal">admin</code> role:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone role-get admin</code></code></strong></pre><div class="para">
        If no <code class="systemitem">admin</code> role exists, create one:
<pre class="screen">$ keystone role-create --name admin</pre>

      </div></li><li class="step"><div class="para">
        Get the ID of the <code class="systemitem">services</code> tenant:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-list | grep services</code></strong></pre><div class="para">
        If no <code class="systemitem">services</code> tenant exists, create one:
      </div><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>keystone tenant-create --name services --description &quot;Services Tenant&quot; </code></strong></pre><div class="para">
        This guide uses one tenant for all service users. For more information, refer to <em class="citetitle">Creating the Services Tenant</em>.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">keystone user-role-add</code> command to link the <code class="literal">compute</code> user, <code class="literal">admin</code> role, and <code class="literal">services</code> tenant together:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone user-role-add --user-id <em class="replaceable"><code>USERID</code></em> --role-id <em class="replaceable"><code>ROLEID</code></em> --tenant-id <em class="replaceable"><code>TENANTID</code></em></code></code></strong></pre><div class="para">
        Replace the user, role, and tenant IDs with those obtained in the previous steps.
      </div></li><li class="step"><div class="para">
        Create the <code class="literal">compute</code> service entry:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone service-create --name compute \</code></code></strong>
        <strong class="userinput"><code><code class="command">--type compute \</code></code></strong>
        <strong class="userinput"><code><code class="command">--description &quot;OpenStack Compute Service&quot;</code></code></strong>
+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |     OpenStack Compute Service    |
|      id     | <em class="replaceable"><code>8dea97f5ee254b309c1792d2bd821e59</code></em> |
|     name    |              compute             |
|     type    |              compute             |
+-------------+----------------------------------+</pre><div class="para">
        Take note of the created service's returned ID as it will be used in the next step.
      </div></li><li class="step"><div class="para">
        Create the <code class="literal">compute</code> endpoint entry:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">keystone endpoint-create --service-id <em class="replaceable"><code>SERVICEID</code></em> \</code></code></strong>
          <strong class="userinput"><code><code class="command">--publicurl &quot;http://<em class="replaceable"><code>IP</code></em>:8774/v2/\$(tenant_id)s&quot; \</code></code></strong>
          <strong class="userinput"><code><code class="command">--adminurl &quot;http://<em class="replaceable"><code>IP</code></em>:8774/v2/\$(tenant_id)s&quot; \</code></code></strong>
          <strong class="userinput"><code><code class="command">--internalurl &quot;http://<em class="replaceable"><code>IP</code></em>:8774/v2/\$(tenant_id)s&quot;</code></code></strong></pre><div class="para">
        Replace:
      </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
            <em class="replaceable"><code>SERVICEID</code></em> with the ID returned by the <code class="command">keystone service-create</code> command.
          </div></li><li class="listitem"><div class="para">
            <em class="replaceable"><code>IP</code></em> with the IP address or host name of the system that will be acting as the compute node.
          </div></li></ul></div></li></ol></div><div class="para">
    All supporting identity service entries required by the OpenStack Compute service have been created.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15862-541150+%5BLatest%5D&amp;cf_build_id=15862-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+the+Compute+Identity+Records%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Installing_the_Compute_Service_Packages"></a>14.3.3.&nbsp;Installing the Compute Service</h3></div></div></div><div class="para">
    The OpenStack Compute services are provided the following packages:
  </div><div class="para">
    <div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">openstack-nova-api</span></span></dt><dd><div class="para">
            Provides the OpenStack Compute API service. At least one node in the environment must host an instance of the API service. This imust be the node pointed to by the Identity service endpoint defition for the Compute service.
          </div></dd><dt><span class="term"><span class="package">openstack-nova-compute</span></span></dt><dd><div class="para">
            Provides the OpenStack Compute service.
          </div></dd><dt><span class="term"><span class="package">openstack-nova-conductor</span></span></dt><dd><div class="para">
            Provides the Compute conductor service. The conductor handles database requests made by Compute nodes, ensuring that individual Compute nodes do not require direct database access. At least one node in each environment must act as a Compute conductor.
          </div></dd><dt><span class="term"><span class="package">openstack-nova-scheduler</span></span></dt><dd><div class="para">
            Provides the Compute scheduler service. The scheduler handles scheduling of requests made to the API across the available Compute resources. At least one node in each environment must act as a Compute scheduler.
          </div></dd><dt><span class="term"><span class="package">python-cinderclient</span></span></dt><dd><div class="para">
            Provides client utilities for accessing storage managed by the OpenStack Block Storage service. This package is not required if you do not intend to attach block storage volumes to your instances or you intend to manage such volumes using a service other than the OpenStack Block Storage service.
          </div></dd></dl></div>

  </div><div class="para">
    To install the above packages, execute the following command while logged in as the <code class="systemitem">root</code> user:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>yum install -y openstack-nova-api openstack-nova-compute \</code></strong>
   <strong class="userinput"><code>openstack-nova-conductor openstack-nova-scheduler \</code></strong>
   <strong class="userinput"><code>python-cinderclient</code></strong></pre>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      In the command presented here all Compute service packages are installed on a single node. In a production deployment is recommended that the API, conductor, and scheduler services are installed on a separate controller node or on separate nodes entirely. The Compute service itself must be installed on each node that is expected to host virtual machine instances.
    </div></div></div><div class="para">
    The Compute service package is now installed.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15952-541150+%5BLatest%5D&amp;cf_build_id=15952-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Compute+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Configuring_the_Compute_Service"></a>14.3.4.&nbsp;Configuring the Compute Service</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Authentication4"></a>14.3.4.1.&nbsp;Configuring Authentication</h4></div></div></div><div class="para">
    The Compute service must be explicitly configured to use the Identity service for authentication. Follow the steps listed in this procedure to configure this.
  </div><div class="para">
    All steps listed in this procedure must be performed on each system hosting Compute services while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Set the authentication strategy (<code class="literal">auth_strategy</code>) configuration key to <code class="literal">keystone</code> using the <code class="command">openstack-config</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT auth_strategy keystone</code></code></strong></pre></li><li class="step"><div class="para">
        Set the authentication host (<code class="literal">auth_host</code>) configuration key to the IP address or host name of the identity server.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/api-paste.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">filter:authtoken auth_host <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the identity server.
      </div></li><li class="step"><div class="para">
        Set the administration tenant name (<code class="literal">admin_tenant_name</code>) configuration key to the name of the tenant that was created for the use of the Compute service. In this guide, examples use <em class="replaceable"><code>services</code></em>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/api-paste.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">filter:authtoken admin_tenant_name <em class="replaceable"><code>services</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Set the administration user name (<code class="literal">admin_user</code>) configuration key to the name of the user that was created for the use of the Compute service. In this guide, examples use <em class="replaceable"><code>nova</code></em>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/api-paste.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">filter:authtoken admin_user <em class="replaceable"><code>nova</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Set the administration password (<code class="literal">admin_password</code>) configuration key to the password that is associated with the user specified in the previous step.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/api-paste.ini \</code></code></strong>
   <strong class="userinput"><code><code class="command">filter:authtoken admin_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre></li></ol></div><div class="para">
    The authentication keys used by the Compute services have been set and will be used when the services are started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+21112-541150+%5BLatest%5D&amp;cf_build_id=21112-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Authentication%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Setting_the_Database_Connection_String1"></a>14.3.4.2.&nbsp;Setting the Database Connection String</h4></div></div></div><div class="para">
    The database connection string used by the Compute service is defined in the <code class="filename">/etc/nova/nova.conf</code> file. It must be updated to point to a valid database server before starting the service.
  </div><div class="para">
    The database connection string only needs to be set on nodes that will be hosting the conductor service (<code class="systemitem">openstack-nova-conductor</code>). Compute nodes communicate with the conductor using the messaging infrastructure, the conductor in turn orchestrates communication with the database. As a result individual compute nodes do not require direct access to the database. This procedure only needs to be followed on nodes that will host the conductor service. There must be at least one instance of the conductor service in any compute environment.
  </div><div class="para">
    All commands in this procedure must be run while logged in as the <code class="systemitem">root</code> user on the server hosting the Compute service.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Use the <code class="command">openstack-config</code> command to set the value of the <code class="literal">sql_connection</code> configuration key.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT sql_connection mysql://<em class="replaceable"><code>USER</code></em>:<em class="replaceable"><code>PASS</code></em>@<em class="replaceable"><code>IP</code></em>/<em class="replaceable"><code>DB</code></em></code></code></strong></pre><div class="para">
        Replace:
        <div class="itemizedlist"><ul><li class="listitem"><div class="para">
              <em class="replaceable"><code>USER</code></em> with the database user name the Compute service is to use, usually <code class="literal">nova</code>.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>PASS</code></em> with the password of the chosen database user.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>IP</code></em> with the IP address or host name of the database server.
            </div></li><li class="listitem"><div class="para">
              <em class="replaceable"><code>DB</code></em> with the name of the database that has been created for use by the compute, usually <code class="literal">nova</code>.
            </div></li></ul></div>

      </div></li></ul></div><div class="para">
    The database connection string has been set and will be used by the Compute service.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16007-549912+%5BLatest%5D&amp;cf_build_id=16007-549912+31+Oct+2013+15%3A34+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Database+Connection+String%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Compute_Block_Storage"></a>14.3.4.3.&nbsp;Setting the Message Broker</h4></div></div></div><div class="para">
    The Compute services must be explicitly configured with the type, location, and authentication details of the message broker.
  </div><div class="para">
    All steps in this procedure must be run on each system that will be running Compute services and executed as the <code class="systemitem">root</code> user:
  </div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>General Settings</strong></p><div class="para">
        Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">rpc_backend</code> configuration key to Qpid.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT rpc_backend nova.openstack.common.rpc.impl_qpid</code></code></strong></pre></li><li class="step"><p class="title"><strong>Configuration Key</strong></p><div class="para">
        Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_hostname</code> configuration key to the host name of the Qpid server.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_hostname <em class="replaceable"><code>IP</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the message broker.
      </div></li><li class="step"><p class="title"><strong>Authentication Settings</strong></p><div class="para">
        If you have configured Qpid to authenticate incoming connections, you must provide the details of a valid Qpid user in the Compute configuration:
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_username</code> configuration key to the username of the Qpid user that the Compute services must use when communicating with the message broker.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_username <em class="replaceable"><code>USERNAME</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>USERNAME</code></em> with the required Qpid user name.
          </div></li><li class="step"><div class="para">
            Use the <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_password</code> configuration key to the password of the Qpid user that the Compute services must use when communicating with the message broker.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre><div class="para">
            Replace <em class="replaceable"><code>PASSWORD</code></em> with the password of the Qpid user.
          </div></li></ol></li><li class="step"><p class="title"><strong>Encryption Settings</strong></p><div class="para">
        If you configured Qpid to use SSL, you must inform the Compute services of this choice. Use <code class="command">openstack-config</code> utility to set the value of the <code class="literal">qpid_protocol</code> configuration key to <code class="literal">ssl</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_protocol ssl</code></code></strong></pre><div class="para">
        The value of the <code class="literal">qpid_port</code> configuration key must be set to <code class="literal">5671</code> as Qpid listens on this different port when SSL is in use.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT qpid_port 5671</code></code></strong></pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          To communicate with a Qpid message broker that uses SSL the node must also have:
        </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
              The <span class="package">nss</span> package installed.
            </div></li><li class="listitem"><div class="para">
              The certificate of the relevant certificate authority installed in the system NSS database (<code class="filename">/etc/pki/nssdb/</code>).
            </div></li></ul></div><div class="para">
          The <code class="command">certtool</code> command is able to import certificates into the NSS database. See the <code class="command">certtool</code> manual page for more information (<code class="command">man certtool</code>).
        </div></div></div></li></ol></div><div class="para">
    The Compute services have been configured to use the message broker and any authentication schemes that it presents.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16889-541150+%5BLatest%5D&amp;cf_build_id=16889-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+the+Message+Broker%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Resource_Overcommitment"></a>14.3.4.4.&nbsp;Configuring Resource Overcommitment</h4></div></div></div><div class="para">
    OpenStack supports overcommitting of CPU and memory resources on compute nodes. Overcommitting is a technique of allocating more virtualized CPUs and/or memory than there are physical resources.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      Overcommitting increases the amount of instances you are able to run, but reduces instance performance.
    </div></div></div><div class="para">
    CPU and memory overcommit settings are represented as a ratio. OpenStack uses the following ratios by default:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Default CPU overcommit ratio - 16
      </div></li><li class="listitem"><div class="para">
        Default memory overcommit ratio - 1.5
      </div></li></ul></div><div class="para">
    These default settings have the following implications:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        The default CPU overcommit ratio of 16 means that up to 16 virtual cores can be assigned to a node for each physical core.
      </div></li><li class="listitem"><div class="para">
        The default memory overcommit ratio of 1.5 means that instances can be assigned to a physical node if the total instance memory usage is less than 1.5 times the amount of physical memory available.
      </div></li></ul></div><div class="para">
    Use the <code class="systemitem">cpu_allocation_ratio</code> and <code class="systemitem">ram_allocation_ratio</code> directives in <code class="filename">/etc/nova/nova.conf</code> to change these default settings.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15860-541150+%5BLatest%5D&amp;cf_build_id=15860-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Resource+Overcommitment%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Reserving_Host_Resources"></a>14.3.4.5.&nbsp;Reserving Host Resources</h4></div></div></div><div class="para">
    You can reserve host memory and disk resources as always available to OpenStack. To prevent a given amount of memory and disk resources from being considered as available to be allocated for usage by virtual machines, edit the following directives in <code class="filename">/etc/nova/nova.conf</code>:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        <code class="systemitem">reserved_host_memory_mb</code> - Defaults to 512MB.
      </div></li><li class="listitem"><div class="para">
        <code class="systemitem">reserved_host_disk_mb</code> - Defaults to 0MB.
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16953-541150+%5BLatest%5D&amp;cf_build_id=16953-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Reserving+Host+Resources%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="sect-Configuring_Compute_Networking"></a>14.3.4.6.&nbsp;Configuring Compute Networking</h4></div></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="Compute_Networking_Overview"></a>14.3.4.6.1.&nbsp;Compute Networking Overview</h5></div></div></div><div class="para">
    Unlike Nova-only deployments, when OpenStack networking is in use, the <code class="systemitem">nova-network</code> service <span class="bold bold"><strong>must</strong></span> not run. Instead all network related decisions are delegated to the OpenStack networking Service.
  </div><div class="para">
    Therefore, it is very important that you refer to this guide when configuring networking, rather than relying on Nova networking documentation or past experience with Nova networking. In particular, using CLI tools like <code class="command">nova-manage</code> and <code class="command">nova</code> to manage networks or IP addressing, including both fixed and floating IPs, is not supported with OpenStack Networking.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      It is strongly recommended that you uninstall <code class="systemitem">nova-network</code> and reboot any physical nodes that were running <code class="systemitem">nova-network</code> before using them to run OpenStack Network. Inadvertently running the <code class="systemitem">nova-network</code> process while using OpenStack Networking service can cause problems, as can stale <code class="systemitem">iptables</code> rules pushed down by a previously running <code class="systemitem">nova-network</code>.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16835-541150+%5BLatest%5D&amp;cf_build_id=16835-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Compute+Networking+Overview%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="Updating_the_Compute_Configuration"></a>14.3.4.6.2.&nbsp;Updating the Compute Configuration</h5></div></div></div><div class="para">
    Each time a Compute instance is provisioned or deprovisioned, the service communicates with OpenStack Networking via its API. To facilitate this connection, it is necessary to configure each compute node with the connection and authentication details outlined in this procedure.
  </div><div class="para">
    These steps must be performed on each Compute node while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Modify the <code class="literal">network_api_class</code> configuration key to indicate that the OpenStack Networking service is in use.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT network_api_class nova.network.neutronv2.api.API</code></code></strong></pre></li><li class="step"><div class="para">
        Set the value of the <code class="literal">neutron_url</code> configuration key to point to the endpoint of the networking API.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT neutron_url http://<em class="replaceable"><code>IP</code></em>:9696/</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the server hosting the API of the OpenStack Networking service.
      </div></li><li class="step"><div class="para">
        Set the value of the <code class="literal">neutron_admin_tenant_name</code> configuration key to the name of the tenant used by the OpenStack Networking service. Examples in this guide use <em class="replaceable"><code>services</code></em>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT neutron_admin_tenant_name <em class="replaceable"><code>services</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Set the value of the <code class="literal">neutron_admin_username</code> configuration key to the name of the administrative user for the OpenStack Networking service. Examples in this guide use <em class="replaceable"><code>neutron</code></em>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT neutron_admin_username <em class="replaceable"><code>neutron</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Set the value of the <code class="literal">neutron_admin_password</code> configuration key to the password associated with the administrative user for the networking service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT neutron_admin_password <em class="replaceable"><code>PASSWORD</code></em></code></code></strong></pre></li><li class="step"><div class="para">
        Set the value of the <code class="literal">neutron_admin_auth_url</code> configuration key to the URL associated with the identity service endpoint.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
  <strong class="userinput"><code><code class="command">DEFAULT neutron_admin_auth_url http://<em class="replaceable"><code>IP</code></em>:35357/v2.0</code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the Identity service endpoint.
      </div></li><li class="step"><div class="para">
        Set the value of the <code class="literal">security_group_api</code> configuration key to <code class="literal">neutron</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
  <strong class="userinput"><code><code class="command">DEFAULT security_group_api neutron</code></code></strong></pre><div class="para">
        This enables the use of OpenStack Networking security groups.
      </div></li><li class="step"><div class="para">
        Set the value of the <code class="literal">firewall_driver</code> configuration key to <code class="literal">nova.virt.firewall.NoopFirewallDriver</code>.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
  <strong class="userinput"><code><code class="command">DEFAULT firewall_driver nova.virt.firewall.NoopFirewallDriver</code></code></strong></pre><div class="para">
        This <span class="bold bold"><strong>must</strong></span> be done when OpenStack Networking security groups are in use.
      </div></li></ol></div><div class="para">
    The configuration has been updated and the Compute service will use OpenStack Networking when it is next started.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15881-553122+%5BLatest%5D&amp;cf_build_id=15881-553122+12+Nov+2013+10%3A35+en-US+%5BLatest%5D&amp;comment=Title%3A+Updating+the+Compute+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="Installing_the_L2_Agent"></a>14.3.4.6.3.&nbsp;Configuring the L2 Agent</h5></div></div></div><div class="para">
    Each compute node must run an instance of the Layer 2 (L2) agent appropriate to the networking plug-in that is in use.
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        <a class="xref" href="#Configuring_the_Open_vSwitch_Plug-in">Section&nbsp;13.7.1, “Configuring the Open vSwitch Plug-in Agent”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Configuring_the_Linux_Bridge_Plug-in">Section&nbsp;13.7.2, “Configuring the Linux Bridge Plug-in Agent”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16767-541150+%5BLatest%5D&amp;cf_build_id=16767-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+L2+Agent%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="Configuring_Virtual_Interface_Plugging"></a>14.3.4.6.4.&nbsp;Configuring Virtual Interface Plugging</h5></div></div></div><div class="para">
    When <code class="systemitem">nova-compute</code> creates an instance, it must 'plug' each of the vNIC associated with the instance into a OpenStack networking controlled virtual switch. It must also inform the virtual switch of the OpenStack networking port identifier associated with each vNIC.
  </div><div class="para">
    In previous releases this was done by specifiying a driver specific value for the <code class="literal">libvirt_vif_driver</code> field in the <code class="filename">/etc/nova/nova.conf</code> configuration file. In Red Hat Enterprise Linux OpenStack Platform 3 a generic virtual interface driver, <code class="literal">nova.virt.libvirt.vif.LibvirtGenericVIFDriver</code>, is provided. This driver relies on OpenStack networking being able to return the type of virtual interface binding required. These plug-ins support this operation:
  </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
        Linux Bridge
      </div></li><li class="listitem"><div class="para">
        Open vSwitch
      </div></li><li class="listitem"><div class="para">
        NEC
      </div></li><li class="listitem"><div class="para">
        BigSwitch
      </div></li><li class="listitem"><div class="para">
        CloudBase Hyper-V
      </div></li><li class="listitem"><div class="para">
        brocade
      </div></li></ul></div><div class="para">
    To use the generic driver use the <code class="command">openstack-config</code> command to set the value of the <code class="literal">libvirt_vif_driver</code> configuration key appropriately:
  </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">openstack-config --set /etc/nova/nova.conf \</code></code></strong>
   <strong class="userinput"><code><code class="command">DEFAULT libvirt_vif_driver \</code></code></strong>
   <strong class="userinput"><code><code class="command">nova.virt.libvirt.vif.LibvirtGenericVIFDriver</code></code></strong></pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      If using Open vSwitch with security groups enabled then use the Open vSwitch specific driver, <code class="literal">nova.virt.libvirt.vif.LibvirtHybridOVSBridgeDriver</code>, instead of the generic driver.
    </div></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      When using Linux Bridge, you need to add the following to the <code class="filename">/etc/libvirt/qemu.conf</code> file to ensure that the virtual machine launches properly:
    </div><pre class="screen">user = &quot;root&quot;
group = &quot;root&quot;
cgroup_device_acl = [
   &quot;/dev/null&quot;, &quot;/dev/full&quot;, &quot;/dev/zero&quot;,
   &quot;/dev/random&quot;, &quot;/dev/urandom&quot;,
   &quot;/dev/ptmx&quot;, &quot;/dev/kvm&quot;, &quot;/dev/kqemu&quot;,
   &quot;/dev/rtc&quot;, &quot;/dev/hpet&quot;, &quot;/dev/net/tun&quot;,
]</pre></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15829-541150+%5BLatest%5D&amp;cf_build_id=15829-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Virtual+Interface+Plugging%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_the_Firewall1"></a>14.3.4.7.&nbsp;Configuring the Firewall</h4></div></div></div><div class="para">
    Connections to virtual machine consoles, whether direct or via the proxy, are received on ports in the range <code class="literal">5900</code> to <code class="literal">5999</code>.
  </div><div class="para">
    To allow this the firewall on the service node must be altered to allow network traffic on these ports. All steps in this procedure must be run while logged in to the server hosting the Compute service as the <code class="systemitem">root</code> user. Repeat the process for each compute node.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
      </div></li><li class="step"><div class="para">
        Add an INPUT rule allowing TCP traffic on ports in the ranges <code class="literal">5900</code> to <code class="literal">5999</code> by adding these lines to the file.
      </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 5900:5999 -j ACCEPT
</pre><div class="para">
        The new rule must appear before any INPUT rules that REJECT traffic.
      </div></li><li class="step"><div class="para">
        Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
      </div></li><li class="step"><div class="para">
        Restart the <code class="command">iptables</code> service to ensure that the change takes effect.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">iptables</code> firewall is now configured to allow incoming connections to the Compute services.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15868-553117+%5BLatest%5D&amp;cf_build_id=15868-553117+12+Nov+2013+10%3A24+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Populating_the_Compute_Service_Database"></a>14.3.5.&nbsp;Populating the Compute Service Database</h3></div></div></div><div class="para">
    This procedure describes the steps required to populate the Compute service database. These steps must be performed while logged in to a system hosting an instance of the conductor service. The database connection string must already be defined in the configuration of the service.
  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      This procedure only needs to be followed once to initialize and populate the database. You do not need to perform these steps again when adding additional systems hosting Compute services.
    </div></div></div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">su</code> command to switch to the <code class="literal">nova</code> user.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">su nova -s /bin/sh</code></code></strong></pre></li><li class="step"><div class="para">
        Run the <code class="command">nova-manage db sync</code> command to initialize and populate the database identified in <code class="filename">/etc/nova/nova.conf</code>.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">nova-manage db sync</code></code></strong></pre></li></ol></div><div class="para">
    The Compute service database has been initialized and populated.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16008-541150+%5BLatest%5D&amp;cf_build_id=16008-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Populating+the+Compute+Service+Database%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Starting_the_Compute_Services"></a>14.3.6.&nbsp;Starting the Compute Services</h3></div></div></div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Starting the Message Bus Service</strong></p><div class="para">
        Libvirt requires that the <code class="systemitem">messagebus</code> service be enabled and running.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">messagebus</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service messagebus start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the <code class="systemitem">messagebus</code> service permanently.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig messagebus on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the Libvirtd Service</strong></p><div class="para">
        The Compute service requires that the <code class="systemitem">libvirtd</code> service be enabled and running.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">libvirtd</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service libvirtd start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the <code class="systemitem">libvirtd</code> service permanently.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig libvirtd on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the API Service</strong></p><div class="para">
        Start the API service on each system that will be hosting an instance of it. Note that each API instance should either have its own endpoint defined in the identity service database or be pointed to by a load balancer that is acting as the endpoint.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">openstack-nova-api</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-nova-api start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the <code class="systemitem">openstack-nova-api</code> service permanently.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-nova-api on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the Scheduler</strong></p><div class="para">
        Start the scheduler on each system that will be hosting an instance of it.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">openstack-nova-scheduler</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-nova-scheduler start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the <code class="systemitem">openstack-nova-scheduler</code> service permanently.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-nova-scheduler on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the Conductor</strong></p><div class="para">
        The conductor is intended to minimize or eliminate the need for Compute nodes to access the database directly. Compute nodes instead communicate with the conductor via a message broker and the conductor handles database access.
      </div><div class="para">
        Start the conductor on each system that is intended to host an instance of it. Note that it is recommended that this service is not run on each and every Compute node as this eliminates the security benefits of restricting direct database access from the Compute nodes.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">openstack-nova-conductor</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-nova-conductor start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the <code class="systemitem">openstack-nova-conductor</code> service permanently.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-nova-conductor on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting the Compute Service</strong></p><div class="para">
        Start the Compute service on every system that is intended to host virtual machine instances.
      </div><ol class="a"><li class="step"><div class="para">
            Use the <code class="command">service</code> command to start the <code class="systemitem">openstack-nova-compute</code> service.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-nova-compute start</code></code></strong></pre></li><li class="step"><div class="para">
            Use the <code class="command">chkconfig</code> command to enable the <code class="systemitem">openstack-nova-compute</code> service permanently.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig openstack-nova-compute on</code></code></strong></pre></li></ol></li><li class="step"><p class="title"><strong>Starting Optional Services</strong></p><div class="para">
        Depending on environment configuration you may also need to start these services:
      </div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="systemitem">openstack-nova-cert</code></span></dt><dd><div class="para">
              The X509 certificate service, required if you intend to use the EC2 API to the Compute service.
            </div></dd><dt><span class="term"><code class="systemitem">openstack-nova-network</code></span></dt><dd><div class="para">
              The Nova networking service. Note that you <span class="bold bold"><strong>must</strong></span> not start this service if you have installed and configured, or intend to install and configure, OpenStack networking.
            </div></dd><dt><span class="term"><code class="systemitem">openstack-nova-objectstore</code></span></dt><dd><div class="para">
              The Nova object storage service. It is recommended that the OpenStack Object Storage service (Swift) is used for new deployments.
            </div></dd></dl></div></li></ol></div><div class="para">
    The Compute services have been started and are ready to accept virtual machine instance requests.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15906-547052+%5BLatest%5D&amp;cf_build_id=15906-547052+17+Oct+2013+12%3A14+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+the+Compute+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_the_Dashboard"></a>Chapter&nbsp;15.&nbsp;Installing the Dashboard</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Dashboard_Service_Requirements">15.1. Dashboard Service Requirements</a></span></dt><dt><span class="section"><a href="#Installing_the_Dashboard_Packages">15.2. Installing the Dashboard Packages</a></span></dt><dt><span class="section"><a href="#Starting_the_Dashboard_Service">15.3. Starting the Apache Web Service</a></span></dt><dt><span class="section"><a href="#sect-Configuring_the_Dashboard">15.4. Configuring the Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#Configuring_Connections_and_Logging">15.4.1. Configuring Connections and Logging</a></span></dt><dt><span class="section"><a href="#Configuring_Secured_Deployment_HTTPS">15.4.2. Configuring Secured Deployment (HTTPS)</a></span></dt><dt><span class="section"><a href="#Creating_a_Member_Role">15.4.3. Creating a Member Role</a></span></dt><dt><span class="section"><a href="#Configuring_SELinux">15.4.4. Configuring SELinux</a></span></dt><dt><span class="section"><a href="#Configuring_the_Firewall5">15.4.5. Configuring the Dashboard Firewall</a></span></dt><dt><span class="section"><a href="#sect-Session_Storage_Options">15.4.6. Session Storage Options</a></span></dt></dl></dd><dt><span class="section"><a href="#Validating_the_Dashboard_Installation">15.5. Validating the Dashboard Installation</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Dashboard_Service_Requirements"></a>15.1.&nbsp;Dashboard Service Requirements</h2></div></div></div><div class="para">
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          The system hosting the Dashboard service must have:
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                The following already installed: <code class="systemitem">httpd</code>, <code class="systemitem">mod_wsgi</code>, and <code class="systemitem">mod_ssl</code> (for security purposes).
              </div></li><li class="listitem"><div class="para">
                A connection to the Identity service, as well as to the other OpenStack API services (OpenStack Compute, Block Storage, Object Storage, Image, and Networking services).
              </div></li></ul></div>

        </div></li><li class="listitem"><div class="para">
          The installer must know the URL of the Identity service endpoint.
        </div></li></ul></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To install <code class="systemitem">mod_wsgi</code>, <code class="systemitem">httpd</code>, and <code class="systemitem">mod_ssl</code>, execute as root:
<pre class="screen"><code class="prompt">#</code> yum install -y mod_wsgi httpd mod_ssl</pre>

    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15904-541150+%5BLatest%5D&amp;cf_build_id=15904-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Dashboard+Service+Requirements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_the_Dashboard_Packages"></a>15.2.&nbsp;Installing the Dashboard Packages</h2></div></div></div><div class="para">
    The steps in this procedure install the packages required by the OpenStack Dashboard service.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      The Dashboard service uses a configurable backend session store. This installation uses memcached as the session store. However, other options do exist. For more details, refer to <em class="citetitle">Session Storage Options</em>.
    </div></div></div><div class="para">
    The only required package is:
    <div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">openstack-dashboard</span></span></dt><dd><div class="para">
            Provides the OpenStack Dashboard service.
          </div></dd></dl></div>
     If using memcached, the following must also be installed:
    <div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">memcached</span></span></dt><dd><div class="para">
            Memory-object caching system, which speeds up dynamic web applications by alleviating database load.
          </div></dd><dt><span class="term"><span class="package">python-memcached</span></span></dt><dd><div class="para">
            Python interface to the memcached daemon.
          </div></dd></dl></div>
     This installation must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="orderedlist"><ol><li class="listitem"><div class="para">
        Install the memcached object caching system:
      </div><div class="para">

<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>yum install -y memcached python-memcached</code></strong></pre>

      </div></li><li class="listitem"><div class="para">
        Install the Dashboard package:
<pre class="screen"><code class="prompt">#</code><strong class="userinput"><code> yum install -y openstack-dashboard </code></strong></pre>

      </div></li></ol></div><div class="para">
    The OpenStack Dashboard service is installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15949-541150+%5BLatest%5D&amp;cf_build_id=15949-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Dashboard+Packages%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Starting_the_Dashboard_Service"></a>15.3.&nbsp;Starting the Apache Web Service</h2></div></div></div><div class="para">
    Because the Dashboard is a Django (Python) web application, it is hosted by the <code class="systemitem">httpd</code> service. To start the service, execute the following commands as the <code class="systemitem">root</code> user:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          To start the <code class="systemitem">service</code>, execute on the command line:
<pre class="screen"><code class="prompt">#</code> service httpd start
</pre>

        </div></li><li class="listitem"><div class="para">
          To ensure that the httpd service starts automatically in the future, execute:
<pre class="screen"><code class="prompt">#</code> chkconfig httpd on</pre>

        </div></li><li class="listitem"><div class="para">
          You can confirm that <code class="systemitem">httpd</code> is running by executing:
<pre class="screen"><code class="prompt">#</code> service --status-all | grep httpd
</pre>

        </div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15864-541150+%5BLatest%5D&amp;cf_build_id=15864-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+the+Apache+Web+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuring_the_Dashboard"></a>15.4.&nbsp;Configuring the Dashboard</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_Connections_and_Logging"></a>15.4.1.&nbsp;Configuring Connections and Logging</h3></div></div></div><div class="para">
    Before users connect to the dashboard for the first time, the following must be configured in the <code class="systemitem">/etc/openstack-dashboard/local_settings</code> file (sample files can be found in the <em class="citetitle">Configuration Reference Guide</em>):
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Cache Backend - As the <code class="systemitem">root</code> user, update the <code class="systemitem">CACHES</code> settings with the memcached values:
<pre class="screen">SESSION_ENGINE = 'django.contrib.sessions.backends.cache'
CACHES = {
  'default': {
    'BACKEND' : 'django.core.cache.backends.memcached.MemcachedCache',
    'LOCATION' : 'memcacheURL:port',
  }
}
</pre>

        </div><div class="para">
          Where:
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                <code class="systemitem">memcacheURL</code> is the host on which memcache was installed
              </div></li><li class="listitem"><div class="para">
                <code class="systemitem">port</code> is the value from the <code class="systemitem">PORT</code> parameter in the <code class="systemitem">/etc/sysconfig/memcached</code> file.
              </div></li></ul></div>

        </div></li><li class="listitem"><div class="para">
          Dashboard Host - Specify the host URL for your OpenStack Identity service endpoint. For example:
        </div><div class="para">

<pre class="screen"><code class="systemitem">OPENSTACK_HOST=&quot;127.0.0.1&quot;</code></pre>

        </div></li><li class="listitem"><div class="para">
          Time Zone - To change the dashboard's timezone, update the following (the time zone can also be changed using the dashboard GUI):
        </div><div class="para">

<pre class="screen"><code class="systemitem">TIME_ZONE=&quot;UTC&quot;</code></pre>

        </div></li><li class="listitem"><div class="para">
          To ensure the configuration changes take effect, restart the Apache web server.
        </div></li></ol></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      The <code class="systemitem">HORIZON_CONFIG</code> dictionary contains all the settings for the Dashboard. Whether or not a service is in the Dashboard depends on the Service Catalog configuration in the Identity service. For a full listing, refer to <a href="http://docs.openstack.org/developer/horizon/topics/settings.html">http://docs.openstack.org/developer/horizon/topics/settings.html</a> (<em class="citetitle">Horizon Settings and Configuration</em>).
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16078-556307+%5BLatest%5D&amp;cf_build_id=16078-556307+18+Nov+2013+11%3A59+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Connections+and+Logging%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_Secured_Deployment_HTTPS"></a>15.4.2.&nbsp;Configuring Secured Deployment (HTTPS)</h3></div></div></div><div class="para">
    Although the default installation uses a non-encrypted channel (HTTP), it is possible to enable SSL support for the OpenStack Dashboard. Use the following steps for enable HTTPS (switch out the example domain 'openstack.example.com' for that of your current setup):
  </div><div class="para">
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Edit the <code class="systemitem">/etc/openstack-dashboard/local_settings</code> file, and uncomment the following parameters:
<pre class="screen">SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTOCOL', 'https')
CSRF_COOKIE_SECURE = True
SESSION_COOKIE_SECURE = True</pre>
           The latter two settings instruct the browser to only send dashboard cookies over HTTPS connections, ensuring that sessions will not work over HTTP.
        </div></li><li class="listitem"><div class="para">
          Edit the <code class="systemitem">/etc/httpd/conf/httpd.conf</code> file, and add the following line:
<pre class="screen">NameVirtualHost *:443</pre>

        </div></li><li class="listitem"><div class="para">
          Edit the <code class="systemitem">/etc/httpd/conf.d/openstack-dashboard.conf</code> file, and substitute the 'Before' section for 'After':
        </div><div class="para">
          Before:
<pre class="screen">WSGIScriptAlias /dashboard /usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi
Alias /static /usr/share/openstack-dashboard/static/

&lt;Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi&gt;
    &lt;IfModule mod_deflate.c&gt;
      SetOutputFilter DEFLATE
      &lt;IfModule mod_headers.c&gt;
        # Make sure proxies don’t deliver the wrong content
        Header append Vary User-Agent env=!dont-vary
      &lt;/IfModule&gt;
    &lt;/IfModule&gt;

  Order allow,deny
  Allow from all
&lt;/Directory&gt;
</pre>

        </div><div class="para">
          After:
<pre class="screen">
&lt;VirtualHost *:80&gt;
  ServerName openstack.example.com
  RedirectPermanent / https://openstack.example.com/
&lt;/VirtualHost&gt;

&lt;VirtualHost *:443&gt;
    ServerName openstack.example.com
    SSLEngine On
    SSLCertificateFile /etc/httpd/SSL/openstack.example.com.crt
    SSLCACertificateFile /etc/httpd/SSL/openstack.example.com.crt
    SSLCertificateKeyFile /etc/httpd/SSL/openstack.example.com.key
    SetEnvIf User-Agent &quot;.*MSIE.*&quot; nokeepalive ssl-unclean-shutdown
    WSGIScriptAlias / /usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi
    WSGIDaemonProcess horizon user=apache group=apache processes=3 threads=10
    RedirectPermanent /dashboard https://openstack.example.com
    Alias /static /usr/share/openstack-dashboard/static/
    &lt;Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi&gt;
      Order allow,deny
      Allow from all
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre>

        </div><div class="para">
          In the 'After' configuration, Apache listens on port 443 and redirects all non-secured requests to the HTTPs protocol. In the secured section, the private key, the public key, and the certificate are defined for usage.
        </div></li><li class="listitem"><div class="para">
          As the <code class="systemitem">root</code> user, restart Apache and memcached:
<pre class="screen"><code class="prompt">#</code><strong class="userinput"><code> service httpd restart</code></strong>
<code class="prompt">#</code><strong class="userinput"><code> service memcached restart</code></strong></pre>
           If the HTTP version of the dashboard is used now via the browser, the user should be redirected to the HTTPs version of the page.
        </div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16119-553037+%5BLatest%5D&amp;cf_build_id=16119-553037+12+Nov+2013+09%3A55+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Secured+Deployment+%28HTTPS%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_a_Member_Role"></a>15.4.3.&nbsp;Creating a Member Role</h3></div></div></div><div class="para">
    The Dashboard service requires a Identity role named the 'Member' role. You must create this role in the Identity service prior to using the dashboard.
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the system on which your <code class="systemitem">keystonerc_admin</code> file resides and authenticate as the Identity administrator:
<pre class="screen"><code class="prompt">#</code> source <em class="replaceable"><code>~/keystonerc_admin</code></em></pre>

        </div></li><li class="listitem"><div class="para">
          Use the <code class="systemitem">keystone role-create</code> command to create the <code class="literal">Member</code> role:
        </div><div class="para">

<pre class="screen"><code class="prompt">#</code> keystone role-create --name <em class="replaceable"><code>Member</code></em>
+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
| id       | <em class="replaceable"><code>8261ac4eabcc4da4b01610dbad6c038a</code></em> |
| name     |              Member              |
+----------+----------------------------------+</pre>

        </div></li></ol></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To configure the Dashboard service to use a role other than the <code class="literal">Member</code> role, change the value of the <code class="literal">OPENSTACK_KEYSTONE_DEFAULT_ROLE</code> configuration key, which is stored in:
    </div><div class="para">
      <code class="systemitem">/etc/openstack-dashboard/local_settings</code>
    </div><div class="para">
      The <code class="systemitem">httpd</code> service must be restarted for the change to take effect.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15951-541150+%5BLatest%5D&amp;cf_build_id=15951-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+a+Member+Role%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_SELinux"></a>15.4.4.&nbsp;Configuring SELinux</h3></div></div></div><div class="para">
    SELinux is a security feature of Red Hat Enterprise Linux, which provides access control. Possible status values are Enforcing, Permissive, and Disabled. If SELinux is configured in 'Enforcing' mode, you must modify the SELinux policy to allow connections from the httpd service to the Identity server. This is also recommended if SELinux is configured in 'Permissive' mode.
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Use the <code class="systemitem">getenforce</code> command to check the status of SELinux on the system:
<pre class="screen"><code class="prompt">#</code> getenforce</pre>

        </div></li><li class="listitem"><div class="para">
          If the resulting value is 'Enforcing' or 'Permissive', use the <code class="systemitem">setsebool</code> command as the <code class="systemitem">root</code> user to allow <code class="systemitem">httpd</code>-Identity service connections:
<pre class="screen"><code class="prompt">#</code> setsebool -P httpd_can_network_connect on</pre>

        </div></li></ol></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      You can also view the status of SELinux using:
<pre class="screen"><code class="prompt">#</code> sestatus
SELinux status:                 enabled
SELinuxfs mount:                /selinux
Current mode:                   permissive
Mode from config file:          enforcing
Policy version:                 24
Policy from config file:        targeted
</pre>
       For more information, refer to the <em class="citetitle">Security-Enhanced Linux User Guide for Red Hat Enterprise Linux</em>.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16754-541150+%5BLatest%5D&amp;cf_build_id=16754-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+SELinux%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_the_Firewall5"></a>15.4.5.&nbsp;Configuring the Dashboard Firewall</h3></div></div></div><div class="para">
    To allow users to connect to the dashboard, you must configure the system firewall to allow connections. The httpd service, and the dashboard, support both HTTP and HTTPS connections.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To protect authentication credentials and other data, it is highly recommended that you only enable HTTPS connections.
    </div></div></div><div class="para">
    Execute the following as the <code class="systemitem">root</code> user:
  </div><div class="para">
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Edit the <code class="systemitem">/etc/sysconfig/iptables</code> configuration file:
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                Allow incoming connections using just HTTPS by adding this firewall rule to the file:
<pre class="screen">-A INPUT -p tcp --dport 443 -j ACCEPT</pre>

              </div></li><li class="listitem"><div class="para">
                Allow incoming connections using both HTTP and HTTPS by adding this firewall rule to the file:
<pre class="screen">-A INPUT -p tcp -m multiport --dports 80,443 -j ACCEPT</pre>

              </div></li></ul></div>

        </div></li><li class="listitem"><div class="para">
          Restart the iptables service for the changes to take effect.
<pre class="screen"><code class="prompt">#</code><strong class="userinput"><code> service iptables restart</code></strong></pre>

        </div></li></ol></div>

  </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
      These rules allow communication from all remote hosts to the system running the Dashboard service on ports 80 or 443. For information regarding the creation of more restrictive firewall rules, refer to the <em class="citetitle">Red Hat Enterprise Linux 6 Security Guide</em>.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15920-541150+%5BLatest%5D&amp;cf_build_id=15920-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+the+Dashboard+Firewall%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Session_Storage_Options"></a>15.4.6.&nbsp;Session Storage Options</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Local_Memory_Cache_Session_Storage"></a>15.4.6.1.&nbsp;Configuring Local Memory Cache Session Storage</h4></div></div></div><div class="para">
    Local memory storage is the quickest and easiest session backend to set up, because it has no external dependencies. However, it does have two significant drawbacks:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          No shared storage across processes or workers.
        </div></li><li class="listitem"><div class="para">
          No persistence after a process terminates.
        </div></li></ul></div>

  </div><div class="para">
    The local memory backend is enabled as the default for the Dashboard service solely because it has no dependencies. However, it is not recommended for production use, or even for serious development work.
  </div><div class="para">
    To use local memory for storage, include the following in the <code class="systemitem">/etc/openstack-dashboard/local_settings</code> file:
<pre class="screen">SESSION_ENGINE = 'django.contrib.sessions.backends.cache'
CACHES = {
     'default': {
          'BACKEND': 'django.core.cache.backends.locmem.LocMemCache'
     }
}
</pre>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15889-541150+%5BLatest%5D&amp;cf_build_id=15889-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Local+Memory+Cache+Session+Storage%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Memcached_Session_Storage"></a>15.4.6.2.&nbsp;Configuring Memcached Session Storage</h4></div></div></div><div class="para">
    External caching using an application such as memcached offers persistence and shared storage, and can be very useful for small-scale deployment and/or development. The Dashboard installation process in this guide recommends the use of memcached for external caching (for configuration details, refer to <em class="citetitle">Configuring Connections and Logging</em>).
  </div><div class="para">
    However, for distributed and high-availability scenarios, memcached has inherent problems which are beyond the scope of this documentation. Memcached is an extremely fast and efficient cache backend for cases where it fits the deployment need, but it’s not appropriate for all scenarios.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15880-541150+%5BLatest%5D&amp;cf_build_id=15880-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Memcached+Session+Storage%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Database_Session_Storage"></a>15.4.6.3.&nbsp;Configuring Database Session Storage</h4></div></div></div><div class="para">
    Database-backed sessions are scalable (using an appropriate database strategy), persistent, and can be made high-concurrency and highly-available. The downside to this approach is that database-backed sessions are one of the slower session storages, and incur a high overhead under heavy usage. Proper configuration of your database deployment can also be a substantial undertaking and is far beyond the scope of this documentation.
  </div><div class="para">
    To enable database session storage, follow the below steps as the <code class="systemitem">root</code> user to initialize the database and configure it for use:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Start the MySQL command-line client, by executing:
<pre class="screen"><code class="prompt">#</code><strong class="userinput"><code> mysql -u root -p</code></strong></pre>

        </div></li><li class="listitem"><div class="para">
          Specify the MySQL root user's password when prompted.
        </div></li><li class="listitem"><div class="para">
          Create the <code class="systemitem">dash</code> database:
<pre class="screen"><code class="prompt">mysql&gt;</code><strong class="userinput"><code> CREATE DATABASE dash;</code></strong></pre>

        </div></li><li class="listitem"><div class="para">
          Create a MySQL user for the newly-created dash database who has full control of the database.
<pre class="screen"><code class="prompt">mysql&gt;</code> <strong class="userinput"><code>GRANT ALL ON dash.* TO 'dash'@'%' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</code></strong></pre>

<pre class="screen"><code class="prompt">mysql&gt;</code> <strong class="userinput"><code>GRANT ALL ON dash.* TO 'dash'@'localhost' IDENTIFIED BY '<em class="replaceable"><code>PASSWORD</code></em>';</code></strong></pre>
           Replace <em class="replaceable"><code>PASSWORD</code></em> with a secure password for the new database user to authenticate with.
        </div></li><li class="listitem"><div class="para">
          Enter quit at the <code class="systemitem">mysql&gt;</code> prompt to exit the MySQL client.
        </div></li><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/openstack-dashboard/local_settings</code> file, change the following options to refer to the new MySQL database:
<pre class="screen">SESSION_ENGINE = 'django.contrib.sessions.backends.cached_db'
DATABASES = {
  'default': {
    # Database configuration here
    'ENGINE': 'django.db.backends.mysql',
    'NAME': 'dash',
    'USER': 'dash',
    'PASSWORD': '<em class="replaceable"><code>PASSWORD</code></em>',
    'HOST': '<em class="replaceable"><code>HOST</code></em>',
    'default-character-set': 'utf8'
  }
}</pre>
           Replace <em class="replaceable"><code>PASSWORD</code></em> with the password of the <code class="systemitem">dash</code> database user and replace <em class="replaceable"><code>HOST</code></em> with the IP address or fully qualified domain name of the databse server.
        </div></li><li class="listitem"><div class="para">
          Populate the new database by executing:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /usr/share/openstack-dashboard</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>python manage.py syncdb</code></strong></pre>
           Note: You will be asked to create an admin account; this is not required.
        </div><div class="para">
          As a result, the following should be displayed:
<pre class="screen">Installing custom SQL ...
Installing indexes ...
DEBUG:django.db.backends:(0.008) CREATE INDEX `django_session_c25c2c28` ON
`django_session` (`expire_date`);; args=()
No fixtures found.</pre>

        </div></li><li class="listitem"><div class="para">
          Restart Apache to pick up the default site and symbolic link settings:
<pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service httpd restart</code></strong></pre>

        </div></li><li class="listitem"><div class="para">
          Restart the <code class="systemitem">openstack-nova-api</code> service to ensure the API server can connect to the Dashboard and to avoid an error displayed in the Dashboard.
<pre class="screen"><code class="prompt">#</code><strong class="userinput"><code>service openstack-nova-api restart</code></strong></pre>

        </div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15858-541150+%5BLatest%5D&amp;cf_build_id=15858-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Database+Session+Storage%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Cached_Database_Session_Storage"></a>15.4.6.4.&nbsp;Configuring Cached Database Session Storage</h4></div></div></div><div class="para">
    To mitigate the performance issues of database queries, Django’s <code class="systemitem">cached_db session</code> backend can be used, which utilizes both the database and caching infrastructure to perform write-through caching and efficient retrieval.
  </div><div class="para">
    Enable this hybrid setting by configuring both your database and cache as discussed above and then using:
<pre class="screen"><strong class="userinput"><code>SESSION_ENGINE = &quot;django.contrib.sessions.backends.cached_db&quot;</code></strong></pre>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15947-541150+%5BLatest%5D&amp;cf_build_id=15947-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Cached+Database+Session+Storage%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuring_Cookies_Session_Storage"></a>15.4.6.5.&nbsp;Configuring Cookies Session Storage</h4></div></div></div><div class="para">
    The cookies-session backend avoids server load and scaling problems because it stores session data in a cookie, which is stored by the user’s browser. The backend uses a cryptographic signing technique, together with the SECRET_KEY, to ensure session data is not tampered with during transport (this is not the same as encryption, session data is still readable by an attacker).
  </div><div class="para">
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Advantages:
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                Does not require additional dependencies or infrastructure overhead.
              </div></li><li class="listitem"><div class="para">
                Scales indefinitely as long as the quantity of session data being stored fits into a normal cookie.
              </div></li></ul></div>

        </div></li><li class="listitem"><div class="para">
          Disadvantages:
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                Places session data into storage on the user’s machine and transports it over the wire.
              </div></li><li class="listitem"><div class="para">
                Limits the quantity of session data which can be stored.
              </div></li></ul></div>

        </div></li></ul></div>
     <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
        For a thorough discussion of the security implications of this session backend, please read the Django documentation on cookie-based sessions:
      </div><div class="para">
        <a href="https://docs.djangoproject.com/en/dev/topics/http/sessions/#s-using-cookie-based-sessions">https://docs.djangoproject.com/en/dev/topics/http/sessions/#s-using-cookie-based-sessions</a>
      </div></div></div>

  </div><div class="para">
    To enable cookie-session storage:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/openstack-dashboard/local_settings</code> file, set:
<pre class="screen"><strong class="userinput"><code>SESSION_ENGINE = &quot;django.contrib.sessions.backends.signed_cookies&quot;</code></strong></pre>

        </div></li><li class="listitem"><div class="para">
          Add a randomly-generated <code class="systemitem">SECRET_KEY</code> to the project by executing on the command line:
<pre class="screen"><code class="prompt">$</code><strong class="userinput"><code>django-admin.py startproject</code></strong></pre>

        </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
            The <code class="systemitem">SECRET_KEY</code> is a text string, which can be specified manually or automatically generated (as in this procedure). You will just need to ensure that the key is unique (that is, does not match any other password on the machine).
          </div></div></div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15861-541150+%5BLatest%5D&amp;cf_build_id=15861-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+Cookies+Session+Storage%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Validating_the_Dashboard_Installation"></a>15.5.&nbsp;Validating the Dashboard Installation</h2></div></div></div><div class="para">
    Once the Dashboard has been successfully installed and configured, you can access the user interface with your web browser. Replace <code class="systemitem">HOSTNAME</code> with the host name or IP address of the server on which you installed the Dashboard service:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          HTTPS
<pre class="screen">https://HOSTNAME/dashboard/</pre>

        </div></li><li class="listitem"><div class="para">
          HTTP
<pre class="screen">http://HOSTNAME/dashboard/</pre>

        </div></li></ul></div>

  </div><div class="para">
    When prompted, log in using the credentials of your OpenStack user. For information on creating an OpenStack user, refer to <em class="citetitle">Creating a Regular User Account</em>.
    <div class="figure"><a id="idp219328"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2450.png" align="middle" alt="Dashboard Login Screen" /></div></div><p class="title"><strong>Figure&nbsp;15.1.&nbsp;Dashboard Login Screen</strong></p></div><br class="figure-break" />

  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Creating_User_Accounts1">Section&nbsp;9.8, “Creating a Regular User Account”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15857-541150+%5BLatest%5D&amp;cf_build_id=15857-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Validating+the+Dashboard+Installation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="part"><div class="titlepage"><div><div><h1 class="title"><a id="part-Validating_the_Installation"></a>Part&nbsp;IV.&nbsp;Validating the Installation</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#chap-Working_with_Instances">16. Working with Instances</a></span></dt><dd><dl><dt><span class="section"><a href="#Uploading_a_Disk_Image">16.1. Uploading a Disk Image</a></span></dt><dt><span class="section"><a href="#Creating_a_Keypair">16.2. Creating a Keypair</a></span></dt><dt><span class="section"><a href="#Creating_a_Network">16.3. Creating a Network</a></span></dt><dt><span class="section"><a href="#Launching_an_Instance">16.4. Launching an Instance</a></span></dt><dt><span class="section"><a href="#Creating_a_Volume_and_Attaching_a_Volume_to_the_Instance">16.5. Creating a Volume</a></span></dt><dt><span class="section"><a href="#Attaching_a_Volume_to_an_Instance">16.6. Attaching a Volume to an Instance</a></span></dt><dt><span class="section"><a href="#Creating_an_Instance_Snapshot">16.7. Creating an Instance Snapshot</a></span></dt><dt><span class="section"><a href="#Terminating_the_Instance">16.8. Controlling the State of an Instance (Pause, Suspend, Reboot)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chap-Updating_the_Environment">17. Updating the Environment</a></span></dt><dd><dl><dt><span class="section"><a href="#Defining_a_Floating_IP-Address_Pool1">17.1. Defining a Floating IP-Address Pool</a></span></dt><dt><span class="section"><a href="#Creating_a_Router">17.2. Creating a Router</a></span></dt><dt><span class="section"><a href="#Associating_a_Floating_IP_with_the_Instance">17.3. Associating a Floating IP with the Instance</a></span></dt><dt><span class="section"><a href="#Creating_a_Security_Group">17.4. Adding a Rule to a Security Group</a></span></dt></dl></dd></dl></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Working_with_Instances"></a>Chapter&nbsp;16.&nbsp;Working with Instances</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Uploading_a_Disk_Image">16.1. Uploading a Disk Image</a></span></dt><dt><span class="section"><a href="#Creating_a_Keypair">16.2. Creating a Keypair</a></span></dt><dt><span class="section"><a href="#Creating_a_Network">16.3. Creating a Network</a></span></dt><dt><span class="section"><a href="#Launching_an_Instance">16.4. Launching an Instance</a></span></dt><dt><span class="section"><a href="#Creating_a_Volume_and_Attaching_a_Volume_to_the_Instance">16.5. Creating a Volume</a></span></dt><dt><span class="section"><a href="#Attaching_a_Volume_to_an_Instance">16.6. Attaching a Volume to an Instance</a></span></dt><dt><span class="section"><a href="#Creating_an_Instance_Snapshot">16.7. Creating an Instance Snapshot</a></span></dt><dt><span class="section"><a href="#Terminating_the_Instance">16.8. Controlling the State of an Instance (Pause, Suspend, Reboot)</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Uploading_a_Disk_Image"></a>16.1.&nbsp;Uploading a Disk Image</h2></div></div></div><div class="para">
    You can upload an image by either using the command-line glance tool (refer to <em class="citetitle">Adding an Image to the Image service</em>), or by using the dashboard. This procedure uses the dashboard. This means that you must have first:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Installed the dashboard (refer to <em class="citetitle">Installing the Dashboard</em>).
        </div></li><li class="listitem"><div class="para">
          Have an available image for use (refer to <em class="citetitle">Obtaining a Test Disk Image</em>).
        </div></li></ul></div>

  </div><div class="para">
    To upload an image using the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard as a user that has the <code class="literal">Member</code> role.
          <div class="figure"><a id="idp2719048"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2624.png" align="middle" width="40%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.1.&nbsp;User login</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Images &amp; Snapshots</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Create Image</strong></span> button. The <span class="guilabel"><strong>Create An Image</strong></span> dialog is displayed.
          <div class="figure"><a id="idp44132880"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2625.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.2.&nbsp;Create An Image Dialog</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          Configure the settings that define your instance on the <span class="guilabel"><strong>Details</strong></span> tab.
        </div><div class="para">
          <div class="orderedlist"><ol><li class="listitem"><div class="para">
                Enter a name for the image.
              </div></li><li class="listitem"><div class="para">
                Use the location of your image file in the <span class="guilabel"><strong>Image Location</strong></span> field.
              </div></li><li class="listitem"><div class="para">
                Select the correct type from the drop-down menu in the <span class="guilabel"><strong>Format</strong></span> field (for example, <code class="literal">QCOW2</code>).
              </div></li><li class="listitem"><div class="para">
                Leave the <span class="guilabel"><strong>Minimum Disk (GB)</strong></span> and <span class="guilabel"><strong>Minimum RAM (MB)</strong></span> fields empty.
              </div></li><li class="listitem"><div class="para">
                Select the <span class="guilabel"><strong>Public</strong></span> box.
              </div></li><li class="listitem"><div class="para">
                Click the <span class="guibutton"><strong>Create Image</strong></span> button.
              </div></li></ol></div>

        </div></li></ol></div>

  </div><div class="para">
    You have successfully uploaded an image.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_Dashboard">Chapter&nbsp;15, <em>Installing the Dashboard</em></a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15903-541150+%5BLatest%5D&amp;cf_build_id=15903-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Uploading+a+Disk+Image%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_a_Keypair"></a>16.2.&nbsp;Creating a Keypair</h2></div></div></div><div class="para">
    When a Compute instance is launched, a keypair must be specified, which allows the secure logging in of users into the instance. This section details the steps to create a keypair using the dashboard; this means you must have first installed the dashboard (refer to <em class="citetitle">Installing the Dashboard</em>).
  </div><div class="para">
    On the host running the Compute service:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Access &amp; Security</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          On the <span class="guilabel"><strong>Keypairs</strong></span> tab, click the <span class="guibutton"><strong>Create Keypair</strong></span> button. The <span class="guilabel"><strong>Create Keypair</strong></span> dialog is displayed.
          <div class="figure"><a id="idm10665920"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2639.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.3.&nbsp;Create Keypair</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          Specify a name in the <span class="guilabel"><strong>Keypair Name</strong></span> field, and click the <span class="guibutton"><strong>Create Keypair</strong></span> button.
        </div></li></ol></div>

  </div><div class="para">
    This creates the keypair, which can be used when launching an instance.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="itemizedlist"><ul><li class="listitem"><div class="para">
          When a keypair is created, a keypair file is automatically downloaded through the browser. You can optionally load this file into ssh, for command-line ssh connections, by executing:
<pre class="screen"><code class="prompt"># </code>ssh-add ~/.ssh/<em class="replaceable"><code>NAME</code></em>.pem</pre>

        </div></li><li class="listitem"><div class="para">
          To delete an existing keypair, click the keypair's <span class="guibutton"><strong>Delete Keypair</strong></span> button on the <span class="guilabel"><strong>Keypairs</strong></span> tab.
        </div></li></ul></div></div></div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_Dashboard">Chapter&nbsp;15, <em>Installing the Dashboard</em></a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15842-541150+%5BLatest%5D&amp;cf_build_id=15842-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+a+Keypair%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_a_Network"></a>16.3.&nbsp;Creating a Network</h2></div></div></div><div class="para">
    To create a network from the dashboard, you must have first:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Installed the dashboard (refer to <em class="citetitle">Installing the Dashboard</em>).
        </div></li><li class="listitem"><div class="para">
          Installed OpenStack Networking Services (refer to <em class="citetitle">Installing the OpenStack Networking Service</em>).
        </div></li></ul></div>

  </div><div class="para">
    To create a network using the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Networks</strong></span> in the <span class="guimenu"><strong>Manage Network</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Create Network</strong></span> button. The <span class="guilabel"><strong>Create Network</strong></span> dialog is displayed.
          <div class="figure"><a id="idp9927544"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2631.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.4.&nbsp;Create Network: Network Tab</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          By default, the dialog opens to the <span class="guilabel"><strong>Network</strong></span> tab. You have the option of specifying a network name.
        </div></li><li class="listitem"><div class="para">
          To define the network's subnet, click on the <span class="guilabel"><strong>Subnet</strong></span> and <span class="guilabel"><strong>Subnet Detail</strong></span> tabs. Click into each field for field tips.
          <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
              You do not have to initially specify a subnet (although this will result in any attached instance having the status of 'error'). If you do not define a specific subnet, clear the <span class="guilabel"><strong>Create Subnet</strong></span> check box.
            </div></div></div>

        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Create</strong></span> button.
        </div></li></ol></div>

  </div><div class="para">
    You have now created a new network.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_Dashboard">Chapter&nbsp;15, <em>Installing the Dashboard</em></a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_OpenStack_Networking_Service">Chapter&nbsp;13, <em>Installing the OpenStack Networking Service</em></a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17893-541150+%5BLatest%5D&amp;cf_build_id=17893-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+a+Network%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Launching_an_Instance"></a>16.4.&nbsp;Launching an Instance</h2></div></div></div><div class="para">
    To launch an instance from the dashboard you must have first:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Uploaded an image to use as the basis for your instances (refer to <em class="citetitle">Uploading a Disk Image</em>).
        </div></li><li class="listitem"><div class="para">
          Created a network (refer to <em class="citetitle">Creating a Network</em>).
        </div></li></ul></div>

  </div><div class="para">
    To launch an instance using the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Instances</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Launch Instance</strong></span> button. The <span class="guilabel"><strong>Launch Instance</strong></span> dialog is displayed.
          <div class="figure"><a id="idp9096848"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2629.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.5.&nbsp;Launch Instance: Details Tab</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          By default, the dialog opens to the <span class="guilabel"><strong>Details</strong></span> tab:
          <div class="orderedlist"><ol><li class="listitem"><div class="para">
                Select an <span class="guilabel"><strong>Instance Source</strong></span> for your instance. Available values are:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      <span class="guilabel"><strong>Image</strong></span>
                    </div></li><li class="listitem"><div class="para">
                      <span class="guilabel"><strong>Snapshot</strong></span>
                    </div></li></ul></div>

              </div></li><li class="listitem"><div class="para">
                Select an <span class="guilabel"><strong>Image</strong></span> or <span class="guilabel"><strong>Snapshot</strong></span> to use when launching your instance. The image selected defines the operating system and architecture of your instance.
              </div></li><li class="listitem"><div class="para">
                Enter an <span class="guilabel"><strong>Instance Name</strong></span> to identify your instance.
              </div></li><li class="listitem"><div class="para">
                Select a <span class="guilabel"><strong>Flavor</strong></span> for your instance. The flavor determines the compute resources available to your instance. After a flavor is selected, their resources are displayed in the <span class="guilabel"><strong>Flavor Details</strong></span> pane for preview.
              </div></li><li class="listitem"><div class="para">
                Enter an <span class="guilabel"><strong>Instance Count</strong></span>. This determines how many instances to launch using the selected options.
              </div></li></ol></div>

        </div></li><li class="listitem"><div class="para">
          Click the <span class="guilabel"><strong>Access &amp; Security</strong></span> tab and configure the security settings for your instance:
          <div class="figure"><a id="idp11852144"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2630.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.6.&nbsp;Launch Instance: Access and Security Tab</strong></p></div><br class="figure-break" />
           <div class="orderedlist"><ol><li class="listitem"><div class="para">
                Either select an existing keypair from the <span class="guilabel"><strong>Keypair</strong></span> drop down box, or click the <span class="guilabel"><strong>+</strong></span> button to upload a new keypair.
              </div></li><li class="listitem"><div class="para">
                Select the <span class="guilabel"><strong>Security Groups</strong></span> that you wish to apply to your instances. By default, only the <span class="guilabel"><strong>default</strong></span> security group will be available.
              </div></li></ol></div>

        </div></li><li class="listitem"><div class="para">
          Click the <span class="guilabel"><strong>Networking</strong></span> tab and select the network for the instance by clicking on the network's + sign:
          <div class="figure"><a id="idp14214408"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2632.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.7.&nbsp;Launch Instance: Networking Tab</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Launch</strong></span> button.
        </div></li></ol></div>

  </div><div class="para">
    You have just created a Compute instance.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To launch the instance console from the Dashboard:
      <div class="orderedlist"><ol><li class="listitem"><div class="para">
            On the <span class="guilabel"><strong>Instances</strong></span> tab, click the name of your instance. The <span class="guilabel"><strong>Instance Detail</strong></span> page is displayed.
          </div></li><li class="listitem"><div class="para">
            Click the <span class="guibutton"><strong>Console</strong></span> tab on the resultant page.
          </div></li></ol></div>
       An instance of the VNC console is run within the browser.
    </div></div></div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Uploading_a_Disk_Image">Section&nbsp;16.1, “Uploading a Disk Image”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Creating_a_Keypair">Section&nbsp;16.2, “Creating a Keypair”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Creating_a_Network">Section&nbsp;16.3, “Creating a Network”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15844-541150+%5BLatest%5D&amp;cf_build_id=15844-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Launching+an+Instance%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_a_Volume_and_Attaching_a_Volume_to_the_Instance"></a>16.5.&nbsp;Creating a Volume</h2></div></div></div><div class="para">
    Compute instances support the attachment and detachment of block storage volumes. This procedure details the steps involved in creating a logical volume using the dashboard.
  </div><div class="para">
    To create a volume from the dashboard, you must have first:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Installed the dashboard (refer to <em class="citetitle">Installing the Dashboard</em>).
        </div></li><li class="listitem"><div class="para">
          Installed the Block Storage service (refer to <em class="citetitle">Installing OpenStack Block Storage</em>).
        </div></li></ul></div>

  </div><div class="para">
    To create a volume using the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Volumes</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Create Volume</strong></span> button. The <span class="guilabel"><strong>Create Volume</strong></span> dialog is displayed:
          <div class="figure"><a id="idp9388584"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2633.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.8.&nbsp;Create Volume Dialog</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          To configure the volume:
          <div class="orderedlist"><ol><li class="listitem"><div class="para">
                Enter a <span class="guilabel"><strong>Volume Name</strong></span> to identify your new volume by.
              </div></li><li class="listitem"><div class="para">
                Enter a <span class="guilabel"><strong>Description</strong></span> to further describe your new volume.
              </div></li><li class="listitem"><div class="para">
                Enter the <span class="guilabel"><strong>Size</strong></span> of your new volume in gigabytes (GB).
              </div></li></ol></div>
           <div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
              In this guide, LVM storage is configured as the <code class="literal">cinder-volumes</code> volume group (refer to <em class="citetitle">Configuring for LVM Storage Backend</em>). There must be enough free disk space in the <code class="literal">cinder-volumes</code> volume group for your new volume to be allocated.
            </div></div></div>

        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Create Volume</strong></span> button to create the new volume.
        </div></li></ol></div>

  </div><div class="para">
    You have successfully created a Block Storage volume using the dashboard.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_Dashboard">Chapter&nbsp;15, <em>Installing the Dashboard</em></a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_OpenStack_Block_Storage">Chapter&nbsp;12, <em>Installing OpenStack Block Storage</em></a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15819-541150+%5BLatest%5D&amp;cf_build_id=15819-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+a+Volume%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Attaching_a_Volume_to_an_Instance"></a>16.6.&nbsp;Attaching a Volume to an Instance</h2></div></div></div><div class="para">
    This procedure details the steps involved in attaching a Block Storage volume to an existing Compute instance using the dashboard.
  </div><div class="para">
    To create a volume from the dashboard, you must have first:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Launched an instance (refer to <em class="citetitle">Launching an Instance</em>).
        </div></li><li class="listitem"><div class="para">
          Created a volume (refer to <em class="citetitle">Creating a Volume</em>).
        </div></li></ul></div>

  </div><div class="para">
    To attach a volume to an instance using the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard as a user.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Volumes</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Edit Attachments</strong></span> button on the row associated with the volume that you want to attach to an instance. The <span class="guilabel"><strong>Manage Volume Attachments</strong></span> dialog is displayed.
          <div class="figure"><a id="idm9721056"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2640.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.9.&nbsp;Manage Volume Attachments</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          Select the instance for the volume in the <span class="guilabel"><strong>Attach to Instance</strong></span> field.
        </div></li><li class="listitem"><div class="para">
          Specifiy the device name in the <span class="guilabel"><strong>Device Name</strong></span> field (for example, '/dev/vdc').
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Attach Volume</strong></span> button.
        </div></li></ol></div>

  </div><div class="para">
    You have successfully attached a Block Storage volume to an instance using the dashboard. The volume will appear as a physical hard disk drive to the guest operating system.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Launching_an_Instance">Section&nbsp;16.4, “Launching an Instance”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Creating_a_Volume_and_Attaching_a_Volume_to_the_Instance">Section&nbsp;16.5, “Creating a Volume”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16836-541150+%5BLatest%5D&amp;cf_build_id=16836-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Attaching+a+Volume+to+an+Instance%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_an_Instance_Snapshot"></a>16.7.&nbsp;Creating an Instance Snapshot</h2></div></div></div><div class="para">
    This procedure details the steps involved in creating a snapshot based on a running instance using the dashboard. This may be done for backup purposes or for creating a base image to create other instances after applying customization.
  </div><div class="para">
    To create a snapshot, a running instance must be available (refer to <em class="citetitle">Launching an Instance</em>).
  </div><div class="para">
    To create a snapshot using the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Instances</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Create Snapshot</strong></span> button on the row associated with the instance of which you want to take a snapshot.
          <div class="figure"><a id="idp8371944"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2634.png" align="middle" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.10.&nbsp;Creating a Snapshot</strong></p></div><br class="figure-break" />

        </div><div class="para">
          The <span class="guilabel"><strong>Create Snapshot</strong></span> dialog is displayed.
        </div></li><li class="listitem"><div class="para">
          Enter a descriptive name for your snapshot in the <span class="guilabel"><strong>Snapshot Name</strong></span> field.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Create Snapshot</strong></span> button to create the snapshot.
        </div><div class="para">
          Your new snapshot will appear in the <span class="guilabel"><strong>Image Snapshots</strong></span> table in the <span class="guilabel"><strong>Images &amp; Snapshots</strong></span> screen.
        </div></li></ol></div>

  </div><div class="para">
    You have successfully created a snapshot of your instance; the snapshot can be used to restore an instance state or as a basis for spawning new instances.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Launching_an_Instance">Section&nbsp;16.4, “Launching an Instance”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15856-541150+%5BLatest%5D&amp;cf_build_id=15856-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+an+Instance+Snapshot%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Terminating_the_Instance"></a>16.8.&nbsp;Controlling the State of an Instance (Pause, Suspend, Reboot)</h2></div></div></div><div class="para">
    To change the state of an instance using the dashboard, you must have first launched an instance (refer to <em class="citetitle">Launching an Image</em>).
  </div><div class="para">
    To change the state of an instance:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Instances</strong></span> in the <span class="guilabel"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Select the instance for which you want to change the state and click on the <span class="guibutton"><strong>More</strong></span> dropdown button. The dropdown list is displayed.
          <div class="figure"><a id="idp14126056"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2635.png" align="middle" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;16.11.&nbsp;Instance Menu</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          Click one of the options to change the instance state.
        </div></li></ol></div>

  </div><div class="para">
    You have successfully changed the state of the instance.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Launching_an_Instance">Section&nbsp;16.4, “Launching an Instance”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15946-541150+%5BLatest%5D&amp;cf_build_id=15946-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Controlling+the+State+of+an+Instance+%28Pause%2C+Suspend%2C+Reboot%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Updating_the_Environment"></a>Chapter&nbsp;17.&nbsp;Updating the Environment</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Defining_a_Floating_IP-Address_Pool1">17.1. Defining a Floating IP-Address Pool</a></span></dt><dt><span class="section"><a href="#Creating_a_Router">17.2. Creating a Router</a></span></dt><dt><span class="section"><a href="#Associating_a_Floating_IP_with_the_Instance">17.3. Associating a Floating IP with the Instance</a></span></dt><dt><span class="section"><a href="#Creating_a_Security_Group">17.4. Adding a Rule to a Security Group</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Defining_a_Floating_IP-Address_Pool1"></a>17.1.&nbsp;Defining a Floating IP-Address Pool</h2></div></div></div><div class="para">
    By default, each virtual instance is automatically assigned a private IP address in the network to which it is assigned. You may optionally assign public IP addresses to instances.
  </div><div class="para">
    OpenStack uses the term &quot;floating IP&quot; to refer to an IP address that can be dynamically added to a running virtual instance. In OpenStack Networking, a floating IP pool is represented as an external network and a floating IP is allocated from a subnet associated with the external network.
  </div><div class="para">
    For this procedure, you must first have installed OpenStack Networking (refer to <em class="citetitle">Installing the OpenStack Networking Service</em>).
  </div><div class="para">
    To define a pool of floating IP addresses:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Create an external network for the pool:
<pre class="screen"><code class="prompt">#</code> neutron net-create <em class="replaceable"><code>networkName</code></em> --router:external=True</pre>
         <div class="example"><a id="idp6142008"></a><p class="title"><strong>Example&nbsp;17.1.&nbsp;Defining an External Network</strong></p><div class="example-contents"><pre class="screen"><code class="prompt">#</code> neutron net-create ext-net --router:external=True
Created a new network:
+---------------------------+--------------------------------------+
| Field                     | Value                                |
+---------------------------+--------------------------------------+
| admin_state_up            | True                                 |
| id                        | 3a53e3be-bd0e-4c05-880d-2b11aa618aff |
| name                      | ext-net                              |
| provider:network_type     | local                                |
| provider:physical_network |                                      |
| provider:segmentation_id  |                                      |
| router:external           | True                                 |
| shared                    | False                                |
| status                    | ACTIVE                               |
| subnets                   |                                      |
| tenant_id                 | 6b406408dff14a2ebf6d2cd7418510b2     |
+---------------------------+--------------------------------------+</pre></div></div><br class="example-break" />

      </div></li><li class="step"><div class="para">
        Create the pool of floating IP addresses:
      </div><pre class="screen"><code class="prompt">$</code> neutron subnet-create  --allocation-pool start=<em class="replaceable"><code>IPStart</code></em>,end=<em class="replaceable"><code>IPStart</code></em> --gateway <em class="replaceable"><code>GatewayIP</code></em> --disable-dhcp <em class="replaceable"><code>networkName</code></em> <em class="replaceable"><code>CIDR</code></em></pre><div class="example"><a id="idm4857936"></a><p class="title"><strong>Example&nbsp;17.2.&nbsp;Defining a Pool of Floating IP Addresses</strong></p><div class="example-contents"><pre class="screen"><code class="prompt">$</code> neutron subnet-create --allocation-pool start=10.38.15.128,end=10.38.15.159 --gateway 10.38.15.254 --disable-dhcp ext-net 10.38.15.0/24
Created a new subnet:
+------------------+--------------------------------------------------+
| Field            | Value                                            |
+------------------+--------------------------------------------------+
| allocation_pools | {&quot;start&quot;: &quot;10.38.15.128&quot;, &quot;end&quot;: &quot;10.38.15.159&quot;} |
| cidr             | 10.38.15.0/24                                    |
| dns_nameservers  |                                                  |
| enable_dhcp      | False                                            |
| gateway_ip       | 10.38.15.254                                     |
| host_routes      |                                                  |
| id               | 6a15f954-935c-490f-a1ab-c2a1c1b1529d             |
| ip_version       | 4                                                |
| name             |                                                  |
| network_id       | 4ad5e73b-c575-4e32-b581-f9207a22eb09             |
| tenant_id        | e5be83dc0a474eeb92ad2cda4a5b94d5                 |
+------------------+--------------------------------------------------+
</pre></div></div><br class="example-break" /></li></ol></div><div class="para">
    You have successfully created a pool of floating IP addresses.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_OpenStack_Networking_Service">Chapter&nbsp;13, <em>Installing the OpenStack Networking Service</em></a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17922-550071+%5BLatest%5D&amp;cf_build_id=17922-550071+01+Nov+2013+10%3A17+en-US+%5BLatest%5D&amp;comment=Title%3A+Defining+a+Floating+IP-Address+Pool%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_a_Router"></a>17.2.&nbsp;Creating a Router</h2></div></div></div><div class="para">
    This section details the steps to create a router using the dashboard, which connects an internal network to an external one. You must first have:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Installed the dashboard (refer to <em class="citetitle">Installing the Dashboard</em>).
        </div></li><li class="listitem"><div class="para">
          Created an external network (refer to <em class="citetitle">Defining a Floating IP-Address Pool</em>).
        </div></li><li class="listitem"><div class="para">
          Created an internal network (refer to <em class="citetitle">Creating a Network</em>).
        </div></li></ul></div>

  </div><div class="para">
    To create a router:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log in to the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Routers</strong></span> in the <span class="guilabel"><strong>Manage Network</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          Click on the <span class="guibutton"><strong>Create Router</strong></span> button. The <span class="guilabel"><strong>Create Router</strong></span> window is displayed:
          <div class="figure"><a id="idp3708904"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2641.png" align="middle" width="60%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;17.1.&nbsp;Create Router</strong></p></div><br class="figure-break" />

        </div></li><li class="listitem"><div class="para">
          Specify the router's name and click the <span class="guibutton"><strong>Create router</strong></span> button. The new router is now displayed in the router list.
        </div></li><li class="listitem"><div class="para">
          Click the new router's <span class="guibutton"><strong>Set Gateway</strong></span> button.
        </div></li><li class="listitem"><div class="para">
          Specify the network to which the router will connect in the <span class="guilabel"><strong>External Network</strong></span> field, and click the <span class="guibutton"><strong>Set Gateway</strong></span> button.
        </div></li><li class="listitem"><div class="para">
          To connect a private network to the newly created router:
          <div class="orderedlist"><ol><li class="listitem"><div class="para">
                Click on the router name in the router list:
                <div class="figure"><a id="idp277200"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2645.png" align="middle" width="60%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;17.2.&nbsp;Select the router</strong></p></div><br class="figure-break" />

              </div></li><li class="listitem"><div class="para">
                Click the <span class="guibutton"><strong>Add Interface</strong></span> button. The <span class="guilabel"><strong>Add Interface</strong></span> window is displayed:
                <div class="figure"><a id="idp10256776"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2646.png" align="middle" width="60%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;17.3.&nbsp;Add Interface</strong></p></div><br class="figure-break" />

              </div></li><li class="listitem"><div class="para">
                Specify the new subnet to which the router should be attached in the <span class="guilabel"><strong>Subnet</strong></span> field, and click <span class="guibutton"><strong>Add Interface</strong></span>.
              </div></li></ol></div>

        </div></li></ol></div>

  </div><div class="para">
    You have successfully created the router; you can view the new topology by clicking on <span class="guilabel"><strong>Network Topology</strong></span> in the <span class="guilabel"><strong>Manage Network</strong></span> menu.
    <div class="figure"><a id="idp8602896"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2644.png" align="middle" width="60%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;17.4.&nbsp;Network Topology</strong></p></div><br class="figure-break" />

  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_Dashboard">Chapter&nbsp;15, <em>Installing the Dashboard</em></a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Defining_a_Floating_IP-Address_Pool1">Section&nbsp;17.1, “Defining a Floating IP-Address Pool”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Creating_a_Network">Section&nbsp;16.3, “Creating a Network”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+17931-541150+%5BLatest%5D&amp;cf_build_id=17931-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+a+Router%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Associating_a_Floating_IP_with_the_Instance"></a>17.3.&nbsp;Associating a Floating IP with the Instance</h2></div></div></div><div class="para">
    When an instance is created in OpenStack, it is automatically assigned a fixed IP address in the network to which the instance is assigned. This IP address is permanently associated with the instance until the instance is terminated.
  </div><div class="para">
    However, a floating IP address can also be attached to an instance (in addition to their fixed IP address). Unlike fixed IP addresses, floating IP addresses are able to have their associations modified at any time, regardless of the state of the instances involved. This procedure details the reservation of a floating IP address from an existing pool of addresses and the association of that address with a specific instance.
  </div><div class="para">
    To associate a floating IP address, you must have first:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Created a pool of floating IP addresses (refer to <em class="citetitle">Defining a Floating IP-Address Pool</em>).
        </div></li><li class="listitem"><div class="para">
          Launched an instance (refer to <em class="citetitle">Launching an Instance</em>).
        </div></li></ul></div>
     To associate an instance with a floating IP address:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Log in to the dashboard as a user that has the <code class="literal">Member</code> role.
      </div></li><li class="step"><div class="para">
        Click <span class="guilabel"><strong>Access &amp; Security</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
      </div></li><li class="step"><div class="para">
        Click the <span class="guibutton"><strong>Allocate IP To Project</strong></span> button. The <span class="guilabel"><strong>Allocate Floating IP</strong></span> window is displayed.
      </div></li><li class="step"><div class="para">
        Select a pool of addresses from the <span class="guilabel"><strong>Pool</strong></span> list.
      </div></li><li class="step"><div class="para">
        Click the <span class="guibutton"><strong>Allocate IP</strong></span> button. The allocated IP address will appear in the <span class="guilabel"><strong>Floating IPs</strong></span> table.
      </div></li><li class="step"><div class="para">
        Locate the newly allocated IP address in the <span class="guilabel"><strong>Floating IPs</strong></span> table. On the same row click the <span class="guibutton"><strong>Associate Floating IP</strong></span> button to assign the IP address to a specific instance.
      </div><div class="para">
        The <span class="guilabel"><strong>Manage Floating IP Associations</strong></span> window is displayed:
        <div class="figure"><a id="idm942480"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2643.png" align="middle" width="75%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;17.5.&nbsp;Manage Floating IP Associations</strong></p></div><br class="figure-break" />

      </div></li><li class="step"><div class="para">
        The <span class="guilabel"><strong>IP Address</strong></span> field is automatically set to the selected floating IP address.
      </div><div class="para">
        Select the instance (with which to associate the floating IP address) from the <span class="guilabel"><strong>Port to be associated</strong></span> list.
      </div></li><li class="step"><div class="para">
        Click the <span class="guibutton"><strong>Associate</strong></span> button to associate the IP address with the selected instance.
      </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          To disassociate a floating IP address from an instance when it is no longer required use the <span class="guibutton"><strong>Disassociate Floating IP</strong></span> button.
        </div></div></div></li></ol></div><div class="para">
    You have successfully associated a floating IP address with an instance using the dashboard.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#Defining_a_Floating_IP-Address_Pool1">Section&nbsp;17.1, “Defining a Floating IP-Address Pool”</a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#Launching_an_Instance">Section&nbsp;16.4, “Launching an Instance”</a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15896-541150+%5BLatest%5D&amp;cf_build_id=15896-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Associating+a+Floating+IP+with+the+Instance%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Creating_a_Security_Group"></a>17.4.&nbsp;Adding a Rule to a Security Group</h2></div></div></div><div class="para">
    Security groups are used to specify what IP traffic is allowed to reach an instance on its public IP address. The rules defined by security groups are processed before network traffic reaches any firewall rules defined within the guest itself. You must first have:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Installed the dashboard (refer to <em class="citetitle">Installing the Dashboard</em>).
        </div></li><li class="listitem"><div class="para">
          Installed OpenStack Networking (refer to <em class="citetitle">Installing the OpenStack Networking Service</em>).
        </div></li></ul></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      In the default configuration, the 'default' security group accepts all connections from the 'default' source; all instances with the 'default' group can talk to each other on any port.
    </div></div></div><div class="para">
    To add a new rule using the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Log into the dashboard.
        </div></li><li class="listitem"><div class="para">
          Click <span class="guilabel"><strong>Access &amp; Security</strong></span> in the <span class="guimenu"><strong>Manage Compute</strong></span> menu.
        </div></li><li class="listitem"><div class="para">
          In the <span class="guilabel"><strong>Security Groups</strong></span> pane, click the <span class="guibutton"><strong>Edit Rules</strong></span> button on the row for the <code class="literal">default</code> security group. The <span class="guilabel"><strong>Edit Security Group Rules</strong></span> window is displayed.
        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Add Rule</strong></span> button. The <span class="guilabel"><strong>Add Rule</strong></span> window is displayed.
        </div></li><li class="listitem"><div class="para">
          Configure the rule:
          <div class="orderedlist"><ol><li class="listitem"><div class="para">
                Select the protocol to which the rule must apply from the <span class="guilabel"><strong>IP Protocol</strong></span> list.
              </div></li><li class="listitem"><div class="para">
                Define the port or ports to which the rule will apply using the <span class="guilabel"><strong>Open</strong></span> field:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      <code class="systemitem">Port</code> - Define a specific port in the <span class="guilabel"><strong>Port</strong></span> field
                    </div></li><li class="listitem"><div class="para">
                      <code class="systemitem">Port Range</code> - Define the port range using the <span class="guilabel"><strong>From Port</strong></span> and <span class="guilabel"><strong>To Port</strong></span> fields.
                    </div></li></ul></div>

              </div></li><li class="listitem"><div class="para">
                Define the IP address from which connections should be accepted on the defined port using the <span class="guilabel"><strong>Source</strong></span> field:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      <code class="systemitem">CIDR</code> - Enter a specific IP address in the <span class="guilabel"><strong>CIDR</strong></span> field using the Classless Inter-Domain Routing (CIDR) notation. A value of 0.0.0.0/0 allows connections from all IP addresses.
                    </div></li><li class="listitem"><div class="para">
                      <code class="systemitem">Security Group</code> - Select an existing security group from the <span class="guilabel"><strong>Source Group</strong></span> drop-down list. This allows connections from any instances from the specified security group.
                    </div></li></ul></div>

              </div></li></ol></div>

        </div></li><li class="listitem"><div class="para">
          Click the <span class="guibutton"><strong>Add Rule</strong></span> button to add the new rule to the security group.
        </div></li></ol></div>

  </div><div class="para">
    You have successfully added a rule to a security group using the dashboard. It is now possible to connect to instances that use the altered security group from the specified IP address block and using the specified ports and protocol.
  </div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_Dashboard">Chapter&nbsp;15, <em>Installing the Dashboard</em></a>
      </div></li><li class="listitem"><div class="para">
        <a class="xref" href="#chap-Installing_the_OpenStack_Networking_Service">Chapter&nbsp;13, <em>Installing the OpenStack Networking Service</em></a>
      </div></li></ul></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15843-541150+%5BLatest%5D&amp;cf_build_id=15843-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Adding+a+Rule+to+a+Security+Group%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="part"><div class="titlepage"><div><div><h1 class="title"><a id="part-Monitoring_the_OpenStack_Environment"></a>Part&nbsp;V.&nbsp;Monitoring the OpenStack Environment</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#chap-Monitoring_OpenStack_using_Nagios">18. Monitoring OpenStack using Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#sect-Installing_Nagios">18.1. Installing Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Nagios_Service">18.1.1. Installing the Nagios Service</a></span></dt><dt><span class="section"><a href="#Installing_the_NPRE_Addon">18.1.2. Installing the NRPE Addon</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Configuring_Nagios">18.2. Configuring Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#Setting_up_Nagios">18.2.1. Setting up Nagios</a></span></dt><dt><span class="section"><a href="#Configuring_HTTPD">18.2.2. Configuring HTTPD</a></span></dt><dt><span class="section"><a href="#Configure_OpenStack_Services">18.2.3. Configuring OpenStack Services</a></span></dt><dt><span class="section"><a href="#Installing_and_Configuring_NRPE">18.2.4. Configuring NRPE</a></span></dt><dt><span class="section"><a href="#Creating_Host_Definitions">18.2.5. Creating Host Definitions</a></span></dt><dt><span class="section"><a href="#Creating_Service_Definitions">18.2.6. Creating Service Definitions</a></span></dt><dt><span class="section"><a href="#Verifying_the_Configuration">18.2.7. Verifying the Configuration</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Installing_and_Configuring_Remote_Logging">19. Installing and Configuring Remote Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#Introduction_to_Remote_Logging">19.1. Introduction to Remote Logging</a></span></dt><dt><span class="section"><a href="#Installing_an_rsyslog_Server">19.2. Installing rsyslog Server</a></span></dt><dt><span class="section"><a href="#Configuring_the_rsyslog_Server">19.3. Configuring rsyslog on the Centralized Logging Server</a></span></dt><dt><span class="section"><a href="#Configuring_rsyslog_on_the_Individual_Nodes">19.4. Configuring rsyslog on the Individual Nodes</a></span></dt><dt><span class="section"><a href="#Starting_rsyslog_Server">19.5. Starting rsyslog Server</a></span></dt></dl></dd></dl></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Monitoring_OpenStack_using_Nagios"></a>Chapter&nbsp;18.&nbsp;Monitoring OpenStack using Nagios</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#sect-Installing_Nagios">18.1. Installing Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#Installing_the_Nagios_Service">18.1.1. Installing the Nagios Service</a></span></dt><dt><span class="section"><a href="#Installing_the_NPRE_Addon">18.1.2. Installing the NRPE Addon</a></span></dt></dl></dd><dt><span class="section"><a href="#sect-Configuring_Nagios">18.2. Configuring Nagios</a></span></dt><dd><dl><dt><span class="section"><a href="#Setting_up_Nagios">18.2.1. Setting up Nagios</a></span></dt><dt><span class="section"><a href="#Configuring_HTTPD">18.2.2. Configuring HTTPD</a></span></dt><dt><span class="section"><a href="#Configure_OpenStack_Services">18.2.3. Configuring OpenStack Services</a></span></dt><dt><span class="section"><a href="#Installing_and_Configuring_NRPE">18.2.4. Configuring NRPE</a></span></dt><dt><span class="section"><a href="#Creating_Host_Definitions">18.2.5. Creating Host Definitions</a></span></dt><dt><span class="section"><a href="#Creating_Service_Definitions">18.2.6. Creating Service Definitions</a></span></dt><dt><span class="section"><a href="#Verifying_the_Configuration">18.2.7. Verifying the Configuration</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Installing_Nagios"></a>18.1.&nbsp;Installing Nagios</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Installing_the_Nagios_Service"></a>18.1.1.&nbsp;Installing the Nagios Service</h3></div></div></div><div class="para">
    The Nagios monitoring system can be used to provide monitoring and alerts for the OpenStack network and infrastructure. The following installation procedure installs:
  </div><div class="para">
    <div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="package">nagios</span></span></dt><dd><div class="para">
            Nagios program that monitors hosts and services on the network, and which can send email or page alerts when a problem arises and when a problem is resolved.
          </div></dd><dt><span class="term"><span class="package">nagios-devel</span></span></dt><dd><div class="para">
            Includes files which can be used by Nagios-related applications.
          </div></dd><dt><span class="term"><span class="package">nagios-plugins*</span></span></dt><dd><div class="para">
            Nagios plugins for Nagios-related applications (including ping and nrpe).
          </div></dd><dt><span class="term"><span class="package">gd and gd-devel</span></span></dt><dd><div class="para">
            gd Graphics Library, for dynamically creating images, and the gd development libraries for gd.
          </div></dd><dt><span class="term"><span class="package">php</span></span></dt><dd><div class="para">
            HTML-embedded scripting language, used by Nagios for the web interface.
          </div></dd><dt><span class="term"><span class="package">gcc, glibc, and glibc-common</span></span></dt><dd><div class="para">
            GNU compiler collection, together with standard programming libraries and binaries (including locale support).
          </div></dd><dt><span class="term"><span class="package">openssl</span></span></dt><dd><div class="para">
            OpenSSL toolkit, which provides support for secure communication between machines.
          </div></dd></dl></div>

  </div><div class="para">
    Install the required packages as the <code class="systemitem">root</code> user, using the <code class="systemitem">yum</code> command:
<pre class="screen"><code class="prompt">#</code> yum install nagios nagios-devel nagios-plugins* gd gd-devel php gcc glibc glibc-common openssl</pre>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      If any of the packages is not immediately available (for example, gd-devel or gcc), you might have to enable the optional Red Hat channel using subscription-manager:
<pre class="screen"><code class="prompt">#</code> subscription-manager repos --enable rhel-6-server-optional-rpms
</pre>

    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15913-541150+%5BLatest%5D&amp;cf_build_id=15913-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+Nagios+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Installing_the_NPRE_Addon"></a>18.1.2.&nbsp;Installing the NRPE Addon</h3></div></div></div><div class="para">
    NRPE (Nagios Remote Plugin Executor) plugins are compiled executables or scripts that are used to check the status of a host's service, and report back to the Nagios service. If the OpenStack cloud is distributed across machines, the NPRE addon can be used to run access plugin information on those remote machines.
  </div><div class="para">
    NRPE and the Nagios plugins must be installed on each remote machine to be monitored. On the remote machine, and as the <code class="systemitem">root</code> user, execute the following:
<pre class="screen"><code class="prompt">#</code> yum install -y nrpe nagios-plugins* openssl</pre>

  </div><div class="para">
    After the installation, you can view all available plugins in the <code class="systemitem">/usr/lib64/nagios/plugins</code> directory (depending on the machine, they may be in <code class="systemitem">/usr/lib/nagios/plugins</code>).
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      SSH can also be used to access remote Nagios plugins. However, this can result in too high a CPU load on both the Nagios host and remote machine, and is not recommended.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15855-541150+%5BLatest%5D&amp;cf_build_id=15855-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+the+NRPE+Addon%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuring_Nagios"></a>18.2.&nbsp;Configuring Nagios</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Setting_up_Nagios"></a>18.2.1.&nbsp;Setting up Nagios</h3></div></div></div><div class="para">
    Nagios is composed of a server, plugins that report object/host information from both local and remote machines back to the server, a web interface, and configuration that ties all of it together.
  </div><div class="para">
    At a minimum, the following must be done:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Check web-interface user name and password, and check basic configuration.
        </div></li><li class="listitem"><div class="para">
          Add OpenStack monitoring to the local server.
        </div></li><li class="listitem"><div class="para">
          If the OpenStack cloud includes distributed hosts:
          <div class="orderedlist"><ol><li class="listitem"><div class="para">
                Install and configure NRPE on each remote machine (that has services to be monitored).
              </div></li><li class="listitem"><div class="para">
                Tell Nagios which hosts are being monitored.
              </div></li><li class="listitem"><div class="para">
                Tell Nagios which services are being monitored for each host.
              </div></li></ol></div>

        </div></li></ol></div>

  </div><div class="para">
    <div class="table"><a id="idp11713688"></a><p class="title"><strong>Table&nbsp;18.1.&nbsp;Nagios Configuration Files</strong></p><div class="table-contents"><table summary="Nagios Configuration Files"><colgroup><col width="20%" align="left" class="c1" /><col width="80%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              File Name
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                <code class="systemitem">/etc/nagios/nagios.cfg</code>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Main Nagios configuration file.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <code class="systemitem">/etc/nagios/cgi.cfg</code>
              </div>

            </td><td class="" align="left">
              <div class="para">
                CGI configuration file.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <code class="systemitem">/etc/httpd/conf.d/nagios.conf</code>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Nagios configuration for httpd.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <code class="systemitem">/etc/nagios/passwd</code>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Password file for Nagios users.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <code class="systemitem">/usr/local/nagios/etc/ResourceName.cfg</code>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Contains user-specific settings.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <code class="systemitem">/etc/nagios/objects/ObjectsDir/ObjectsFile.cfg</code>
              </div>

            </td><td class="" align="left">
              <div class="para">
                Object definition files that are used to store information about items such as services or contact groups.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                <code class="systemitem">/etc/nagios/nrpe.cfg</code>
              </div>

            </td><td class="" align="left">
              <div class="para">
                NRPE configuration file.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16837-541150+%5BLatest%5D&amp;cf_build_id=16837-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Setting+up+Nagios%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configuring_HTTPD"></a>18.2.2.&nbsp;Configuring HTTPD</h3></div></div></div><div class="para">
    By default, when Nagios is installed, the default httpd user and password is: <code class="systemitem">nagiosadmin / nagiosadmin</code>. This value can be viewed in the <code class="systemitem">/etc/nagios/cgi.cfg</code> file.
  </div><div class="para">
    To configure HTTPD for Nagios, execute the following as the <code class="systemitem">root</code> user:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          To change the default password for the user nagiosadmin, execute:
<pre class="screen"><code class="prompt">#</code> htpasswd -c /etc/nagios/passwd <em class="parameter"><code>nagiosadmin</code></em></pre>

        </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
            To create a new user, use the following command with the new user's name:
<pre class="screen"><code class="prompt">#</code> htpasswd /etc/nagios/passwd <em class="parameter"><code>newUserName</code></em></pre>

          </div></div></div></li><li class="listitem"><div class="para">
          Update the <code class="systemitem">nagiosadmin</code> email address in <code class="systemitem">/etc/nagios/objects/contacts.cfg</code>
<pre class="screen">define contact{
        contact_name   nagiosadmin            ; Short name of user
        [...snip...]
        email          yourName@example.com   ; &lt;&lt;*****CHANGE THIS******
        }
</pre>

        </div></li><li class="listitem"><div class="para">
          Verify that the basic configuration is working:
<pre class="screen"><code class="prompt">#</code> nagios -v /etc/nagios/nagios.cfg</pre>

        </div><div class="para">
          If errors occur, check the parameters set in <code class="systemitem">/etc/nagios/nagios.cfg</code>
        </div></li><li class="listitem"><div class="para">
          Ensure that Nagios is started automatically when the system boots.
<pre class="screen"><code class="prompt">#</code> chkconfig --add nagios
<code class="prompt">#</code> chkconfig nagios on</pre>

        </div></li><li class="listitem"><div class="para">
          Start up Nagios and restart httpd:
<pre class="screen"><code class="prompt">#</code> service httpd restart
<code class="prompt">#</code> service nagios start</pre>

        </div></li><li class="listitem"><div class="para">
          Check your Nagios access by using the following URL in your browser, and using the nagiosadmin user and the password that was set in Step 1:
<pre class="screen">http://<em class="parameter"><code>nagiosHostURL</code></em>/nagios</pre>
           <div class="figure"><a id="idm2863648"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2477.png" align="middle" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;18.1.&nbsp;Nagios Login</strong></p></div><br class="figure-break" />

        </div></li></ol></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      If the Nagios URL cannot be accessed, ensure your firewall rules has been set up correctly (refer to <em class="citetitle">Configuring the Dashboard Firewall</em>).
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16848-541150+%5BLatest%5D&amp;cf_build_id=16848-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+HTTPD%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_OpenStack_Services"></a>18.2.3.&nbsp;Configuring OpenStack Services</h3></div></div></div><div class="para">
    By default, on the Nagios server, the <code class="systemitem">/etc/nagios/objects/localhost.cfg</code> file is used to define services for basic local statistics (for example, swap usage or the number of current users). You can always comment these services out if they are no longer needed by prefacing each line with a '#' character. This same file can be used to add new OpenStack monitoring services.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      Additional service files can be used, but they must be specified as a <code class="systemitem">cfg_file</code> parameter in the <code class="systemitem">/etc/nagios/nagios.cfg</code> file.
    </div></div></div><div class="para">
    To add an OpenStack service into the list of monitored services, execute the following as the <code class="systemitem">root</code> user:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Write a short script for the item to be monitored (for example, whether a service is running), and place it in the <code class="systemitem">/usr/lib64/nagios/plugins</code> directory.
        </div><div class="para">
          For example, the following script checks the number of Compute instances, and is stored in a file named <code class="systemitem">nova-list</code>:
<pre class="screen">#!/bin/env bash
export OS_USERNAME=<em class="parameter"><code>userName</code></em>
export OS_TENANT_NAME=<em class="parameter"><code>tenantName</code></em>
export OS_PASSWORD=<em class="parameter"><code>password</code></em>
export OS_AUTH_URL=http://<em class="parameter"><code>identityURL</code></em>:35357/v2.0/

data=$(nova list  2&gt;&amp;1)
rv=$?

if [ &quot;$rv&quot; != &quot;0&quot; ] ; then
    echo $data
    exit $rv
fi

echo &quot;$data&quot; | grep -v -e '--------' -e '| Status |' -e '^$' | wc -l</pre>

        </div></li><li class="listitem"><div class="para">
          Ensure the script is executable:
<pre class="screen"><code class="prompt">#</code> chmod u+x nova-list</pre>

        </div></li><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/nagios/objects/commands.cfg</code> file, specify a command section for each new script:
<pre class="screen">define command {
        command_line                   /usr/lib64/nagios/plugins/nova-list
        command_name                   nova-list
}</pre>

        </div></li><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/nagios/objects/localhost.cfg</code> file, define a service for each new item, using the defined command. For example:
<pre class="screen">
define service {
        check_command   nova-list
        host_name       <em class="parameter"><code>localURL</code></em>
        name            nova-list
        normal_check_interval   5
        service_description     Number of nova vm instances
        use             generic-service
        }
</pre>

        </div></li><li class="listitem"><div class="para">
          Restart nagios using:
<pre class="screen"><code class="prompt">#</code> service nagios restart</pre>

        </div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16916-541150+%5BLatest%5D&amp;cf_build_id=16916-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+OpenStack+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Installing_and_Configuring_NRPE"></a>18.2.4.&nbsp;Configuring NRPE</h3></div></div></div><div class="para">
    To set up monitoring on each remote machine, execute the following as the <code class="systemitem">root</code> user:
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        In the <code class="systemitem">/etc/nagios/nrpe.cfg</code> file, add the central Nagios server IP address in the <code class="systemitem">allowed_hosts</code> line:
<pre class="screen">allowed_hosts=127.0.0.1, <em class="parameter"><code>NagiosServerIP</code></em></pre>

      </div></li><li class="step"><div class="para">
        In the <code class="systemitem">/etc/nagios/nrpe.cfg</code> file, add any commands to be used to monitor the OpenStack services. For example:
<pre class="screen">command[keystone]=/usr/lib64/nagios/plugins/check_procs -c 1: -w 3: -C keystone-all
</pre>

      </div><div class="para">
        Each defined command can then be specified in the <code class="systemitem">services.cfg</code> file on the Nagios monitoring server (refer to <em class="citetitle">Creating Service Definitions</em>).
      </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
          Any complicated monitoring can be placed into a script, and then referred to in the command definition. For an OpenStack script example, refer to <em class="citetitle">Configuring OpenStack Services</em>.
        </div></div></div></li><li class="step"><div class="para">
        Configure the <code class="systemitem">iptables</code> firewall to allow <span class="application"><strong>nrpe</strong></span> traffic.
      </div><ol class="a"><li class="step"><div class="para">
            Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
          </div></li><li class="step"><div class="para">
            Add an <code class="literal">INPUT</code> rule allowing UDP traffic on port 5666 to this file. The new rule must appear before any <code class="literal">INPUT</code> rules that <code class="literal">REJECT</code> traffic.
          </div><pre class="screen">-A INPUT -p tcp --dport 5666 -j ACCEPT</pre></li><li class="step"><div class="para">
            Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
          </div></li><li class="step"><div class="para">
            Restart the <code class="systemitem">iptables</code> service for the firewall changes to take effect.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></li><li class="step"><div class="para">
        Start the NRPE service:
<pre class="screen"><code class="prompt">#</code> service nrpe start</pre>

      </div></li></ol></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16861-555715+%5BLatest%5D&amp;cf_build_id=16861-555715+14+Nov+2013+09%3A30+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+NRPE%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_Host_Definitions"></a>18.2.5.&nbsp;Creating Host Definitions</h3></div></div></div><div class="para">
    If additional machines are being used in the cloud, in addition to the host on which Nagios is installed, they must be made known to Nagios by configuring them in an objects file.
  </div><div class="para">
    Execute the following as the <code class="systemitem">root</code> user:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/nagios/objects</code> directory, create a <code class="systemitem">hosts.cfg</code> file.
        </div></li><li class="listitem"><div class="para">
          In the file, specify a <code class="systemitem">host</code> section for each machine on which an OpenStack service is running and should be monitored:
<pre class="screen">define host{
    use linux-server
    host_name <em class="parameter"><code>remoteHostName</code></em>
    alias <em class="parameter"><code>remoteHostAlias</code></em>
    address <em class="parameter"><code>remoteAddress</code></em>
}</pre>

        </div><div class="para">
          where:
          <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                <code class="systemitem">host_name</code> = Name of the remote machine to be monitored (typically listed in the local <code class="systemitem">/etc/hosts</code> file). This name is used to reference the host in service and host group definitions.
              </div></li><li class="listitem"><div class="para">
                <code class="systemitem">alias</code> = Name used to easily identify the host (typically the same as the <code class="systemitem">host_name</code>).
              </div></li><li class="listitem"><div class="para">
                <code class="systemitem">address</code> = Host address (typically its IP address, although a FQDN can be used instead, just make sure that DNS services are available).
              </div></li></ul></div>

        </div><div class="para">
          For example:
<pre class="screen">define host{
  host_name     Server-ABC
  alias   OS-ImageServices
  address 192.168.1.254
}
</pre>

        </div></li><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/nagios/nagios.cfg</code> file, under the <code class="systemitem">OBJECT CONFIGURATION FILES</code> section, specify the following line:
<pre class="screen">cfg_file=/etc/nagios/objects/hosts.cfg</pre>

        </div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15891-541150+%5BLatest%5D&amp;cf_build_id=15891-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+Host+Definitions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Creating_Service_Definitions"></a>18.2.6.&nbsp;Creating Service Definitions</h3></div></div></div><div class="para">
    To monitor remote services, you must create a new file, <code class="systemitem">/etc/nagios/objects/services.cfg</code> (as the <code class="systemitem">root</code> user):
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/nagios/objects/commands.cfg</code> file, specify the following to handle the use of the <code class="systemitem">check_nrpe</code> plugin with remote scripts or plugins:
<pre class="screen">
define command{
        command_name    check_nrpe
        command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c $ARG1$
 }

</pre>

        </div></li><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/nagios/objects</code> directory, create the <code class="systemitem">services.cfg</code> file.
        </div></li><li class="listitem"><div class="para">
          In the file, specify the following <code class="systemitem">service</code> sections for each remote OpenStack host to be monitored:
<pre class="screen">##Basic remote checks#############
##Remember that <em class="parameter"><code>remoteHostName</code></em> is defined in the hosts.cfg file.

define service{
  use generic-service
  host_name <em class="parameter"><code>remoteHostName</code></em>
  service_description PING
  check_command check_ping!100.0,20%!500.0,60%
}

define service{
  use generic-service
  host_name <em class="parameter"><code>remoteHostName</code></em>
  service_description Load Average
  check_command check_nrpe!check_load
}

##OpenStack Service Checks#######
define service{
  use generic-service
  host_name <em class="parameter"><code>remoteHostName</code></em>
  service_description Identity Service
  check_command check_nrpe!keystone
}
</pre>

        </div><div class="para">
          The above sections ensure that a server heartbeat, load check, and the OpenStack Identity service status are reported back to the Nagios server. All OpenStack services can be reported, just ensure that a matching command is specified in the remote server's <code class="systemitem">nrpe.cfg</code> file.
        </div></li><li class="listitem"><div class="para">
          In the <code class="systemitem">/etc/nagios/nagios.cfg</code> file, under the <code class="systemitem">OBJECT CONFIGURATION FILES</code> section, specify the following line:
<pre class="screen">cfg_file=/etc/nagios/objects/services.cfg</pre>

        </div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15824-541150+%5BLatest%5D&amp;cf_build_id=15824-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Creating+Service+Definitions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Verifying_the_Configuration"></a>18.2.7.&nbsp;Verifying the Configuration</h3></div></div></div><div class="para">
    Execute the following as the <code class="systemitem">root</code> user:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Verify that the updated configuration is working:
<pre class="screen"><code class="prompt">#</code> nagios -v /etc/nagios/nagios.cfg</pre>

        </div><div class="para">
          If errors occur, check the parameters set in <code class="systemitem">/etc/nagios/nagios.cfg</code>, <code class="systemitem">/etc/nagios/services.cfg</code>, and <code class="systemitem">/etc/nagios/hosts.cfg</code>.
        </div></li><li class="listitem"><div class="para">
          Restart Nagios:
<pre class="screen"><code class="prompt">#</code> service nagios restart</pre>

        </div></li><li class="listitem"><div class="para">
          Log into the Nagios dashboard again by using the following URL in your browser, and using the <code class="systemitem">nagiosadmin</code> user and the password that was set in Step 1:
<pre class="screen">http://nagiosHostURL/nagios</pre>

        </div></li></ol></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15898-541150+%5BLatest%5D&amp;cf_build_id=15898-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Verifying+the+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Installing_and_Configuring_Remote_Logging"></a>Chapter&nbsp;19.&nbsp;Installing and Configuring Remote Logging</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Introduction_to_Remote_Logging">19.1. Introduction to Remote Logging</a></span></dt><dt><span class="section"><a href="#Installing_an_rsyslog_Server">19.2. Installing rsyslog Server</a></span></dt><dt><span class="section"><a href="#Configuring_the_rsyslog_Server">19.3. Configuring rsyslog on the Centralized Logging Server</a></span></dt><dt><span class="section"><a href="#Configuring_rsyslog_on_the_Individual_Nodes">19.4. Configuring rsyslog on the Individual Nodes</a></span></dt><dt><span class="section"><a href="#Starting_rsyslog_Server">19.5. Starting rsyslog Server</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Introduction_to_Remote_Logging"></a>19.1.&nbsp;Introduction to Remote Logging</h2></div></div></div><div class="para">
    All systems generate and update log files recording their actions and any problems they encounter. In a distributed or cloud computing environment that contains many systems collecting these log files in a central location simplifies debugging.
  </div><div class="para">
    The <code class="systemitem">rsyslog</code> service provides facilities both for running a centralized logging server and for configuring individual systems to send their log files to the centralized logging server. This is referred to as configuring the systems for &quot;remote logging&quot;.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15982-541150+%5BLatest%5D&amp;cf_build_id=15982-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Introduction+to+Remote+Logging%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installing_an_rsyslog_Server"></a>19.2.&nbsp;Installing rsyslog Server</h2></div></div></div><div class="para">
    The <span class="package">rsyslog</span> package must be installed on the system that you intend to use as a centralized logging server and all systems that will be configured to send logs to it.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        While logged in as the <code class="systemitem">root</code> user install the <span class="package">rsyslog</span> package. Using the <code class="command">yum</code> command.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">yum install rsyslog</code></code></strong></pre></li></ul></div><div class="para">
    The <span class="package">rsyslog</span> package is installed and ready to be configured.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15839-541150+%5BLatest%5D&amp;cf_build_id=15839-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Installing+rsyslog+Server%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_the_rsyslog_Server"></a>19.3.&nbsp;Configuring rsyslog on the Centralized Logging Server</h2></div></div></div><div class="para">
    The steps in this procedure must be followed on the system that you intend to use as your centralized logging sever. All steps in this procedure must be run while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Configure SELinux to allow <span class="application"><strong>rsyslog</strong></span> traffic.
      </div><pre class="screen"># semanage -a -t syslogd_port_t -p udp 514</pre></li><li class="step"><div class="para">
        Configure the <code class="systemitem">iptables</code> firewall to allow <span class="application"><strong>rsyslog</strong></span> traffic.
      </div><ol class="a"><li class="step"><div class="para">
            Open the <code class="filename">/etc/sysconfig/iptables</code> file in a text editor.
          </div></li><li class="step"><div class="para">
            Add an <code class="literal">INPUT</code> rule allowing UDP traffic on port <code class="literal">514</code> to the file. The new rule must appear before any <code class="literal">INPUT</code> rules that <code class="literal">REJECT</code> traffic.
          </div><pre class="screen">-A INPUT -m state --state NEW -m udp -p udp --dport 514 -j ACCEPT</pre></li><li class="step"><div class="para">
            Save the changes to the <code class="filename">/etc/sysconfig/iptables</code> file.
          </div></li><li class="step"><div class="para">
            Restart the <code class="systemitem">iptables</code> service for the firewall changes to take effect.
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></li></ol></li><li class="step"><div class="para">
        Open the <code class="filename">/etc/rsyslog.conf</code> file in a text editor.
      </div><ol class="a"><li class="step"><div class="para">
            Add this line to the file, defining the location logs will be saved to:
          </div><pre class="screen">$template TmplAuth, &quot;/var/log/%HOSTNAME%/%PROGRAMNAME%.log&quot;

authpriv.*   ?TmplAuth
*.info,mail.none,authpriv.none,cron.none   ?TmplMsg</pre></li><li class="step"><div class="para">
            Remove the comment character (<span class="keycap"><strong>#</strong></span>) from the beginning of these lines in the file:
          </div><pre class="screen">#$ModLoad imudp
#$UDPServerRun 514</pre></li></ol><div class="para">
        Save the changes to the <code class="filename">/etc/rsyslog.conf</code> file.
      </div></li></ol></div><div class="para">
    Your centralized log server is now configured to receive and store log files from the other systems in your environment.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15932-541150+%5BLatest%5D&amp;cf_build_id=15932-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+rsyslog+on+the+Centralized+Logging+Server%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Configuring_rsyslog_on_the_Individual_Nodes"></a>19.4.&nbsp;Configuring rsyslog on the Individual Nodes</h2></div></div></div><div class="para">
    Apply the steps listed in this procedure to each of your systems to configure them to send logs to a centralized log server. All steps listed in this procedure must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ul><li class="step"><div class="para">
        Edit the <code class="filename">/etc/rsyslog.conf</code>, and specify the address of your centralized log server by adding the following:
      </div><pre class="screen">*.*   @<em class="replaceable"><code>YOURSERVERADDRESS</code></em>:<em class="replaceable"><code>YOURSERVERPORT</code></em></pre><div class="para">
        Replace <em class="replaceable"><code>YOURSERVERADDRESS</code></em> with the address of the centralized logging server. Replace <em class="replaceable"><code>YOURSERVERPORT</code></em> with the port on which the <code class="systemitem">rsyslog</code> service is listening. For example:
      </div><pre class="screen">*.*   @<em class="replaceable"><code>192.168.20.254</code></em>:<em class="replaceable"><code>514</code></em></pre><div class="para">
        Or:
      </div><pre class="screen">*.*   @<em class="replaceable"><code>log-server.company.com</code></em>:<em class="replaceable"><code>514</code></em></pre><div class="para">
        The single <code class="literal">@</code> specifies the UDP protocol for transmission. Use a double <code class="literal">@@</code> to specify the TCP protocol for transmission.
      </div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
          The use of the wildcard <span class="keycap"><strong>*</strong></span> character in these example configurations indicates to <code class="systemitem">rsyslog</code> that log entries from all log facilities and of all log priorities must be sent to the remote <code class="systemitem">rsyslog</code> server.
        </div><div class="para">
          For information on applying more precise filtering of log files refer to the manual page for the <code class="systemitem">rsyslog</code> configuration file, <code class="filename">rsyslog.conf</code>. Access the manual page by running the command <code class="command">man rsyslog.conf</code>.
        </div></div></div></li></ul></div><div class="para">
    Once the <code class="systemitem">rsyslog</code> service is started or restarted the system will send all log messages to the centralized logging server.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15981-541150+%5BLatest%5D&amp;cf_build_id=15981-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Configuring+rsyslog+on+the+Individual+Nodes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Starting_rsyslog_Server"></a>19.5.&nbsp;Starting rsyslog Server</h2></div></div></div><div class="para">
    The <code class="systemitem">rsyslog</code> service must be running on both the centralized logging server and the systems attempting to log to it.
  </div><div class="para">
    The steps in this procedure must be performed while logged in as the <code class="systemitem">root</code> user.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">service</code> command to start the <code class="systemitem">rsyslog</code> service.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service rsyslog start</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">chkconfig</code> command to ensure the <code class="systemitem">rsyslog</code> service starts automatically in future.
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">chkconfig rsyslog on</code></code></strong></pre></li></ol></div><div class="para">
    The <code class="systemitem">rsyslog</code> service has been started. The service will start sending or receiving log messages based on its local configuration.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15980-541150+%5BLatest%5D&amp;cf_build_id=15980-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Starting+rsyslog+Server%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="part"><div class="titlepage"><div><div><h1 class="title"><a id="part-Managing_OpenStack_Environment_Expansion"></a>Part&nbsp;VI.&nbsp;Managing OpenStack Environment Expansion</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#chap-Managing_Compute_Expansion">20. Managing Compute Expansion</a></span></dt><dd><dl><dt><span class="section"><a href="#Defining_Regions">20.1. Defining Regions</a></span></dt><dt><span class="section"><a href="#Adding_Compute_Resources">20.2. Adding Compute Resources</a></span></dt><dt><span class="section"><a href="#Safely_Removing_Compute_Resources">20.3. Safely Removing Compute Resources</a></span></dt><dt><span class="section"><a href="#sect-Using_Config_Drive">20.4. Using Config Drive</a></span></dt><dd><dl><dt><span class="section"><a href="#Config_Drive_Overview">20.4.1. Config Drive Overview</a></span></dt><dt><span class="section"><a href="#sect-Setting_Up_Config_Drive">20.4.2. Setting Up Config Drive</a></span></dt><dt><span class="section"><a href="#Accessing_Config_Drive">20.4.3. Accessing Config Drive</a></span></dt><dt><span class="section"><a href="#sect-Data_Formats">20.4.4. Data Formats</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap-Managing_Quotas">21. Managing Quotas</a></span></dt><dd><dl><dt><span class="section"><a href="#Viewing_Quotas">21.1. Viewing and Updating Quotas in the Dashboard</a></span></dt><dt><span class="section"><a href="#Updating_Quotas">21.2. Updating Compute Service Quotas on the Command Line</a></span></dt><dt><span class="section"><a href="#Updating_Block_Storage_Service_Quotes">21.3. Updating Block Storage Service Quotas on the Command Line</a></span></dt></dl></dd></dl></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Managing_Compute_Expansion"></a>Chapter&nbsp;20.&nbsp;Managing Compute Expansion</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Defining_Regions">20.1. Defining Regions</a></span></dt><dt><span class="section"><a href="#Adding_Compute_Resources">20.2. Adding Compute Resources</a></span></dt><dt><span class="section"><a href="#Safely_Removing_Compute_Resources">20.3. Safely Removing Compute Resources</a></span></dt><dt><span class="section"><a href="#sect-Using_Config_Drive">20.4. Using Config Drive</a></span></dt><dd><dl><dt><span class="section"><a href="#Config_Drive_Overview">20.4.1. Config Drive Overview</a></span></dt><dt><span class="section"><a href="#sect-Setting_Up_Config_Drive">20.4.2. Setting Up Config Drive</a></span></dt><dt><span class="section"><a href="#Accessing_Config_Drive">20.4.3. Accessing Config Drive</a></span></dt><dt><span class="section"><a href="#sect-Data_Formats">20.4.4. Data Formats</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Defining_Regions"></a>20.1.&nbsp;Defining Regions</h2></div></div></div><div class="para">
    Each service cataloged in the Identity service is identified by its region, which typically represents a geographical location, and its endpoint. In a cloud with multiple Compute deployments, regions allow for the discrete separation of services, and are a robust way to share some infrastructure between Compute installations, while allowing for a high degree of failure tolerance.
  </div><div class="para">
    Administrators determine which services are shared between regions and which services are used only with a specific region. By default when an endpoint is defined and no region is specified it is created in the region named <code class="literal">regionOne</code>.
  </div><div class="para">
    To begin using separate regions specify the <em class="parameter"><code>--region</code></em> argument when adding service endpoints.
  </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">keystone endpoint-create --region <em class="replaceable"><code>REGION</code></em> \</code></code></strong>
   <strong class="userinput"><code><code class="command">--service-id <em class="replaceable"><code>SERVICEID</code></em>\</code></code></strong>
   <strong class="userinput"><code><code class="command">--publicurl <em class="replaceable"><code>PUBLICURL</code></em></code></code></strong>
   <strong class="userinput"><code><code class="command">--adminurl <em class="replaceable"><code>ADMINURL</code></em></code></code></strong>
   <strong class="userinput"><code><code class="command">--internalurl <em class="replaceable"><code>INTERNALURL</code></em></code></code></strong></pre><div class="para">
    Replace <em class="replaceable"><code>REGION</code></em> with the name of the region that the endpoint belongs to. When sharing an endpoint between regions create an endpoint entry containing the same URLs for each applicable region. For information on setting the URLs for each service refer to the identity service configuration information of the service in question.
  </div><div class="example"><a id="idp10078192"></a><p class="title"><strong>Example&nbsp;20.1.&nbsp;Endpoints within Discrete Regions</strong></p><div class="example-contents"><div class="para">
      In this example the <code class="literal">APAC</code> and <code class="literal">EMEA</code> regions share an identity server (<code class="literal">identity.example.com</code>) endpoint while providing region specific compute API endpoints.
    </div><pre class="screen"><code class="prompt">$</code> keystone endpoint-list
+---------+--------+------------------------------------------------------+
|   id    | region |                      publicurl                       |
+---------+--------+------------------------------------------------------+
| 0d8b... |  APAC  |         http://identity.example.com:5000/v3          |
| 769f... |  EMEA  |         http://identity.example.com:5000/v3          |
| 516c... |  APAC  |  http://nova-apac.example.com:8774/v2/$(tenant_id)s  |
| cf7e... |  EMEA  |  http://nova-emea.example.com:8774/v2/$(tenant_id)s  |
+---------+--------+------------------------------------------------------+</pre></div></div><br class="example-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15915-541150+%5BLatest%5D&amp;cf_build_id=15915-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Defining+Regions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Adding_Compute_Resources"></a>20.2.&nbsp;Adding Compute Resources</h2></div></div></div><div class="para">
    Adding Compute resources is the most common way to expand the OpenStack environment. This is done by adding additional nodes that host, at a minimum, an instance of the Compute (<code class="literal">openstack-nova-compute</code>) service. Once the Compute service is configured and running it communicates with other nodes in the environment, including Compute API endpoints and Compute conductors, via the message broker.
  </div><div class="para">
    To add additional compute nodes repeat the steps performed when installing the original compute node:
  </div><div class="para">
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          <a class="xref" href="#Installing_the_Compute_Service_Packages">Section&nbsp;14.3.3, “Installing the Compute Service”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Configuring_Compute_Block_Storage">Section&nbsp;14.3.4.3, “Setting the Message Broker”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Configuring_Resource_Overcommitment">Section&nbsp;14.3.4.4, “Configuring Resource Overcommitment”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Reserving_Host_Resources">Section&nbsp;14.3.4.5, “Reserving Host Resources”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Updating_the_Compute_Configuration">Section&nbsp;14.3.4.6.2, “Updating the Compute Configuration”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Installing_the_L2_Agent">Section&nbsp;14.3.4.6.3, “Configuring the L2 Agent”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Configuring_Virtual_Interface_Plugging">Section&nbsp;14.3.4.6.4, “Configuring Virtual Interface Plugging”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Configuring_the_Firewall1">Section&nbsp;14.3.4.7, “Configuring the Firewall”</a>
        </div></li><li class="listitem"><div class="para">
          <a class="xref" href="#Starting_the_Compute_Services">Section&nbsp;14.3.6, “Starting the Compute Services”</a>
        </div></li></ul></div>

  </div><div class="para">
    If you wish to run an instance of the Compute conductor service (<code class="systemitem">openstack-nova-conductor</code>) then you must also ensure that the service is configured to access the compute database, refer to <a class="xref" href="#Setting_the_Database_Connection_String1">Section&nbsp;14.3.4.2, “Setting the Database Connection String”</a> for more information.
  </div><div class="para">
    Once the additional instance of the Compute service has been started the node will begin accepting requests to launch virtual machine instances. Use the <code class="command">nova service-list</code> while authenticated as the OpenStack administrator (using a <code class="filename">keystonerc</code> file) to confirm the status of the new node.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15927-541150+%5BLatest%5D&amp;cf_build_id=15927-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Adding+Compute+Resources%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Safely_Removing_Compute_Resources"></a>20.3.&nbsp;Safely Removing Compute Resources</h2></div></div></div><div class="para">
    Removal of a compute node must be done carefully to prevent negative consequences for virtual machine instances running on that node. There must be capacity available on other compute nodes within the environment to run these virtual machine instances while the node being removed is out of service.
  </div><div class="para">
    The steps listed in this procedure must be executed by a user who has access to the credentials of an OpenStack administrative user and a system with the Nova command line client (<span class="package">python-novaclient</span>) installed.
  </div><div class="procedure"><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">source</code> command to load the administrative credentials from the <code class="filename">keystonerc_admin</code> file.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">source ~/keystonerc_admin</code></code></strong></pre></li><li class="step"><div class="para">
        Use the <code class="command">nova service-list</code> command to identify the compute node to be removed.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">nova service-list</code></code></strong>
+------------------+----------+----------+---------+-------+
| Binary           | Host     | Zone     | Status  | State |
+------------------+----------+----------+---------+-------+
| nova-cert        | node0001 | internal | enabled | up    |
| nova-compute     | node0001 | nova     | enabled | up    |
| nova-conductor   | node0001 | internal | enabled | up    |
| nova-consoleauth | node0001 | internal | enabled | up    |
| nova-network     | node0001 | internal | enabled | up    |
| nova-scheduler   | node0001 | internal | enabled | up    |
| ...              | ...      | ...      | ...     | ...   |
+------------------+----------+----------+---------+-------+</pre></li><li class="step"><div class="para">
        Use the <code class="command">nova service-disable</code> command to disable the <code class="systemitem">nova-compute</code> service on the node. This prevents new instances from being scheduled to run on the host.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">nova service-disable <em class="replaceable"><code>HOST</code></em> nova-compute</code></code></strong>
+----------+--------------+----------+
| Host     | Binary       | Status   |
+----------+--------------+----------+
| node0001 | nova-compute | disabled |
+----------+--------------+----------+</pre><div class="para">
        Replace <em class="replaceable"><code>HOST</code></em> with the name of the node to disable as indicated in the output of the <code class="command">nova service-list</code> command in the previous step.
      </div></li><li class="step"><div class="para">
        Use the <code class="command">nova service-list</code> command to verify that the relevant instance of the <code class="systemitem">nova-compute</code> service is now disabled.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">nova service-list</code></code></strong>
+------------------+----------+----------+----------+-------+
| Binary           | Host     | Zone     | Status   | State |
+------------------+----------+----------+----------+-------+
| nova-cert        | node0001 | internal | enabled  | up    |
| nova-compute     | node0001 | nova     | <span class="bold bold"><strong>disabled</strong></span> | up    |
| nova-conductor   | node0001 | internal | enabled  | up    |
| nova-consoleauth | node0001 | internal | enabled  | up    |
| nova-network     | node0001 | internal | enabled  | up    |
| nova-scheduler   | node0001 | internal | enabled  | up    |
| ...              | ...      | ...      | ...      | ...   |
+------------------+----------+----------+----------+-------+</pre></li><li class="step"><div class="para">
        Use the <code class="command">nova migrate</code> command to migrate running instances to other compute nodes.
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">nova migrate <em class="replaceable"><code>HOST</code></em></code></code></strong></pre><div class="para">
        Replace <em class="replaceable"><code>HOST</code></em> with the name of the host being removed as indicated by the <code class="command">nova service-list</code> command in the previous steps.
      </div></li></ol></div><div class="para">
    Once the migration of virtual machine instances has been completed the node can safely be shutdown or otherwise operated on without negatively impacting running virtual machine instances.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15931-541150+%5BLatest%5D&amp;cf_build_id=15931-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Safely+Removing+Compute+Resources%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Using_Config_Drive"></a>20.4.&nbsp;Using Config Drive</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Config_Drive_Overview"></a>20.4.1.&nbsp;Config Drive Overview</h3></div></div></div><div class="para">
    OpenStack Compute can be configured to write metadata to a special configuration drive, config drive, that is attached to the instance when it boots. The instance can retrieve information from the config drive that would normally be available through the metadata service (for example instance ID, host name, or user data).
  </div><div class="para">
    Config drive is typically used to pass networking configuration (for example, IP address, netmask, or gateway) when DHCP is not being used to assign IP addresses to instances. The instance's IP configuration can be transmitted using the config drive, which is mounted and accessed before the instance's network settings have been configured.
  </div><div class="para">
    The config drive can be used by any guest operating system that is capable of mounting an ISO 9660 or VFAT file system (that is, all modern operating systems).
  </div><div class="para">
    In addition, if an image:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Has been built with the <span class="package">cloud-init</span> package, it can automatically access metadata passed via config drive.
        </div></li><li class="listitem"><div class="para">
          Does not have the <span class="package">cloud-init</span> package installed, it must be customized to run a script that mounts the config drive on boot, reads the data from the drive, and takes appropriate action such as adding the public key to an account.
        </div></li></ul></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+22479-541150+%5BLatest%5D&amp;cf_build_id=22479-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Config+Drive+Overview%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Setting_Up_Config_Drive"></a>20.4.2.&nbsp;Setting Up Config Drive</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Enabling_Config_Drive"></a>20.4.2.1.&nbsp;Enabling Config Drive</h4></div></div></div><div class="para">
    To enable the config drive, use one of the following:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          Use the <code class="literal">--config-drive=true</code> parameter when calling <code class="command">nova boot</code>.
        </div><div class="para">
          The following complex example enables the config drive as well as passing user data, two files, and two key/value metadata pairs, all of which are accessible from the config drive.
        </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>nova boot --config-drive=true --image my-image-name \</code></strong>
<strong class="userinput"><code>--key-name mykey --flavor 1 --user-data ./my-user-data.txt myinstance \</code></strong>
<strong class="userinput"><code>--file /etc/network/interfaces=/home/myuser/instance-interfaces \</code></strong>
<strong class="userinput"><code>--file known_hosts=/home/myuser/.ssh/known_hosts --meta role=webservers \</code></strong>
<strong class="userinput"><code>--meta essential=false</code></strong></pre></li><li class="listitem"><div class="para">
          Configure the Compute service to automatically create a config drive when booting by setting the following option in <code class="filename">/etc/nova/nova.conf</code>:
        </div><pre class="programlisting"><span class="perl_Others">force_config_drive=</span>true</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
            If a user uses the <code class="literal">--config-drive=true</code> flag with the <code class="command">nova boot</code> command, an administrator cannot disable the config drive.
          </div></div></div></li></ul></div>

  </div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
      If using the default settings for config drive, the <code class="systemitem">genisoimage</code> program must be installed on each Compute host before attempting to use config drive (or the instance will not boot properly).
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+22478-541150+%5BLatest%5D&amp;cf_build_id=22478-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Enabling+Config+Drive%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Config_Drive_Options"></a>20.4.2.2.&nbsp;Config Drive Options</h4></div></div></div><div class="para">
    By default, the config drive is configured as an ISO 9660 filesystem. To explicitly specify the:
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          ISO 9660 format, add the following line to <code class="filename">/etc/nova/nova.conf</code>:
        </div><pre class="programlisting"><span class="perl_Others">config_drive_format=</span>iso9660</pre></li><li class="listitem"><div class="para">
          VFAT format, add the following line to <code class="filename">/etc/nova/nova.conf</code>:
        </div><pre class="programlisting"><span class="perl_Others">config_drive_format=</span>vfat</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
            For legacy reasons, the config drive can be configured to use VFAT format instead of ISO 9660. However, it is unlikely that you would require VFAT format, since ISO 9660 is widely supported across operating systems. If you use the VFAT format, the config drive will be 64 MBs.
          </div></div></div></li></ul></div>

  </div><div class="para">
    The following table includes all <code class="command">nova boot</code> options for config drive:
  </div><div class="table"><a id="idp9105912"></a><p class="title"><strong>Table&nbsp;20.1.&nbsp;Description of configuration options for config drive</strong></p><div class="table-contents"><table summary="Description of configuration options for config drive"><colgroup><col width="50%" align="left" class="c1" /><col width="50%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
            Configuration option=Default value
          </th><th class="" align="left">
            (Type) Description
          </th></tr></thead><tbody><tr><td class="" align="left">
            <div class="para">
              config_drive_cdrom=False
            </div>

          </td><td class="" align="left">
            <div class="para">
              (BoolOpt) Whether Compute attaches the Config Drive image as a cdrom drive instead of a disk drive.
            </div>

          </td></tr><tr><td class="" align="left">
            <div class="para">
              config_drive_format=iso9660
            </div>

          </td><td class="" align="left">
            <div class="para">
              (StrOpt) Config drive format (valid options: iso9660 or vfat).
            </div>

          </td></tr><tr><td class="" align="left">
            <div class="para">
              config_drive_inject_password=False
            </div>

          </td><td class="" align="left">
            <div class="para">
              (BoolOpt) Sets the administrative password in the config drive image.
            </div>

          </td></tr><tr><td class="" align="left">
            <div class="para">
              config_drive_skip_versions=1.0 2007-01-19 2007-03-01 2007-08-29 2007-10-10 2007-12-15 2008-02-01 2008-09-01
            </div>

          </td><td class="" align="left">
            <div class="para">
              (StrOpt) List of metadata versions to skip placing into the config drive.
            </div>

          </td></tr><tr><td class="" align="left">
            <div class="para">
              config_drive_tempdir=None
            </div>

          </td><td class="" align="left">
            <div class="para">
              (StrOpt) Where to put temporary files associated with config drive creation.
            </div>

          </td></tr><tr><td class="" align="left">
            <div class="para">
              force_config_drive=False
            </div>

          </td><td class="" align="left">
            <div class="para">
              (StrOpt) Whether Compute automatically creates config drive on startup.
            </div>

          </td></tr><tr><td class="" align="left">
            <div class="para">
              mkisofs_cmd=genisoimage
            </div>

          </td><td class="" align="left">
            <div class="para">
              (StrOpt) Name and optional path of the tool used for ISO image creation. Ensure that the specified tool is installed on each Compute host before attempting to use config drive (or the instance will not boot properly).
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+22490-541150+%5BLatest%5D&amp;cf_build_id=22490-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Config+Drive+Options%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Accessing_Config_Drive"></a>20.4.3.&nbsp;Accessing Config Drive</h3></div></div></div><div class="para">
    You must mount the drive depending on the guest operating system type. By default, the config drive has the <code class="literal">config-2</code> volume label.
  </div><div class="procedure"><a id="idm805920"></a><p class="title"><strong>Procedure&nbsp;20.1.&nbsp;Mount the Drive by Label</strong></p><div class="para">
      If the guest OS supports accessing disk by label, you should be able to mount the config drive as the <code class="filename">/dev/disk/by-label/config-2</code> device. For example:
    </div><ol class="1"><li class="step"><div class="para">
        Create the directory to use for access:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir -p /mnt/config</code></strong></pre></li><li class="step"><div class="para">
        Mount the device:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /dev/disk/by-label/config-2 /mnt/config</code></strong></pre></li></ol></div><div class="procedure"><a id="idm2961176"></a><p class="title"><strong>Procedure&nbsp;20.2.&nbsp;Mount the Drive using Disk Identification</strong></p><div class="para">
      If the guest OS does not use <code class="literal">udev</code>, then the <code class="filename">/dev/disk/by-label</code> directory will not be present.
    </div><ol class="1"><li class="step"><div class="para">
        Use the <code class="command">blkid</code> command to identify the block device that corresponds to the config drive. For example, when booting the cirros image with the m1.tiny flavor, the device will be <code class="filename">/dev/vdb</code>:
      </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>blkid -t LABEL=&quot;config-2&quot; -odevice</code></strong>
<code class="computeroutput">/dev/vdb</code></pre></li><li class="step"><div class="para">
        After you have identified the disk, the device can then be mounted:
      </div><ol class="a"><li class="step"><div class="para">
            Create the directory to use for access:
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mkdir -p /mnt/config</code></strong></pre></li><li class="step"><div class="para">
            Mount the device:
          </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>mount /dev/vdb /mnt/config</code></strong></pre></li></ol></li></ol></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="itemizedlist"><ul><li class="listitem"><div class="para">
          If using a Windows guest, the config drive is automatically displayed as the next available drive letter (for example, 'D:/').
        </div></li><li class="listitem"><div class="para">
          When accessing the config drive, do not rely on the presence of the EC2 metadata (files under the <code class="filename">ec2</code> directory) to be present in the config drive (this content may be removed in a future release).
        </div></li><li class="listitem"><div class="para">
          When creating images that access config drive data, if there are multiple directories under the <code class="filename">openstack</code> directory, always select the highest API version by date that your consumer supports. For example, if your guest image can support versions 2012-03-05, 2012-08-05, 2013-04-13, it is best to try 2013-04-13 first and only revert to an earlier version if 2013-04-13 is absent.
        </div></li></ul></div></div></div><div class="procedure"><a id="idp9870744"></a><p class="title"><strong>Procedure&nbsp;20.3.&nbsp;View the Mounted Config Drive</strong></p><ol class="1"><li class="step"><div class="para">
        Move to the newly mounted drive's files. For example:
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>cd /mnt/config</code></strong></pre></li><li class="step"><div class="para">
        The files in the resulting config drive vary depending on the arguments that were passed to <code class="command">nova boot</code>. Based on the example in <em class="citetitle">Enabling Config Drive</em>, the contents of the config drive would be:
      </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>ls</code></strong>
<code class="computeroutput">ec2/2013-04-13/meta-data.json ec2/2013-04-13/user-data ec2/latest/meta-data.json ec2/latest/user-data openstack/2013-08-10/meta_data.json openstack/2013-08-10/user_data openstack/content openstack/content/0000 openstack/content/0001 openstack/latest/meta_data.json openstack/latest/user_data</code></pre></li></ol></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+22480-541150+%5BLatest%5D&amp;cf_build_id=22480-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Accessing+Config+Drive%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Data_Formats"></a>20.4.4.&nbsp;Data Formats</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Metadata_Formats"></a>20.4.4.1.&nbsp;OpenStack Metadata Format</h4></div></div></div><div class="para">
    The following listing provides an example of the meta_data.json file (<code class="filename">openstack/2012-08-10/meta_data.json</code>, <code class="filename">openstack/latest/meta_data.json</code>, these two files are identical), formatted to improve readability:
  </div><div class="para">

<pre class="programlisting">{
    &quot;availability_zone&quot;: &quot;nova&quot;,
    &quot;files&quot;: [
        {
            &quot;content_path&quot;: &quot;/content/0000&quot;,
            &quot;path&quot;: &quot;/etc/network/interfaces&quot;
        },
        {
            &quot;content_path&quot;: &quot;/content/0001&quot;,
            &quot;path&quot;: &quot;known_hosts&quot;
        }
    ],
    &quot;hostname&quot;: &quot;test.novalocal&quot;,
    &quot;launch_index&quot;: 0,
    &quot;name&quot;: &quot;test&quot;,
    &quot;meta&quot;: {
            &quot;role&quot;: &quot;webservers&quot;
            &quot;essential&quot;: &quot;false&quot;
    },
    &quot;public_keys&quot;: {
        &quot;mykey&quot;: &quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDBqUfVvCSez0/Wfpd8dLLgZXV9GtXQ7hnMN+Z0OWQUyebVEHey1CXuin0uY1cAJMhUq8j98SiW+cU0sU4J3x5l2+xi1bodDm1BtFWVeLIOQINpfV1n8fKjHB+ynPpe1F6tMDvrFGUlJs44t30BrujMXBe8Rq44cCk6wqyjATA3rQ== Generated by Nova\n&quot;
    },
    &quot;uuid&quot;: &quot;83679162-1378-4288-a2d4-70e13ec132aa&quot;
}</pre>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      If the option <code class="literal">--file /etc/network/interfaces=/home/myuser/instance-interfaces</code> is used with the <code class="command">nova boot</code> command, the contents of this file are contained in the file <code class="filename">openstack/content/0000</code> file on the config drive, and the path is specified as <code class="filename">/etc/network/interfaces</code> in the <code class="filename">meta_data.json</code> file.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+22477-541150+%5BLatest%5D&amp;cf_build_id=22477-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+OpenStack+Metadata+Format%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="EC2_Metadata_Format"></a>20.4.4.2.&nbsp;EC2 Metadata Format</h4></div></div></div><div class="para">
    Here is an example of the contents of <code class="filename">ec2/2009-04-04/meta-data.json</code>, <code class="filename">latest/meta-data.json</code>, formatted to improve readability (the two files are identical) :
  </div><div class="para">

<pre class="programlisting">{
    &quot;ami-id&quot;: &quot;ami-00000001&quot;,
    &quot;ami-launch-index&quot;: 0,
    &quot;ami-manifest-path&quot;: &quot;FIXME&quot;,
    &quot;block-device-mapping&quot;: {
        &quot;ami&quot;: &quot;sda1&quot;,
        &quot;ephemeral0&quot;: &quot;sda2&quot;,
        &quot;root&quot;: &quot;/dev/sda1&quot;,
        &quot;swap&quot;: &quot;sda3&quot;
    },
    &quot;hostname&quot;: &quot;test.novalocal&quot;,
    &quot;instance-action&quot;: &quot;none&quot;,
    &quot;instance-id&quot;: &quot;i-00000001&quot;,
    &quot;instance-type&quot;: &quot;m1.tiny&quot;,
    &quot;kernel-id&quot;: &quot;aki-00000002&quot;,
    &quot;local-hostname&quot;: &quot;test.novalocal&quot;,
    &quot;local-ipv4&quot;: null,
    &quot;placement&quot;: {
        &quot;availability-zone&quot;: &quot;nova&quot;
    },
    &quot;public-hostname&quot;: &quot;test.novalocal&quot;,
    &quot;public-ipv4&quot;: &quot;&quot;,
    &quot;public-keys&quot;: {
        &quot;0&quot;: {
            &quot;openssh-key&quot;: &quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDBqUfVvCSez0/Wfpd8dLLgZXV9GtXQ7hnMN+Z0OWQUyebVEHey1CXuin0uY1cAJMhUq8j98SiW+cU0sU4J3x5l2+xi1bodDm1BtFWVeLIOQINpfV1n8fKjHB+ynPpe1F6tMDvrFGUlJs44t30BrujMXBe8Rq44cCk6wqyjATA3rQ== Generated by Nova\n&quot;
        }
    },
    &quot;ramdisk-id&quot;: &quot;ari-00000003&quot;,
    &quot;reservation-id&quot;: &quot;r-7lfps8wj&quot;,
    &quot;security-groups&quot;: [
        &quot;default&quot;
    ]
}</pre>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+22492-541150+%5BLatest%5D&amp;cf_build_id=22492-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+EC2+Metadata+Format%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="User_Data_Format"></a>20.4.4.3.&nbsp;User Data Format</h4></div></div></div><div class="para">
    The following files will only be present if the <code class="literal">--user-data</code> flag was passed to <code class="command">nova boot</code>, and will contain the contents of the user data file passed as the argument.
    <div class="itemizedlist"><ul><li class="listitem"><div class="para">
          <code class="filename">openstack/2013-08-10/user_data</code>
        </div></li><li class="listitem"><div class="para">
          <code class="filename">openstack/latest/user_data</code>
        </div></li><li class="listitem"><div class="para">
          <code class="filename">ec2/2013-04-13/user-data</code>
        </div></li><li class="listitem"><div class="para">
          <code class="filename">ec2/latest/user-data</code>
        </div></li></ul></div>

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+22491-541150+%5BLatest%5D&amp;cf_build_id=22491-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+User+Data+Format%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="chap-Managing_Quotas"></a>Chapter&nbsp;21.&nbsp;Managing Quotas</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#Viewing_Quotas">21.1. Viewing and Updating Quotas in the Dashboard</a></span></dt><dt><span class="section"><a href="#Updating_Quotas">21.2. Updating Compute Service Quotas on the Command Line</a></span></dt><dt><span class="section"><a href="#Updating_Block_Storage_Service_Quotes">21.3. Updating Block Storage Service Quotas on the Command Line</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Viewing_Quotas"></a>21.1.&nbsp;Viewing and Updating Quotas in the Dashboard</h2></div></div></div><div class="para">
    OpenStack provides a number of quotas (or operational limits), which are all enforced at the tenant level (rather than by user). For example, the number of gigabytes allowed per tenant can be controlled so that cloud resources are optimized. Typically, the default values are changed because a tenant requires more than 10 volumes, or more than 1TB on a node.
  </div><div class="para">
    As an administrative user in the Dashboard, you can view (but not edit) the default quotas for a new project using the <span class="guilabel"><strong>Admin &gt; System Info</strong></span> option in the navigation sidebar, and clicking on the <span class="guilabel"><strong>Default Quotas</strong></span> tab.
  </div><div class="para">
    <div class="figure"><a id="idp8352272"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="https://access.redhat.com/site/documentation/resources/docs/en-US/Red_Hat_Enterprise_Linux_OpenStack_Platform/4-Beta/html-single/Installation_and_Configuration_Guide/images/2648.png" align="middle" width="70%" alt="Description" /></div></div><p class="title"><strong>Figure&nbsp;21.1.&nbsp;Quota Defaults</strong></p></div><br class="figure-break" />

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      Not all possible project quotas are displayed in the dashboard. To obtain and update the complete list for a service, use its command-line tools. Refer to:
      <div class="itemizedlist"><ul><li class="listitem"><div class="para">
            <em class="citetitle">Updating Compute Quotas using the Command Line</em>
          </div></li><li class="listitem"><div class="para">
            <em class="citetitle">Updating Block Storage Quotas using the Command Line</em>
          </div></li></ul></div>

    </div></div></div><div class="para">
    To update quotas for an individual tenant (project) in the dashboard:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Select the <span class="guilabel"><strong>Admin &gt; Projects</strong></span> option in the navigation sidebar.
        </div></li><li class="listitem"><div class="para">
          Click the project's <span class="guibutton"><strong>More</strong></span> button, and then select <span class="guilabel"><strong>Modify Quotas</strong></span>. The <span class="guilabel"><strong>Edit Project</strong></span> window is displayed.
        </div></li><li class="listitem"><div class="para">
          Edit quota values on the <span class="guilabel"><strong>Quota</strong></span> tab, and click the <span class="guibutton"><strong>Save</strong></span> button. The table below provides parameter descriptions (listed in order of appearance).
        </div></li></ol></div>

  </div><div class="para">
    <div class="table"><a id="idp44370720"></a><p class="title"><strong>Table&nbsp;21.1.&nbsp;Compute Quota Descriptions</strong></p><div class="table-contents"><table summary="Compute Quota Descriptions"><colgroup><col width="20%" align="left" class="c1" /><col width="60%" align="left" class="c2" /><col width="20%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Quota
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Service
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Metadata Items
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of metadata items allowed per instance.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                VCPUs
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of instance cores allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Instances
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of instances allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Injected Files
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of injected files allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Injected File Content Bytes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of content bytes allowed per injected file.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Volumes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of volumes allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Block Storage</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Gigabytes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of volume gigabtyes allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Block Storage</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                RAM (MB)
              </div>

            </td><td class="" align="left">
              <div class="para">
                Megabytes of ram allowed per instance.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Floating IPs
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of floating IP addresses allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Fixed IPs
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of fixed IP addresses allowed per tenant. This number should equal at least the number of allowed instances.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Security Groups
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of security groups allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Security Group Rules
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of rules per security group.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">Compute</code>
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+18107-541150+%5BLatest%5D&amp;cf_build_id=18107-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Viewing+and+Updating+Quotas+in+the+Dashboard%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Updating_Quotas"></a>21.2.&nbsp;Updating Compute Service Quotas on the Command Line</h2></div></div></div><div class="para">
    To update any of the Compute service quotas on the command line:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Because Compute quotas are managed per tenant, use the following to obtain a tenant list:
<pre class="screen"><code class="prompt">#</code>  keystone tenant-list
+----------------------------------+----------+---------+
|                id                |   name   | enabled |
+----------------------------------+----------+---------+
| a981642d22c94e159a4a6540f70f9f8d |  admin   |   True  |
| 934b662357674c7b9f5e4ec6ded4d0e7 | redhat01 |   True  |
| 7bc1dbfd7d284ec4a856ea1eb82dca80 | redhat02 |   True  |
| 9c554aaef7804ba49e1b21cbd97d218a | services |   True  |
+----------------------------------+----------+---------+</pre>

        </div></li><li class="listitem"><div class="para">
          To update a particular Compute quota for the tenant, use:
<pre class="screen"><code class="prompt">#</code> nova-manage project quota <em class="replaceable"><code>tenantName</code></em> --key <em class="replaceable"><code>quotaName</code></em> --value <em class="replaceable"><code>quotaValue</code></em></pre>
           For example:
<pre class="screen"><code class="prompt">#</code> nova-manage project quota redhat01 --key floating_ips --value 20
metadata_items: 128
injected_file_content_bytes: 10240
ram: 51200
floating_ips: 20
security_group_rules: 20
instances: 10
key_pairs: 100
injected_files: 5
cores: 20
fixed_ips: unlimited
injected_file_path_bytes: 255
security_groups: 10</pre>

        </div></li><li class="listitem"><div class="para">
          Restart the Compute service:
<pre class="screen"><code class="prompt">#</code> service openstack-nova-api restart</pre>

        </div></li></ol></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To update the Compute quota defaults for a new project, update the parameters in the <code class="systemitem">/etc/nova/nova.conf</code> file.
    </div></div></div><div class="para">
    <div class="table"><a id="idp44489992"></a><p class="title"><strong>Table&nbsp;21.2.&nbsp;Compute Quota Descriptions</strong></p><div class="table-contents"><table summary="Compute Quota Descriptions"><colgroup><col width="20%" align="left" class="c1" /><col width="60%" align="left" class="c2" /><col width="20%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Quota
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Parameter
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Injected File Content Bytes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of bytes allowed per injected file.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">injected_file_content_bytes</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Metadata Items
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of metadata items allowed per instance
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">metadata_items</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Ram
              </div>

            </td><td class="" align="left">
              <div class="para">
                Megabytes of instance ram allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">ram</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Floating Ips
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of floating IP addresses allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">floating_ips</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Key Pairs
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of key pairs allowed per user.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">key_pairs</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Injected File Path Bytes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of bytes allowed per injected file path.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">injected_file_path_bytes</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Instances
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of instances allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">instances</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Security Group Rules
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of rules per security group.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">security_group_rules</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Injected Files
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of allowed injected files.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">injected_files</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Cores
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of instance cores allowed per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">cores</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Fixed Ips
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of fixed IP addresses allowed per tenant. This number should equal at least the number of allowed instances.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">fixed_ips</code>
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Security Groups
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of security groups per tenant.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <code class="systemitem">security_groups</code>
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+18108-541150+%5BLatest%5D&amp;cf_build_id=18108-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Updating+Compute+Service+Quotas+on+the+Command+Line%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Updating_Block_Storage_Service_Quotes"></a>21.3.&nbsp;Updating Block Storage Service Quotas on the Command Line</h2></div></div></div><div class="para">
    To update Block Storage service quotas:
    <div class="orderedlist"><ol><li class="listitem"><div class="para">
          Because Block Storage quotas are managed per tenant, use the following to obtain a tenant list:
<pre class="screen"><code class="prompt">#</code> keystone tenant-list
+----------------------------------+----------+---------+
|                id                |   name   | enabled |
+----------------------------------+----------+---------+
| a981642d22c94e159a4a6540f70f9f8d |  admin   |   True  |
| 934b662357674c7b9f5e4ec6ded4d0e7 | redhat01 |   True  |
| 7bc1dbfd7d284ec4a856ea1eb82dca80 | redhat02 |   True  |
| 9c554aaef7804ba49e1b21cbd97d218a | services |   True  |
+----------------------------------+----------+---------+</pre>

        </div></li><li class="listitem"><div class="para">
          To view Block Storage quotas for a tenant, use:
<pre class="screen"><code class="prompt">#</code> cinder quota-show <em class="replaceable"><code>tenantName</code></em></pre>
           For example:
<pre class="screen"><code class="prompt">#</code> cinder quota-show redhat01
+-----------+-------+
|  Property | Value |
+-----------+-------+
| gigabytes |  1000 |
| snapshots |   10  |
|  volumes  |   10  |
+-----------+-------+</pre>

        </div></li><li class="listitem"><div class="para">
          To update a particular quota value, use:
<pre class="screen"><code class="prompt">#</code>cinder quota-update <em class="replaceable"><code>tenantName</code></em> --<em class="replaceable"><code>quotaKey</code></em>=<em class="replaceable"><code>NewValue</code></em></pre>
           For example:
<pre class="screen"><code class="prompt">#</code> cinder quota-update redhat01 --volumes=15
<code class="prompt">#</code> cinder quota-show redhat01
+-----------+-------+
|  Property | Value |
+-----------+-------+
| gigabytes |  1000 |
| snapshots |   10  |
|  volumes  |   15  |
+-----------+-------+</pre>

        </div></li></ol></div>

  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To update the Block Storage quota defaults for a new project, update the parameters in the <code class="systemitem">/etc/cinder/cinder.conf</code> file.
    </div></div></div><div class="para">
    <div class="table"><a id="idp7337360"></a><p class="title"><strong>Table&nbsp;21.3.&nbsp;Block Storage Quota Descriptions</strong></p><div class="table-contents"><table summary="Block Storage Quota Descriptions"><colgroup><col width="20%" align="left" class="c1" /><col width="80%" align="left" class="c2" /></colgroup><thead><tr><th class="" align="left">
              Quota Parameter
            </th><th class="" align="left">
              Description
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                gigabytes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of volume gigabytes allowed per tenant.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                snapshots
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of Block Storage snapshots allowed per tenant.
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                volumes
              </div>

            </td><td class="" align="left">
              <div class="para">
                Number of Block Storage volumes allowed per tenant.
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+18110-541150+%5BLatest%5D&amp;cf_build_id=18110-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Updating+Block+Storage+Service+Quotas+on+the+Command+Line%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appe-Installation_Checklist"></a>Installation Checklist</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Installation_Prerequisites_Checklists"></a>A.1.&nbsp;Installation Prerequisites Checklists</h2></div></div></div><div class="para">
    The following tables describe prerequisites for successfully installing a Red Hat Enterprise Linux OpenStack Platform cloud. Checklist items are the minimum that should be known or verified before the installation is started.
  </div><div class="para">
    The <em class="citetitle">Value/Verified</em> column can be used to provide the appropriate value or a 'check' that the item has been verified.
  </div><div class="para">
    <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
        If installing single components after the initial Red Hat Enterprise Linux OpenStack Platform installation, ensure that you have:
      </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
            <code class="systemitem">root</code> access to the host machine (to install components, as well other administrative tasks such as updating the firewall).
          </div></li><li class="listitem"><div class="para">
            Administrative access to the Identity service.
          </div></li><li class="listitem"><div class="para">
            Administrative access to the database (ability to add both databases and users).
          </div></li></ul></div></div></div>

  </div><div class="para">
    <div class="table"><a id="idm3255976"></a><p class="title"><strong>Table&nbsp;A.1.&nbsp;OpenStack Installation-General</strong></p><div class="table-contents"><table summary="OpenStack Installation-General"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value/Verified
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Hardware Requirements
              </div>

            </td><td class="" align="left">
              <div class="para">
                Requirements in section <em class="citetitle">3.2 Hardware Requirements</em> must be verified.
              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Operating System
              </div>

            </td><td class="" align="left">
              <div class="para">
                Red Hat Enterprise Linux 6.5 Server
              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Red Hat Subscription
              </div>

            </td><td class="" align="left">
              <div class="para">
                You must have a subscription to:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      Receive package updates from Red Hat Network or an equivalent source such as a Red Hat Network Satellite server.
                    </div></li><li class="listitem"><div class="para">
                      Receive software updates for both Red Hat Enterprise Linux 6.5 Server and Red Hat Enterprise Linux OpenStack Platform
                    </div></li></ul></div>

              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              Administrative access on all installation machines
            </td><td class="" align="left">
              Almost all procedures in this guide must be performed as the root user, so the installer must have root access.
            </td><td class="" align="left">
              Yes | No
            </td></tr><tr><td class="" align="left">
              <div class="para">
                Red Hat Subscriber Name/Password
              </div>

            </td><td class="" align="left">
              <div class="para">
                You must know the Red Hat subscriber name and password.
              </div>

            </td><td class="" align="left">
              <div class="para">
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      Name:
                    </div></li><li class="listitem"><div class="para">
                      Password:
                    </div></li></ul></div>

              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Machine addresses
              </div>

            </td><td class="" align="left">
              <div class="para">
                You must know the host IP address of the machine or machines on which any OpenStack components and supporting software will be installed.
              </div>

            </td><td class="" align="left">
              <div class="para">
                Provide host addresses for the following:
              </div>
               <div class="para">
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      Identity service
                    </div></li><li class="listitem"><div class="para">
                      OpenStack Networking service
                    </div></li><li class="listitem"><div class="para">
                      Block Storage service
                    </div></li><li class="listitem"><div class="para">
                      Compute service
                    </div></li><li class="listitem"><div class="para">
                      Image service
                    </div></li><li class="listitem"><div class="para">
                      Object Storage service
                    </div></li><li class="listitem"><div class="para">
                      Dashboard service
                    </div></li><li class="listitem"><div class="para">
                      MySQL server (default database for this guide)
                    </div></li><li class="listitem"><div class="para">
                      Qpid message broker
                    </div></li></ul></div>

              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idp9282936"></a><p class="title"><strong>Table&nbsp;A.2.&nbsp;OpenStack Identity Service</strong></p><div class="table-contents"><table summary="OpenStack Identity Service"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Host Access
              </div>

            </td><td class="" align="left">
              <div class="para">
                The system hosting the Identity service must have:
              </div>
               <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    Access to Red Hat Network or equivalent service.
                  </div></li><li class="listitem"><div class="para">
                    Network interface addressable by all OpenStack hosts.
                  </div></li><li class="listitem"><div class="para">
                    Network access to the database server.
                  </div></li><li class="listitem"><div class="para">
                    If using LDAP, network access to the directory server .
                  </div></li></ul></div>

            </td><td class="" align="left">
              <div class="para">
                Verify whether the system has:
              </div>
               <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    Yes | No
                  </div></li><li class="listitem"><div class="para">
                    Yes | No
                  </div></li><li class="listitem"><div class="para">
                    Yes | No
                  </div></li><li class="listitem"><div class="para">
                    Yes | No
                  </div></li></ul></div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                SSL Certificates
              </div>

            </td><td class="" align="left">
              <div class="para">
                If using external SSL certificates, you must know where the database and certificates are located, and have access to them.
              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              LDAP Information
            </td><td class="" align="left">
              If using LDAP, you must have administrative access to configure a new directory server schema.
            </td><td class="" align="left">
              Yes | No
            </td></tr><tr><td class="" align="left">
              Connections
            </td><td class="" align="left">
              The system hosting the Identity service must have a connection to all other OpenStack services.
            </td><td class="" align="left">
              Yes | No
            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idm5442360"></a><p class="title"><strong>Table&nbsp;A.3.&nbsp;OpenStack Object Storage Service</strong></p><div class="table-contents"><table summary="OpenStack Object Storage Service"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                File System
              </div>

            </td><td class="" align="left">
              <div class="para">
                Red Hat currently supports the <code class="systemitem">XFS</code> and <code class="systemitem">ext4</code> file systems for object storage; one of these must be available.
              </div>

            </td><td class="" align="left">
              <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    XFS
                  </div></li><li class="listitem"><div class="para">
                    ext4
                  </div></li></ul></div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Mount Point
              </div>

            </td><td class="" align="left">
              <div class="para">
                The /srv/node mount point must be available.
              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              Connections
            </td><td class="" align="left">
              For the cloud installed in this guide, the system hosting the Object Storage service will need a connection to the Identity service.
            </td><td class="" align="left">
              Yes | No
            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idm4100256"></a><p class="title"><strong>Table&nbsp;A.4.&nbsp;OpenStack Image Service</strong></p><div class="table-contents"><table summary="OpenStack Image Service"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Backend Storage
              </div>

            </td><td class="" align="left">
              <div class="para">
                The Image service supports a number of storage backends. You must decide on one of the following:
              </div>
               <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    file (local directory)
                  </div></li><li class="listitem"><div class="para">
                    OpenStack Object Storage service
                  </div></li></ul></div>

            </td><td class="" align="left">
              <div class="para">
                Storage:
              </div>

            </td></tr><tr><td class="" align="left">
              Connections
            </td><td class="" align="left">
              The system hosting the Image service must have a connection to the Identity, Dashboard , and Compute services, as well as to the Object Storage service if using OpenStack Object Storage as its backend.
            </td><td class="" align="left">
              Yes | No
            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idp8048136"></a><p class="title"><strong>Table&nbsp;A.5.&nbsp;OpenStack Block Storage Service</strong></p><div class="table-contents"><table summary="OpenStack Block Storage Service"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Backend Storage
              </div>

            </td><td class="" align="left">
              <div class="para">
                The Block Storage service supports a number of storage backends. You must decide on one of the following:
              </div>
               <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    LVM
                  </div></li><li class="listitem"><div class="para">
                    NFS
                  </div></li><li class="listitem"><div class="para">
                    Red Hat Storage
                  </div></li></ul></div>

            </td><td class="" align="left">
              <div class="para">
                Storage:
              </div>

            </td></tr><tr><td class="" align="left">
              Connections
            </td><td class="" align="left">
              The system hosting the Block Storage service must have a connection to the Identity, Dashboard, and Compute services.
            </td><td class="" align="left">
              Yes | No
            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idp3357720"></a><p class="title"><strong>Table&nbsp;A.6.&nbsp;OpenStack Networking Service</strong></p><div class="table-contents"><table summary="OpenStack Networking Service"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Plugin agents
              </div>

            </td><td class="" align="left">
              <div class="para">
                In addition to the standard OpenStack Networking components, a wide choice of plugin agents are also available that implement various networking mechanisms.
              </div>
               <div class="para">
                You'll need to decide which of these apply to your network and install them.
              </div>

            </td><td class="" align="left">
              <div class="itemizedlist"><div class="para">
                  Circle appropriate:
                </div><ul><li class="listitem"><div class="para">
                    Open vSwitch
                  </div></li><li class="listitem"><div class="para">
                    Cisco UCS/Nexus
                  </div></li><li class="listitem"><div class="para">
                    Linux Bridge
                  </div></li><li class="listitem"><div class="para">
                    Nicira Network Virtualization Platform (NCP)
                  </div></li><li class="listitem"><div class="para">
                    Ryu OpenFlow Controller
                  </div></li><li class="listitem"><div class="para">
                    NEC OpenFlow
                  </div></li><li class="listitem"><div class="para">
                    Big Switch Controller Plugin
                  </div></li><li class="listitem"><div class="para">
                    Cloudbase Hyper-V
                  </div></li><li class="listitem"><div class="para">
                    MidoNet
                  </div></li><li class="listitem"><div class="para">
                    Brocade Neutron Plugin
                  </div></li><li class="listitem"><div class="para">
                    PLUMgrid
                  </div></li></ul></div>

            </td></tr><tr><td class="" align="left">
              Connections
            </td><td class="" align="left">
              The system hosting the OpenStack Networking service must have a connection to the Identity, Dashboard, and Compute services.
            </td><td class="" align="left">
              Yes | No
            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idp44367456"></a><p class="title"><strong>Table&nbsp;A.7.&nbsp;OpenStack Compute Service</strong></p><div class="table-contents"><table summary="OpenStack Compute Service"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Hardware virtualization support
              </div>

            </td><td class="" align="left">
              <div class="para">
                The OpenStack Compute service requires hardware virtualization support. Note: a procedure is included in this Guide to verify this (refer to <em class="citetitle">Checking for Hardware Virtualization Support</em>).
              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                VNC client
              </div>

            </td><td class="" align="left">
              <div class="para">
                The Compute service supports the Virtual Network Computing (VNC) console to instances through a web browser. You must decide whether this will be provided to your users.
              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Resources: CPU and Memory
              </div>

            </td><td class="" align="left">
              <div class="para">
                OpenStack supports overcommitting of CPU and memory resources on Compute nodes (refer to <em class="citetitle">Configuring Resource Overcommitment</em>).
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      The default CPU overcommit ratio of 16 means that up to 16 virtual cores can be assigned to a node for each physical core.
                    </div></li><li class="listitem"><div class="para">
                      The default memory overcommit ratio of 1.5 means that instances can be assigned to a physical node if the total instance memory usage is less than 1.5 times the amount of physical memory available.
                    </div></li></ul></div>

              </div>

            </td><td class="" align="left">
              <div class="para">
                Decide:
                <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                      CPU setting:
                    </div></li><li class="listitem"><div class="para">
                      Memory setting:
                    </div></li></ul></div>

              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Resources:Host
              </div>

            </td><td class="" align="left">
              <div class="para">
                You can reserve resources for the host, to prevent a given amount of memory and disk resources from being automatically assigned to other resources on the host (refer to <em class="citetitle">Reserving Host Resources</em>.
              </div>

            </td><td class="" align="left">
              <div class="para">
                Decide:
              </div>
               <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    Host Disk (default 0MB):
                  </div></li><li class="listitem"><div class="para">
                    Host Memory (default 512MB):
                  </div></li></ul></div>

            </td></tr><tr><td class="" align="left">
              libvirt Version
            </td><td class="" align="left">
              You will need to know the version of your libvirt for the configuration of Virtual Interface Plugging (refer to <em class="citetitle">Configuring Virtual Interface Plugging</em>).
            </td><td class="" align="left">
              Version:
            </td></tr><tr><td class="" align="left">
              Connections
            </td><td class="" align="left">
              The system hosting the Compute service must have a connection to all other OpenStack services.
            </td><td class="" align="left">
              Yes | No
            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="para">
    <div class="table"><a id="idp8486592"></a><p class="title"><strong>Table&nbsp;A.8.&nbsp;OpenStack Dashboard Service</strong></p><div class="table-contents"><table summary="OpenStack Dashboard Service"><colgroup><col width="20%" align="left" class="c1" /><col width="50%" align="left" class="c2" /><col width="30%" align="left" class="c3" /></colgroup><thead><tr><th class="" align="left">
              Item
            </th><th class="" align="left">
              Description
            </th><th class="" align="left">
              Value
            </th></tr></thead><tbody><tr><td class="" align="left">
              <div class="para">
                Host software
              </div>

            </td><td class="" align="left">
              <div class="para">
                The system hosting the Dashboard service must have the following already installed:
              </div>
               <div class="itemizedlist"><ul><li class="listitem"><div class="para">
                    httpd
                  </div></li><li class="listitem"><div class="para">
                    mod_wsgi
                  </div></li><li class="listitem"><div class="para">
                    mod_ssl
                  </div></li></ul></div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr><tr><td class="" align="left">
              <div class="para">
                Connections
              </div>

            </td><td class="" align="left">
              <div class="para">
                The system hosting the Dashboard service must have a connection to all other OpenStack services.
              </div>

            </td><td class="" align="left">
              <div class="para">
                Yes | No
              </div>

            </td></tr></tbody></table></div></div><br class="table-break" />

  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16962-550072+%5BLatest%5D&amp;cf_build_id=16962-550072+01+Nov+2013+10%3A19+en-US+%5BLatest%5D&amp;comment=Title%3A+Installation+Prerequisites+Checklists%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appe-Troubleshooting_the_OpenStack_Environment"></a>Troubleshooting the OpenStack Environment</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Troubleshooting_Overview"></a>B.1.&nbsp;No Networks or Routers Tab Appears in the Dashboard</h2></div></div></div><div class="para">
    The <span class="guilabel"><strong>Networks</strong></span> and <span class="guilabel"><strong>Routers</strong></span> tabs only appear in the dashboard when the environment is configured to use OpenStack Networking. In particular note that by default the PackStack utility currently deploys Nova Networking and as such in environments deployed in this manner the tab will not be visible.
  </div><div class="para">
    If OpenStack Networking is deployed in the environment but the tabs still do not appear ensure that the service endpoints are defined correctly in the identify service, that the firewall is allowing access to the endpoints, and that the services are running.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15836-541150+%5BLatest%5D&amp;cf_build_id=15836-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+No+Networks+or+Routers+Tab+Appears+in+the+Dashboard%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Dashboard_Reports_ERROR_When_Launching_Instances"></a>B.2.&nbsp;Dashboard Reports ERROR When Launching Instances</h2></div></div></div><div class="para">
    When using the dashboard to launch instances if the operation fails, a generic <code class="literal">ERROR</code> message is displayed. Determining the actual cause of the failure requires the use of the command line tools.
  </div><div class="para">
    Use the <code class="command">nova list</code> to locate the unique identifier of the instance. Then use this identifier as an argument to the <code class="command">nova show</code> command. One of the items returned will be the error condition. The most common value is <code class="literal">NoValidHost</code>.
  </div><div class="para">
    This error indicates that no valid host was found with enough available resources to host the instance. To work around this issue, consider choosing a smaller instance size or increasing the overcommitt allowances for your environment.
  </div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
      To host a given instance, the compute node must have not only available CPU and RAM resources but also enough disk space for the ephemeral storage associated with the instance.
    </div></div></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16831-541150+%5BLatest%5D&amp;cf_build_id=16831-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Dashboard+Reports+ERROR+When+Launching+Instances%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Dashboard_Log_Tab_Shows_no_Output_for_Instance"></a>B.3.&nbsp;Compute Instance Log Shows no Output</h2></div></div></div><div class="para">
    The log output from running instances is visible both from the <span class="guilabel"><strong>Log</strong></span> tab on the dashboard and in the output of the <code class="command">nova console-log</code> command. Sometimes however the log of a running instance will either appear to be completely empty or contain a single errant character, often a <span class="keycap"><strong>?</strong></span> character.
  </div><div class="para">
    This occurs when the Compute service is trying to retrieve the log output of the guest via a serial console but the guest itself is not sending output to the console.
  </div><div class="para">
    To avoid this Linux guests must be configured to append the parameters <code class="literal">console=tty0 console=ttyS0,115200n8</code> to the list of kernel arguments specified in the boot loader.
  </div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16832-541150+%5BLatest%5D&amp;cf_build_id=16832-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Compute+Instance+Log+Shows+no+Output%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Keystone_Client_Reports_Unable_to_communicate_with_identity_service"></a>B.4.&nbsp;Identity Client (keystone) Reports &quot;Unable to communicate with identity service&quot;</h2></div></div></div><div class="para">
    When the identity client (<code class="command">keystone</code>) is unable to contact the identity service it returns an error:
  </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">keystone <em class="replaceable"><code>ACTION</code></em></code></code></strong>
Unable to communicate with identity service: [Errno 113] No route to host. (HTTP 400)</pre><div class="para">
    Replace <em class="replaceable"><code>ACTION</code></em> with any valid identity service client action such as <code class="literal">user-list</code> or <code class="literal">service-list</code>. When the service is unreachable any identity client command that requires it will fail.
  </div><div class="para">
    To debug the issue check for these common causes:
  </div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Service Status</span></dt><dd><div class="para">
          On the system hosting the identity service check the service status:
        </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">service openstack-keystone status</code></code></strong>
keystone (pid  <em class="replaceable"><code>2847</code></em>) is running...</pre><div class="para">
          If the service is not running then log in as the <code class="systemitem">root</code> user and start it.
        </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service openstack-keystone start</code></code></strong></pre></dd><dt><span class="term">Firewall Rules</span></dt><dd><div class="para">
          On the system hosting the identity service check that the firewall allows TCP traffic on ports <code class="literal">5000</code> and <code class="literal">35357</code>. This command must be run while logged in as the <code class="systemitem">root</code> user.
        </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">iptables --list -n | grep -P &quot;(5000|35357)&quot;</code></code></strong>
ACCEPT  tcp  --  0.0.0.0/0  0.0.0.0/0  multiport dports 5000,35357</pre><div class="para">
          If no rule is found then add one to the <code class="filename">/etc/sysconfig/iptables</code> file:
        </div><pre class="screen">-A INPUT -p tcp -m multiport --dports 5000,35357 -j ACCEPT</pre><div class="para">
          Restart the <code class="systemitem">iptables</code> service for the change to take effect.
        </div><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code><code class="command">service iptables restart</code></code></strong></pre></dd><dt><span class="term">Service Endpoints</span></dt><dd><div class="para">
          On the system hosting the identity service check that the endpoints are defined correctly.
        </div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
              Obtain the administration token:
            </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">grep admin_token /etc/keystone/keystone.conf</code></code></strong>
admin_token = <em class="replaceable"><code>0292d404a88c4f269383ff28a3839ab4</code></em></pre></li><li class="listitem"><div class="para">
              Determine the correct administration endpoint for the identity service:
            </div><pre class="screen">http://<em class="replaceable"><code>IP</code></em>:35357/<em class="replaceable"><code>VERSION</code></em></pre><div class="para">
              Replace <em class="replaceable"><code>IP</code></em> with the IP address or host name of the system hosting the identity service. Replace <em class="replaceable"><code>VERSION</code></em> with the API version (<code class="literal">v2.0</code>, or <code class="literal">v3</code>) that is in use.
            </div></li><li class="listitem"><div class="para">
              Unset any pre-defined identity service related environment variables:
            </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">unset OS_USERNAME OS_TENANT_NAME OS_PASSWORD OS_AUTH_URL</code></code></strong></pre></li><li class="listitem"><div class="para">
              Use the administration token and endpoint to authenticate with the identity service. Confirm that the identity service endpoint is correct:
            </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">keystone --os-token=<em class="replaceable"><code>TOKEN</code></em> \</code></code></strong>
            <strong class="userinput"><code><code class="command">--os-endpoint=<em class="replaceable"><code>ENDPOINT</code></em> \</code></code></strong>
            <strong class="userinput"><code><code class="command">endpoint-list</code></code></strong></pre><div class="para">
              Verify that the listed <code class="literal">publicurl</code>, <code class="literal">internalurl</code>, and <code class="literal">adminurl</code> for the identity service are correct. In particular ensure that the IP addresses and port numbers listed within each endpoint are correct and reachable over the network.
            </div><div class="para">
              If these values are incorrect then refer to <a class="xref" href="#Creating_the_Permanent_Service_Endpoint">Section&nbsp;9.6, “Creating the Identity Service Endpoint”</a> for information on adding the correct endpoint. Once the correct endpoints have been added remove any incorrect endpoints using the <code class="literal">endpoint-delete</code> action of the <code class="command">keystone</code> command.
            </div><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code><code class="command">keystone --os-token=<em class="replaceable"><code>TOKEN</code></em> \</code></code></strong>
            <strong class="userinput"><code><code class="command">--os-endpoint=<em class="replaceable"><code>ENDPOINT</code></em> \</code></code></strong>
            <strong class="userinput"><code><code class="command">endpoint-delete <em class="replaceable"><code>ID</code></em></code></code></strong></pre><div class="para">
              Replace <em class="replaceable"><code>TOKEN</code></em> and <em class="replaceable"><code>ENDPOINT</code></em> with the values identified previously. Replace <em class="replaceable"><code>ID</code></em> with the identity of the endpoint to remove as listed by the <code class="literal">endpoint-list</code> action.
            </div></li></ul></div></dd></dl></div><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+18117-541150+%5BLatest%5D&amp;cf_build_id=18117-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Identity+Client+%28keystone%29+Reports+%22Unable+to+communicate+with+identity+service%22%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appe-Service_Log_Files"></a>Service Log Files</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Block_Storage_Service_Log_Files"></a>C.1.&nbsp;Block Storage Service Log Files</h2></div></div></div><div class="para">
    The log files of the block storage service are stored in the <code class="filename">/var/log/cinder/</code> directory of the host on which each service runs.
  </div><div class="table"><a id="idm36624"></a><p class="title"><strong>Table&nbsp;C.1.&nbsp;Log Files</strong></p><div class="table-contents"><table summary="Log Files"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            File name
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="filename">api.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the API service (<code class="systemitem">openstack-cinder-api</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">cinder-manage.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the management interface (<code class="systemitem">cinder-manage</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">scheduler.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the scheduler service (<code class="systemitem">openstack-cinder-scheduler</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">volume.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the volume service (<code class="systemitem">openstack-cinder-volume</code>).
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15893-541150+%5BLatest%5D&amp;cf_build_id=15893-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Block+Storage+Service+Log+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Compute_Service_Log_Files"></a>C.2.&nbsp;Compute Service Log Files</h2></div></div></div><div class="para">
    The log files of the Compute service are stored in the <code class="filename">/var/log/nova/</code> directory of the host on which each service runs.
  </div><div class="table"><a id="idp4347872"></a><p class="title"><strong>Table&nbsp;C.2.&nbsp;Log Files</strong></p><div class="table-contents"><table summary="Log Files"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            File name
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="filename">api.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the API service (<code class="systemitem">openstack-nova-api</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">cert.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the X509 certificate service (<code class="systemitem">openstack-nova-cert</code>). This service is only required by the EC2 API to the Compute service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">compute.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log file of the Compute service itself (<code class="systemitem">openstack-nova-compute</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">conductor.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log file of the conductor (<code class="systemitem">openstack-nova-conductor</code>) that provides database query support to the Compute service.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">consoleauth.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log file of the console authentication service (<code class="systemitem">openstack-nova-consoleauth</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">network.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the network service (<code class="systemitem">openstack-nova-network</code>). Note that this service only runs in environments that are <span class="emphasis"><em>not</em></span> configured to use OpenStack networking.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">nova-manage.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the management interface (<code class="systemitem">nova-manage</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">scheduler.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the scheduler service (<code class="systemitem">openstack-nova-scheduler</code>).
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15897-541150+%5BLatest%5D&amp;cf_build_id=15897-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Compute+Service+Log+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Apache_Web_Server_Log_Files"></a>C.3.&nbsp;Dashboard Log Files</h2></div></div></div><div class="para">
    The dashboard is served to users using the Apache web server (<code class="systemitem">httpd</code>). As a result, the log files for the dashboard are stored in the <code class="filename">/var/log/httpd</code> directory.
  </div><div class="table"><a id="idm315272"></a><p class="title"><strong>Table&nbsp;C.3.&nbsp;Log Files</strong></p><div class="table-contents"><table summary="Log Files"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            File name
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="filename">access_log</code>
            </div>

          </td><td class="">
            <div class="para">
              The access log details all attempts to access the web server.
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">error_log</code>
            </div>

          </td><td class="">
            <div class="para">
              The error log details all unsuccessful attempts to access the web server and the reason for each failure.
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15840-541150+%5BLatest%5D&amp;cf_build_id=15840-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Dashboard+Log+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Identity_Service_Log_Files"></a>C.4.&nbsp;Identity Service Log Files</h2></div></div></div><div class="para">
    The log file of the identity service is stored in the <code class="filename">/var/log/keystone/</code> directory of the host on which it runs.
  </div><div class="table"><a id="idp45244176"></a><p class="title"><strong>Table&nbsp;C.4.&nbsp;Log File</strong></p><div class="table-contents"><table summary="Log File"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            File name
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="filename">keystone.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the identity service (<code class="systemitem">openstack-keystone</code>).
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15846-541150+%5BLatest%5D&amp;cf_build_id=15846-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Identity+Service+Log+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Image_Storage_Service_Log_Files"></a>C.5.&nbsp;Image Service Log Files</h2></div></div></div><div class="para">
    The log files of the Image service are stored in the <code class="filename">/var/log/glance/</code> directory of the host on which each service runs.
  </div><div class="table"><a id="idp7270496"></a><p class="title"><strong>Table&nbsp;C.5.&nbsp;Log Files</strong></p><div class="table-contents"><table summary="Log Files"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            File name
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="filename">api.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the API service (<code class="systemitem">openstack-glance-api</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">registry.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log of the image registry service (<code class="systemitem">openstack-glance-registry</code>).
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15936-541150+%5BLatest%5D&amp;cf_build_id=15936-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Image+Service+Log+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Networking_Service_Log_Files"></a>C.6.&nbsp;Networking Service Log Files</h2></div></div></div><div class="para">
    The log files of the networking service are stored in the <code class="filename">/var/log/neutron/</code> directory of the host on which each service runs.
  </div><div class="table"><a id="idp10180384"></a><p class="title"><strong>Table&nbsp;C.6.&nbsp;Log Files</strong></p><div class="table-contents"><table summary="Log Files"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            File name
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="filename">dhcp-agent.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the DHCP agent (<code class="systemitem">neutron-dhcp-agent</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">l3-agent.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the L3 agent (<code class="systemitem">neutron-l3-agent</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">lbaas-agent.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the Load Balancer as a Service (LBaaS) agent (<code class="systemitem">neutron-lbass-agent</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">linuxbridge-agent.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the Linux Bridge agent (<code class="systemitem">neutron-linuxbridge-agent</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">metadata-agent.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the metadata agent (<code class="systemitem">neutron-metadata-agent</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">openvswitch-agent.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the Open vSwitch agent (<code class="systemitem">neutron-openvswitch-agent</code>).
            </div>

          </td></tr><tr><td class="">
            <div class="para">
              <code class="filename">server.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the OpenStack networking service itself (<code class="systemitem">neutron-server</code>).
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+16842-550073+%5BLatest%5D&amp;cf_build_id=16842-550073+01+Nov+2013+10%3A20+en-US+%5BLatest%5D&amp;comment=Title%3A+Networking+Service+Log+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Object_Storage_Service_Log_Files"></a>C.7.&nbsp;Object Storage Service Log Files</h2></div></div></div><div class="para">
    The log file of the object storage service is stored in the <code class="filename">/var/log/</code> directory of the host on which each service runs.
  </div><div class="table"><a id="idm1886488"></a><p class="title"><strong>Table&nbsp;C.7.&nbsp;Log File</strong></p><div class="table-contents"><table summary="Log File"><colgroup><col width="50%" /><col width="50%" /></colgroup><thead><tr><th class="">
            File name
          </th><th class="">
            Description
          </th></tr></thead><tbody><tr><td class="">
            <div class="para">
              <code class="filename">swift-startup.log</code>
            </div>

          </td><td class="">
            <div class="para">
              The log for the object storage proxy service.
            </div>

          </td></tr></tbody></table></div></div><br class="table-break" /><div class="RoleCreateBugPara RoleCreateBugPara">
    <a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+15807%2C+Installation+and+Configuration+Guide-4-Beta-1%0ABuild+Date%3A+18-11-2013+17%3A09%3A37%0ATopic+ID%3A+15895-541150+%5BLatest%5D&amp;cf_build_id=15895-541150+27+Sep+2013+10%3A50+en-US+%5BLatest%5D&amp;comment=Title%3A+Object+Storage+Service+Log+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;product=Red+Hat+OpenStack&amp;component=doc-Installation_and_Configuration_Guide">Report a bug</a>
  </div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appe-Installation_and_Configuration_Guide-Revision_History"></a>Revision History</h1></div></div></div><div class="para"><p></p>
    <div class="revhistory"><table summary="Revision History"><tr><th align="left" valign="top" colspan="3"><strong>Revision History</strong></th></tr><tr><td align="left">Revision 3-44</td><td align="left">Fri Nov 15 2013</td><td align="left"><span class="author"><span class="firstname">Summer</span> <span class="surname">Long</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=974236">BZ#974236</a> - Removed example configuration files from Appendix (files are now housed in the Configuration Reference Guide). </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-42</td><td align="left">Fri Nov 15 2013</td><td align="left"><span class="author"><span class="firstname">Don</span> <span class="surname">Domingo</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/976598:">BZ#976598:</a> - Revised IPTables instructions to file editing for consistency, refer to [15932] (also minor edits). </td></tr><tr><td> <a href="https://bugzilla.redhat.com/1020071">BZ#1020071</a> - Updated package name with Havana version. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-41</td><td align="left">Tue Nov 12 2013</td><td align="left"><span class="author"><span class="firstname">Martin</span> <span class="surname">Lopes</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=973845">BZ#973845</a> - Removed duplicate language for RHN requirement </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-40</td><td align="left">Tue Nov 12 2013</td><td align="left"><span class="author"><span class="firstname">Summer</span> <span class="surname">Long</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1025133">BZ#1025133</a>-Updated basic text, configuration files throughout for quantum -&gt; neutron code changes and Havana updates. Removed 'Grizzly' references. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=988039">BZ#988039</a>-Removed 'tech preview' note for cells, and removed Note about tech previews. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-39</td><td align="left">Fri Oct 25 2013</td><td align="left"><span class="author"><span class="firstname">Scott</span> <span class="surname">Radvan</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> Test publishing of new Beta version. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-38</td><td align="left">Mon Sep 16 2013</td><td align="left"><span class="author"><span class="firstname">Scott</span> <span class="surname">Radvan</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1004575">BZ#1004575</a> - Only show configuring v2.0 of the endpoint API. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-37</td><td align="left">Fri Sep 06 2013</td><td align="left"><span class="author"><span class="firstname">Scott</span> <span class="surname">Radvan</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=997589">BZ#997589</a> - Update procedure formatting. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-36</td><td align="left">Fri Sep 06 2013</td><td align="left"><span class="author"><span class="firstname">Scott</span> <span class="surname">Radvan</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=997589">BZ#997589</a> - Specify correct package for VNC service. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-35</td><td align="left">Tue Sep 03 2013</td><td align="left"><span class="author"><span class="firstname">Scott</span> <span class="surname">Radvan</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=975268">BZ#975268</a> - Move component listings into tables. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-34</td><td align="left">Mon Sep 02 2013</td><td align="left"><span class="author"><span class="firstname">Scott</span> <span class="surname">Radvan</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=984897">BZ#984897</a> - Fix incorrect /etc file path. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-33</td><td align="left">Thu Aug 08 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> Updated brand. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-32</td><td align="left">Tue Aug 06 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=988471">BZ#988471</a> - Updated explanation of RHS SELinux boolean. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/show_bug.cgi?id=988151">BZ#988151</a> - Added brief explanation of NFS component of multi-backend example. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-31</td><td align="left">Tue Aug 06 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/988471">BZ#988471</a> - Add setting of virt_use_fusefs SELinux boolean to RHS backend configuration. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/984898">BZ#984898</a> - Added missing &quot;on&quot; argument to setsebool command. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/989832">BZ#989832</a> - Removed extra apostrophe in certutil example. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/980547">BZ#980547</a> - Replace /etc/nova/nova/conf with /etc/nova/nova.conf in Updating the Compute Configuration section. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/988150">BZ#988150</a> - Updated Block Storage multi-backend configuration content to provider correct Red Hat Storage driver. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/988151">BZ#988151</a> - Updated Block Storage multi-backend configuration to provide a valid NFS example. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/991099">BZ#991099</a> - Updated database connection string instructions in &quot;Configuring the Network Service&quot; to refer to the correct file. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/928038">BZ#928038</a> - Correct description of bridge_mappings configuration key. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/981430">BZ#981430</a> - Start openstack-nova-consoleauth service. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-30</td><td align="left">Wed Jul 17 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> BZ#<a href="https://bugzilla.redhat.com/981430">981430</a> - Added instructions on the use of the Compute console authentication service. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/980559">980559</a> - Added API, conductor, and scheduler services to compute installation instructions. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/980902">980902</a> - Added missing authentication configuration for the Compute service. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/980860">980860</a> - Added instructions for starting Libvirtd service before the Compute (Nova) service. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/928038">928038</a> - Added <code class="literal">bridge_mappings</code> and <code class="literal">physical_interface_mappings</code> configuration keys to networking documentation. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-29</td><td align="left">Mon Jul 08 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> BZ#<a href="https://bugzilla.redhat.com/980565">980565</a> - Added missing database grant for 'dash' database user. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/975419">975419</a> - Fixed Nova API restart command to refer to the correct service. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-26</td><td align="left">Mon Jul 01 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> BZ#<a href="https://bugzilla.redhat.com/979150">979150</a> - Updated entitlement information. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/978657">978657</a> - Fixed Identity service v3 endpoint definition. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/979004">979004</a> - Corrected Compute Identity records. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-24</td><td align="left">Mon Jun 24 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span>, <span class="author"><span class="firstname">Summer</span> <span class="surname">Long</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> BZ#<a href="https://bugzilla.redhat.com/976842">976842</a> - Corrected endpoint definitions for Object Storage service. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/975419">975419</a> - Corrected restart command for Compute API service. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/965900">965900</a> - Finalized installation checklist. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/973845">973845</a> - Removed duplicated content in prerequisites information. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/877820">877820</a> - Updated example <code class="filename">/etc/libvirt/qemu.conf</code> configuration file. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-23</td><td align="left">Thu Jun 20 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> <a href="https://bugzilla.redhat.com/973845">BZ#973845</a> - Removed duplication in &quot;Register to Red Hat Network&quot; instructions. </td></tr><tr><td> <a href="https://bugzilla.redhat.com/877820">BZ#877820</a> - Updated spacing of qemu settings. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-22</td><td align="left">Tue Jun 18 2013</td><td align="left"><span class="author"><span class="firstname">Stephen</span> <span class="surname">Gordon</span></span>, <span class="author"><span class="firstname">Summer</span> <span class="surname">Long</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> BZ#<a href="https://bugzilla.redhat.com/974430">974430</a> - Updated to use the correct credentials when creating a new user. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/974434">974434</a> - Use root user account instead of sudo when configuring Object Storage. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/967965">967965</a> - Added steps for creating an external provider network. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/928376">928376</a> - Added Red Hat Storage backend for Block Storage Service. </td></tr><tr><td> BZ#<a href="https://bugzilla.redhat.com/959515">959515</a> - Added new topic covering installation prerequisites. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-21</td><td align="left">Thu Jun 13 2013</td><td align="left"><span class="author"><span class="firstname">Steve</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> Red Hat OpenStack 3.0 Preview update. </td></tr></table>

        </td></tr><tr><td align="left">Revision 3-13</td><td align="left">Wed May 29 2013</td><td align="left"><span class="author"><span class="firstname">Steve</span> <span class="surname">Gordon</span></span></td></tr><tr><td align="left" colspan="3">
          <table border="0" summary="Simple list" class="simplelist"><tr><td> Red Hat OpenStack 3.0 Preview. </td></tr></table>

        </td></tr></table></div>

  </div></div></div><div id="site_footer"></div>
  <script type="text/javascript" src="Common_Content/js/scripts.js"></script>
</div>
</body>
</hmtl>
